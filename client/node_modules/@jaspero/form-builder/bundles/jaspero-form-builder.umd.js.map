{"version":3,"file":"jaspero-form-builder.umd.js","sources":["../../../../projects/form-builder/src/lib/enums/segment-type.enum.ts","../../../../projects/form-builder/src/lib/enums/state.enum.ts","../../../../projects/form-builder/src/lib/form-builder.service.ts","../../../../projects/form-builder/src/lib/utils/custom-fields.ts","../../../../node_modules/tslib/tslib.es6.js","../../../../projects/form-builder/src/lib/utils/create-segment-injector.ts","../../../../projects/form-builder/src/lib/segment/segment.component.ts","../../../../projects/form-builder/src/lib/segments/accordion/accordion.component.ts","../../../../projects/form-builder/src/lib/segments/card/card.component.ts","../../../../projects/form-builder/src/lib/segments/empty/empty.component.ts","../../../../projects/form-builder/src/lib/segments/stepper/stepper.component.ts","../../../../projects/form-builder/src/lib/utils/safe-eval.ts","../../../../projects/form-builder/src/lib/segments/tabs/tabs.component.ts","../../../../projects/form-builder/src/lib/consts/segment-type-component-map.const.ts","../../../../projects/form-builder/src/lib/interfaces/condition.interface.ts","../../../../projects/form-builder/src/lib/utils/compile-segment.ts","../../../../projects/form-builder/src/lib/utils/filter-and-compile-segments.ts","../../../../projects/form-builder/src/lib/enums/component-type.enum.ts","../../../../projects/form-builder/src/lib/services/db.service.ts","../../../../projects/form-builder/src/lib/utils/create-component-injector.ts","../../../../projects/form-builder/src/lib/field/field.component.ts","../../../../projects/form-builder/src/lib/utils/get-hsd.ts","../../../../projects/form-builder/src/lib/fields/autocomplete/autocomplete.component.ts","../../../../projects/form-builder/src/lib/fields/checkbox/checkbox.component.ts","../../../../projects/form-builder/src/lib/fields/chips/chips.component.ts","../../../../projects/form-builder/src/lib/utils/clone-abstract-control.ts","../../../../projects/form-builder/src/lib/fields/date-field/date-field.component.ts","../../../../projects/form-builder/src/lib/fields/draggable-list/draggable-list.component.ts","../../../../projects/form-builder/src/lib/services/storage.service.ts","../../../../projects/form-builder/src/lib/utils/format-file-name.ts","../../../../projects/form-builder/src/lib/utils/parse-size.ts","../../../../projects/form-builder/src/lib/fields/file/file.component.ts","../../../../projects/form-builder/src/lib/utils/format-generated-images.ts","../../../../projects/form-builder/src/lib/utils/storage-url.ts","../../../../projects/form-builder/src/lib/utils/switch-item-locations.ts","../../../../projects/form-builder/src/lib/fields/gallery/read-file.ts","../../../../projects/form-builder/src/lib/fields/gallery/gallery.component.ts","../../../../projects/form-builder/src/lib/fields/image/image.component.ts","../../../../projects/form-builder/src/lib/fields/input/input.component.ts","../../../../projects/form-builder/src/lib/fields/radio/radio.component.ts","../../../../projects/form-builder/src/lib/fields/range/range.component.ts","../../../../projects/form-builder/src/lib/utils/additional-context.ts","../../../../projects/form-builder/src/lib/utils/parse-template.ts","../../../../projects/form-builder/src/lib/utils/role.ts","../../../../projects/form-builder/src/lib/fields/select/select.component.ts","../../../../projects/form-builder/src/lib/fields/slider/slider.component.ts","../../../../projects/form-builder/src/lib/fields/textarea/textarea.component.ts","../../../../projects/form-builder/src/lib/fields/toggle/toggle.component.ts","../../../../projects/form-builder/src/lib/fields/wysiwyg/wysiwyg.component.ts","../../../../projects/form-builder/src/lib/consts/component-type-component-map.const.ts","../../../../projects/form-builder/src/lib/enums/schema-type.enum.ts","../../../../projects/form-builder/src/lib/validators/schema-validators.class.ts","../../../../projects/form-builder/src/lib/utils/schema-to-component.ts","../../../../projects/form-builder/src/lib/utils/parser.ts","../../../../projects/form-builder/src/lib/form-builder.component.ts","../../../../projects/form-builder/src/lib/directives/dropzone/dropzone.directive.ts","../../../../projects/form-builder/src/lib/pipes/show-field/show-field.pipe.ts","../../../../projects/form-builder/src/lib/form-builder.module.ts","../../../../projects/form-builder/src/public-api.ts","../../../../projects/form-builder/src/jaspero-form-builder.ts"],"sourcesContent":["export enum SegmentType {\n  Empty = 'empty',\n  Card = 'card',\n  Accordion = 'accordion',\n  Tabs = 'tabs',\n  Stepper = 'stepper'\n}\n","export enum State {\n  Create = 'create',\n  Edit = 'edit'\n}\n","import {Injectable} from '@angular/core';\nimport {MatSnackBar} from '@angular/material/snack-bar';\nimport {TranslocoService} from '@ngneat/transloco';\nimport {Observable, throwError} from 'rxjs';\nimport {catchError, tap} from 'rxjs/operators';\n\n@Injectable()\nexport class FormBuilderService {\n  constructor(\n    private transloco: TranslocoService,\n    private snackBar: MatSnackBar\n  ) {\n  }\n\n  /**\n   * Array of components that need to\n   * run save() methods on single instance\n   */\n  saveComponents: any[] = [];\n\n  notify(\n    options: {\n      success?: string | null;\n      error?: string;\n    } = {}\n  ): <T>(source$: Observable<T>) => Observable<T> {\n    const finalOptions = {\n      success: 'GENERAL.OPERATION_COMPLETED',\n      error: 'GENERAL.OPERATION_FAILED',\n      ...options\n    };\n\n    return <T>(source$: Observable<T>) => {\n      return source$.pipe(\n        tap(() => {\n          if (finalOptions.success) {\n            this.snackBar.open(\n              this.transloco.translate(finalOptions.success),\n              this.transloco.translate('GENERAL.DISMISS'),\n              {\n                duration: 5000\n              }\n            );\n          }\n        }),\n        catchError(err => {\n          if (finalOptions.error) {\n            this.snackBar.open(\n              this.transloco.translate(finalOptions.error),\n              this.transloco.translate('GENERAL.DISMISS'),\n              {\n                panelClass: 'snack-bar-error',\n                duration: 5000\n              }\n            );\n          }\n\n          console.error(err);\n          return throwError(err);\n        })\n      );\n    };\n  }\n}\n","import {Component, InjectionToken} from '@angular/core';\n\nexport interface CustomFields {\n  [key: string]: Component;\n}\n\nexport const CUSTOM_FIELDS = new InjectionToken<{}>('CUSTOM_FIELDS');\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) __createBinding(exports, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import {PortalInjector} from '@angular/cdk/portal';\nimport {InjectionToken} from '@angular/core';\n\nexport const SEGMENT_DATA = new InjectionToken<{}>('SEGMENT_DATA');\n\nexport function createSegmentInjector(injector, dataToPass): PortalInjector {\n  const injectorTokens = new WeakMap();\n  injectorTokens.set(SEGMENT_DATA, dataToPass);\n  return new PortalInjector(injector, injectorTokens);\n}\n","import {moveItemInArray} from '@angular/cdk/drag-drop';\nimport {Component, HostBinding, Inject, Injector, OnInit} from '@angular/core';\nimport {FormControl} from '@angular/forms';\nimport {get} from 'json-pointer';\nimport {CompiledField} from '../interfaces/compiled-field.interface';\nimport {CompiledSegment} from '../interfaces/compiled-segment.interface';\nimport {Definitions} from '../interfaces/definitions.interface';\nimport {SEGMENT_DATA} from '../utils/create-segment-injector';\nimport {filterAndCompileSegments} from '../utils/filter-and-compile-segments';\nimport {Parser, Pointers} from '../utils/parser';\n\nexport interface SegmentData {\n  segment: CompiledSegment;\n  parser: Parser;\n  definitions: Definitions;\n  parent?: string;\n}\n\n@Component({\n  selector: 'fb-segment',\n  template: ''\n})\nexport class SegmentComponent<T = any> implements OnInit {\n  constructor(\n    @Inject(SEGMENT_DATA) public sData: SegmentData,\n    public injector: Injector\n  ) {}\n\n  segment: CompiledSegment<T>;\n  pointers: Pointers;\n  nestedSegments: CompiledSegment<T>[];\n  nestedArraySegments: Array<CompiledSegment[]> = [];\n  arrayFields: Array<CompiledField[]> = [];\n\n  @HostBinding('class')\n  classes: string;\n\n  @HostBinding('id')\n  id: string;\n\n  ngOnInit() {\n    this.segment = this.sData.segment;\n    this.classes = this.sData.segment.classes.join(' ');\n    this.pointers = this.sData.parser.pointers;\n    this.id = this.sData.segment.id || '';\n\n    /**\n     * Each segment compiles all nested segments\n     */\n    this.nestedSegments = filterAndCompileSegments(\n      this.sData.segment.nestedSegments || [],\n      this.sData.parser,\n      this.sData.definitions,\n      this.injector,\n      this.segment.entryValue\n    );\n\n    const array = this.segment.array as string;\n\n    /**\n     * Add array items if necessary\n     */\n    if (array && this.segment.entryValue) {\n      let values;\n\n      try {\n        values = get(this.segment.entryValue, array);\n      } catch (e) {}\n\n      if (values) {\n        values.forEach(() => this.addArrayItem(false));\n\n        (this.pointers[array].control as FormControl).patchValue(\n          values\n        );\n\n        for (let i = 0; i < values.length; i++) {\n          // @ts-ignore\n          this.sData.parser.loadHooks(this.pointers[array].arrayPointers[i]);\n        }\n      }\n    }\n  }\n\n  addArrayItem(loadHook = true) {\n    const array = this.segment.array as string;\n    const pointers: any = this.sData.parser.addArrayItem(\n      (this.sData.parent || '') + array,\n      loadHook,\n      this.sData.parent ? {\n        pointer: this.sData.parent,\n        index: 0\n      } : undefined\n    );\n\n    let fields: CompiledField[];\n\n    if (this.segment.fields && this.segment.fields.length) {\n      fields = (this.segment.fields as string[]).map(key => {\n\n        key = (this.sData.parent || '') + key;\n\n        return this.sData.parser.field(\n          key,\n          pointers[key],\n          this.sData.definitions,\n          true,\n          array\n        );\n      });\n    } else {\n      fields = [this.sData.parser.field(\n        array,\n        {\n          ...this.pointers[array],\n          control: pointers\n        },\n        this.sData.definitions\n      )];\n    }\n\n    this.arrayFields.unshift(\n      fields\n    );\n\n    this.nestedArraySegments.unshift(\n      this.nestedSegments = filterAndCompileSegments(\n        this.sData.segment.nestedSegments || [],\n        this.sData.parser,\n        this.sData.definitions,\n        this.injector,\n        this.segment.entryValue,\n        this.segment.array\n      )\n    );\n  }\n\n  moveArray(up: boolean, fromIndex: number) {\n    let toIndex: number;\n\n    if (up) {\n      toIndex = fromIndex === 0 ? this.arrayFields.length - 1 : fromIndex - 1;\n    } else {\n      toIndex = fromIndex === (this.arrayFields.length - 1) ? 0 : fromIndex + 1;\n    }\n\n    moveItemInArray(\n      this.arrayFields,\n      fromIndex,\n      toIndex\n    );\n\n    moveItemInArray(\n      this.nestedArraySegments,\n      fromIndex,\n      toIndex\n    );\n\n    this.sData.parser.moveArrayItem(\n      (this.sData.parent || '') + this.segment.array as string,\n      fromIndex,\n      toIndex,\n      this.sData.parent ? {\n        pointer: this.sData.parent,\n        index: 0\n      } : undefined\n    );\n  }\n\n  removeArrayItem(index: number) {\n    this.sData.parser.removeArrayItem(\n      (this.sData.parent || '') + this.segment.array as string,\n      index,\n      this.sData.parent ? {\n        pointer: this.sData.parent,\n        index: 0\n      } : undefined\n    );\n    this.nestedArraySegments.splice(index, 1);\n    this.arrayFields.splice(index, 1);\n  }\n}\n","import {ChangeDetectionStrategy, Component, OnInit} from '@angular/core';\nimport {CompiledField} from '../../interfaces/compiled-field.interface';\nimport {CompiledSegment} from '../../interfaces/compiled-segment.interface';\nimport {Segment} from '../../interfaces/segment.interface';\nimport {SegmentComponent} from '../../segment/segment.component';\nimport {filterAndCompileSegments} from '../../utils/filter-and-compile-segments';\n\ninterface SegmentAccord {\n  title?: string;\n  description?: string;\n  fields?: string[];\n  nestedSegments?: Segment[];\n  expanded?: boolean;\n}\n\ninterface CompiledSegmentAccord {\n  title?: string;\n  description?: string;\n  fields?: CompiledField[];\n  nestedSegments?: CompiledSegment[];\n  expanded?: boolean;\n}\n\n@Component({\n  selector: 'fb-accordion',\n  templateUrl: './accordion.component.html',\n  styleUrls: ['./accordion.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AccordionComponent extends SegmentComponent implements OnInit {\n\n  accordions: CompiledSegmentAccord[];\n\n  ngOnInit() {\n    super.ngOnInit();\n\n    this.accordions = (this.sData.segment.configuration || []).map(\n      (accord: SegmentAccord) => ({\n        title: accord.title,\n        fields: (accord.fields || []).map(key =>\n          this.sData.parser.field(\n            key,\n            this.pointers[key],\n            this.sData.definitions\n          )\n        ),\n        nestedSegments: filterAndCompileSegments(\n          accord.nestedSegments || [],\n          this.sData.parser,\n          this.sData.definitions,\n          this.injector,\n          this.segment.entryValue\n        )\n      })\n    );\n  }\n}\n","import {ChangeDetectionStrategy, Component} from '@angular/core';\nimport {CompiledField} from '../../interfaces/compiled-field.interface';\nimport {SegmentComponent} from '../../segment/segment.component';\n\n@Component({\n  selector: 'fb-card',\n  templateUrl: './card.component.html',\n  styleUrls: ['./card.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class CardComponent extends SegmentComponent {\n  get fields() {\n    return this.segment.fields as CompiledField[];\n  }\n}\n","import {ChangeDetectionStrategy, Component} from '@angular/core';\nimport {CompiledField} from '../../interfaces/compiled-field.interface';\nimport {SegmentComponent} from '../../segment/segment.component';\n\n@Component({\n  selector: 'fb-empty',\n  templateUrl: './empty.component.html',\n  styleUrls: ['./empty.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class EmptyComponent extends SegmentComponent {\n  get fields() {\n    return this.segment.fields as CompiledField[];\n  }\n}\n","import {ChangeDetectionStrategy, Component} from '@angular/core';\nimport {SegmentComponent} from '../../segment/segment.component';\n\n@Component({\n  selector: 'fb-stepper',\n  templateUrl: './stepper.component.html',\n  styleUrls: ['./stepper.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class StepperComponent extends SegmentComponent {}\n","export function safeEval(method: string) {\n  let final: any;\n\n  try {\n    // tslint:disable-next-line:no-eval\n    final = eval(method);\n  } catch (e) {}\n\n  return final;\n}\n","import {ChangeDetectionStrategy, Component, OnInit} from '@angular/core';\nimport {MatTabChangeEvent} from '@angular/material/tabs';\nimport {CompiledField} from '../../interfaces/compiled-field.interface';\nimport {CompiledSegment} from '../../interfaces/compiled-segment.interface';\nimport {Segment} from '../../interfaces/segment.interface';\nimport {SegmentComponent, SegmentData} from '../../segment/segment.component';\nimport {filterAndCompileSegments} from '../../utils/filter-and-compile-segments';\nimport {safeEval} from '../../utils/safe-eval';\n\ntype SelectedTabChange = (event: MatTabChangeEvent, sData: SegmentData) => void;\n\ninterface TabsConfiguration {\n  selectedIndex?: number;\n  dynamicHeight?: boolean;\n  disableRipple?: boolean;\n  selectedTabChange?: string | SelectedTabChange;\n  alignment?: 'start' | 'center' | 'end';\n  tabs: SegmentTab[];\n}\n\ninterface SegmentTabShared {\n  title?: string;\n  disabled?: boolean;\n}\n\ninterface SegmentTab extends SegmentTabShared {\n  fields?: string[];\n  nestedSegments?: Segment[];\n}\n\ninterface CompiledSegmentTab extends SegmentTabShared {\n  fields?: CompiledField[];\n  nestedSegments?: CompiledSegment[];\n}\n\n@Component({\n  selector: 'fb-tabs',\n  templateUrl: './tabs.component.html',\n  styleUrls: ['./tabs.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class TabsComponent extends SegmentComponent<TabsConfiguration> implements OnInit {\n\n  tabs: CompiledSegmentTab[];\n  selectedTabChange?: SelectedTabChange;\n\n  get configuration() {\n    return this.segment.configuration as TabsConfiguration;\n  }\n\n  ngOnInit() {\n    super.ngOnInit();\n\n    if (this.configuration.selectedTabChange) {\n      this.selectedTabChange = safeEval(\n        this.configuration.selectedTabChange as string\n      );\n    }\n\n    this.tabs = this.configuration.tabs.map(\n      tab => ({\n        ...tab,\n        fields: (tab.fields || []).map(key =>\n          this.sData.parser.field(\n            key,\n            this.pointers[key],\n            this.sData.definitions\n          )\n        ),\n        nestedSegments: filterAndCompileSegments(\n          tab.nestedSegments || [],\n          this.sData.parser,\n          this.sData.definitions,\n          this.injector,\n          this.segment.entryValue\n        )\n      })\n    );\n  }\n\n  tabChange(event: MatTabChangeEvent) {\n    if (this.selectedTabChange) {\n      this.selectedTabChange(\n        event,\n        this.sData\n      );\n    }\n  }\n}\n\n","import {SegmentType} from '../enums/segment-type.enum';\nimport {AccordionComponent} from '../segments/accordion/accordion.component';\nimport {CardComponent} from '../segments/card/card.component';\nimport {EmptyComponent} from '../segments/empty/empty.component';\nimport {StepperComponent} from '../segments/stepper/stepper.component';\nimport {TabsComponent} from '../segments/tabs/tabs.component';\n\nexport const SEGMENT_TYPE_COMPONENT_MAP: {[key: string]: any} = {\n  [SegmentType.Empty]: EmptyComponent,\n  [SegmentType.Card]: CardComponent,\n  [SegmentType.Accordion]: AccordionComponent,\n  [SegmentType.Tabs]: TabsComponent,\n  [SegmentType.Stepper]: StepperComponent\n};\n","\n\nexport enum ConditionType {\n  Function = 'function',\n  Statement = 'statement'\n}\n\nexport enum ConditionAction {\n  Show = 'show',\n  Hide = 'hide'\n}\n\nexport enum ConditionEvaluate {\n  OnLoad = 'onLoad',\n  OnChange = 'onChange'\n}\n\nexport interface Condition {\n\n  /**\n   * Defaults to function\n   */\n  type?: ConditionType;\n\n  /**\n   * Stringified condition that could\n   * later also be an object representing\n   * a more complex statement\n   */\n  condition?: string;\n\n  /**\n   * Defaults to show\n   */\n  action?: ConditionAction;\n\n  /**\n   * Not always required; depends on\n   * condition type\n   */\n  data?: any;\n\n  /**\n   * Empty or undefined means evaluate always\n   */\n  evaluateStates?: number[];\n\n  /**\n   * Defaults to OnLoad\n   */\n  evaluateOn?: ConditionEvaluate;\n}\n\nexport interface CompiledCondition {\n  type: ConditionType;\n  action: ConditionAction;\n  condition: (data?: any) => any;\n  evaluateStates: number[];\n  evaluateOn: ConditionEvaluate;\n  data?: any;\n}\n","import {ComponentPortal} from '@angular/cdk/portal';\nimport {Injector} from '@angular/core';\nimport {SEGMENT_TYPE_COMPONENT_MAP} from '../consts/segment-type-component-map.const';\nimport {SegmentType} from '../enums/segment-type.enum';\nimport {CompiledField} from '../interfaces/compiled-field.interface';\nimport {CompiledSegment} from '../interfaces/compiled-segment.interface';\nimport {CompiledCondition, ConditionAction, ConditionEvaluate, ConditionType} from '../interfaces/condition.interface';\nimport {Definitions} from '../interfaces/definitions.interface';\nimport {Segment} from '../interfaces/segment.interface';\nimport {SegmentComponent} from '../segment/segment.component';\nimport {createSegmentInjector} from './create-segment-injector';\nimport {Parser} from './parser';\nimport {safeEval} from './safe-eval';\n\nexport function compileSegment(\n  segment: Segment,\n  parser: Parser,\n  definitions: Definitions,\n  injector: Injector,\n  entryValue: any,\n  parent = ''\n) {\n  const classes: string[] = [];\n\n  let fields: CompiledField[] | string[] = [];\n\n  if (segment.columnsDesktop) {\n    classes.push(`col-${segment.columnsDesktop}`);\n  }\n\n  if (segment.columnsTablet) {\n    classes.push(`col-m-${segment.columnsTablet}`);\n  }\n\n  if (segment.columnsMobile) {\n    classes.push(`col-s-${segment.columnsMobile}`);\n  }\n\n  /**\n   * If there aren't any column definitions\n   * default to full width\n   */\n  if (!classes.length) {\n    classes.push('col-12');\n  }\n\n  if (segment.classes) {\n    classes.push(...segment.classes);\n  }\n\n  if (segment.fields) {\n\n    /**\n     * If it's an array fields aren' parsed\n     */\n    if (segment.array) {\n      // @ts-ignore\n      fields = (segment.fields || []).map(fi => segment.array + fi);\n    } else {\n      fields = (segment.fields || [])\n        // @ts-ignore\n        .reduce((acc: CompiledField[], key: string) => {\n          const definition = parser.getFromDefinitions(key, definitions);\n\n          if (\n            !definition ||\n            !definition.roles ||\n            (\n              typeof definition.roles === 'string' ?\n                definition.roles === parser.role :\n                definition.roles.includes(parser.role)\n            )\n          ) {\n            acc.push(\n              parser.field(key, parser.pointers[key], definitions)\n            );\n          }\n\n          return acc;\n        }, []);\n    }\n  }\n\n  const compiledSegment = {\n    ...segment,\n    classes,\n    fields,\n    entryValue\n  } as CompiledSegment;\n\n  /**\n   * TODO:\n   * Statement support\n   */\n  if (segment.conditions) {\n\n    compiledSegment.conditions = [];\n    const valToPass = entryValue || {};\n\n    for (const cur of segment.conditions) {\n      let condition;\n\n      const type = cur.type || ConditionType.Function;\n      const action = cur.action || ConditionAction.Show;\n      const evaluateOn = cur.evaluateOn || ConditionEvaluate.OnLoad;\n      const evaluateStates = cur.evaluateStates || [0, 1, 2];\n\n      if (cur.condition) {\n        condition = safeEval(cur.condition as string);\n      }\n\n      if (condition) {\n\n        /**\n         * Evaluate on load conditions\n         */\n        if (evaluateOn === ConditionEvaluate.OnLoad) {\n\n          /**\n           * Check if items should be excluded right away\n           */\n          if (\n            (action === ConditionAction.Show && !condition(valToPass)) ||\n            (action === ConditionAction.Hide && condition(valToPass))\n          ) {\n            return null;\n          }\n        }\n\n        compiledSegment.conditions.push({\n          condition,\n          type,\n          action,\n          evaluateStates,\n          evaluateOn,\n          ...cur.data && {\n            data: cur.data\n          }\n        } as CompiledCondition);\n      }\n    }\n  }\n\n  return {\n    component: new ComponentPortal<SegmentComponent>(\n      SEGMENT_TYPE_COMPONENT_MAP[segment.type || SegmentType.Card],\n      null,\n      createSegmentInjector(injector, {\n        segment: compiledSegment,\n        parser,\n        definitions,\n        ...parent && {parent},\n      })\n    ),\n    ...compiledSegment\n  } as CompiledSegment;\n}\n","import {Injector} from '@angular/core';\nimport {Definitions} from '../interfaces/definitions.interface';\nimport {Segment} from '../interfaces/segment.interface';\nimport {compileSegment} from './compile-segment';\nimport {Parser} from './parser';\n\nexport function filterAndCompileSegments(\n  segments: Segment[],\n  parser: Parser,\n  definitions: Definitions,\n  injector: Injector,\n  value: any,\n  parent?: string\n) {\n  return segments.reduce((acc, cur) => {\n    if (!cur.authorization || cur.authorization.includes(parser.role)) {\n\n      const compiled = compileSegment(\n        cur,\n        parser,\n        definitions,\n        injector,\n        value,\n        parent\n      );\n\n      if (compiled) {\n        acc.push(\n          // @ts-ignore\n          compiled\n        );\n      }\n    }\n\n    return acc;\n  }, []);\n}\n","export enum ComponentType {\n  Input = 'input',\n  Select = 'select',\n  File = 'file',\n  Image = 'image',\n  Gallery = 'gallery',\n  Toggle = 'toggle',\n  Checkbox = 'checkbox',\n  Date = 'date',\n  Range = 'range',\n  Radio = 'radio',\n  Slider = 'slider',\n  Autocomplete = 'autocomplete',\n  Wysiwyg = 'wysiwyg',\n  Chips = 'chips',\n  Draggable = 'draggable',\n  Textarea = 'textarea'\n}\n","import {Observable, of} from 'rxjs';\nimport {WhereFilter} from '../interfaces/where-filter.interface';\n\nexport abstract class DbService {\n\n  getDocuments(\n    moduleId: string,\n    pageSize?: number,\n    sort?: {\n      active: string;\n      direction: string;\n    },\n    cursor?: any,\n    filters?: WhereFilter[]\n  ): Observable<any[]> {\n    return of([]);\n  }\n\n  getDocumentsSimple(\n    moduleId: string,\n    orderBy?: string,\n    filter?: WhereFilter\n  ): Observable<any[]> {\n    return of([]);\n  }\n\n  getStateChanges(\n    moduleId: string,\n    pageSize?: number,\n    sort?: {\n      active: string;\n      direction: string;\n    },\n    cursor?: any,\n    filters?: WhereFilter[],\n  ): Observable<any[]> {\n    return of([]);\n  }\n\n  getDocument<T = any>(\n    moduleId: string,\n    documentId: string,\n    stream = false\n  ): Observable<T> {\n    return of();\n  }\n\n  setDocument(\n    moduleId: string,\n    documentId: string,\n    data: any,\n    options?: any\n  ): Observable<void> {\n    return of();\n  }\n\n  removeDocument(moduleId: string, documentId: string): Observable<void> {\n    return of();\n  }\n\n  createUserAccount(email: string, password: string): Observable<{id: string}> {\n    return of();\n  }\n\n  removeUserAccount(id: string): Observable<any> {\n    return of();\n  }\n}\n","import {PortalInjector} from '@angular/cdk/portal';\nimport {InjectionToken, Injector} from '@angular/core';\n\nexport const COMPONENT_DATA = new InjectionToken<{}>('COMPONENT_DATA');\n\nexport function createComponentInjector(injector: Injector, dataToPass: any): PortalInjector {\n  const injectorTokens = new WeakMap();\n  injectorTokens.set(COMPONENT_DATA, dataToPass);\n  return new PortalInjector(injector, injectorTokens);\n}\n","import {Component, HostBinding, Inject} from '@angular/core';\nimport {FieldData} from '../interfaces/field-data.interface';\nimport {COMPONENT_DATA} from '../utils/create-component-injector';\n\n// @dynamic\n@Component({\n  selector: 'fb-field',\n  template: ''\n})\nexport class FieldComponent<T extends FieldData> {\n  constructor(\n    @Inject(COMPONENT_DATA) public cData: T\n  ) {\n\n    const classes = [\n      `fb-field-${this.cData.columnsDesktop || 12}`\n    ];\n\n    if (this.cData.columnsTablet) {\n      classes.push(`m-fb-field-${this.cData.columnsTablet}`);\n    }\n\n    if (this.cData.columnsMobile) {\n      classes.push(`s-fb-field-${this.cData.columnsMobile}`);\n    }\n\n    if (this.cData.class) {\n      classes.push(this.cData.class);\n    }\n\n    this.class = classes.join(' ');\n  }\n\n  @HostBinding('class')\n  class: string;\n}\n","import {Observable, of} from 'rxjs';\nimport {map} from 'rxjs/operators';\nimport {FieldData} from '../interfaces/field-data.interface';\nimport {safeEval} from './safe-eval';\n\nexport interface HSD {\n  type?: 'html' | 'static' | 'dynamic';\n  value: string;\n}\n\nexport function getHsd(\n  key: string,\n  data: FieldData\n): Observable<string> {\n  if (data[key]) {\n\n    let item: any;\n\n    switch (data[key].type) {\n      case 'dynamic':\n        item = safeEval(data[key].value);\n\n        if (item) {\n          return data.form.valueChanges\n            .pipe(\n              map(value =>\n                item(\n                  data.control.value,\n                  value\n                )\n              )\n            );\n        }\n\n        break;\n      case 'static':\n        item = safeEval(data[key].value);\n\n        if (item) {\n          return of(item(\n            data.control.value,\n            data.form.getRawValue()\n          ));\n        }\n        break;\n      case 'html':\n      default:\n        return of(data[key].value);\n    }\n  }\n\n  return of('');\n}\n","import {\n  ChangeDetectionStrategy,\n  Component,\n  Inject,\n  OnInit\n} from '@angular/core';\nimport {BehaviorSubject, Observable, of} from 'rxjs';\nimport {map, startWith, switchMap, tap} from 'rxjs/operators';\nimport {DbService} from '../../services/db.service';\nimport {FieldComponent} from '../../field/field.component';\nimport {FieldData} from '../../interfaces/field-data.interface';\nimport {WhereFilter} from '../../interfaces/where-filter.interface';\nimport {COMPONENT_DATA} from '../../utils/create-component-injector';\nimport {getHsd, HSD} from '../../utils/get-hsd';\n\ninterface AutocompleteData extends FieldData {\n  dataSet: Array<{name: string; value: any}>;\n  populate?: {\n    collection: string;\n    nameKey: string;\n    valueKey?: string;\n    orderBy?: string;\n    filter?: WhereFilter;\n  };\n  autocomplete?: string;\n  suffix?: HSD;\n  prefix?: HSD;\n}\n\n@Component({\n  selector: 'fb-autocomplete',\n  templateUrl: './autocomplete.component.html',\n  styleUrls: ['./autocomplete.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AutocompleteComponent extends FieldComponent<AutocompleteData>\n  implements OnInit {\n  constructor(\n    @Inject(COMPONENT_DATA) public cData: AutocompleteData,\n    private dbService: DbService\n  ) {\n    super(cData);\n  }\n\n  filteredSet$: Observable<Array<{name: string; value: string}>>;\n  loading$ = new BehaviorSubject(true);\n  prefix$: Observable<string>;\n  suffix$: Observable<string>;\n\n  ngOnInit() {\n\n    this.prefix$ = getHsd('prefix', this.cData);\n    this.suffix$ = getHsd('suffix', this.cData);\n\n    let dataSet$: Observable<Array<{name: string; value: string}>>;\n\n    if (this.cData.populate) {\n\n      const {populate} = this.cData;\n\n      dataSet$ = this.dbService\n        .getDocumentsSimple(\n          this.cData.populate.collection,\n          this.cData.populate.orderBy,\n          this.cData.populate.filter\n        )\n        .pipe(\n          map(docs =>\n            docs.map(doc => ({\n              value: doc[populate.valueKey || 'id'],\n              name: doc[populate.nameKey]\n            }))\n          ),\n          tap(() => this.loading$.next(false))\n        );\n    } else {\n      dataSet$ = of(this.cData.dataSet);\n    }\n\n    this.filteredSet$ = dataSet$.pipe(\n      switchMap(dataSet =>\n        this.cData.control.valueChanges.pipe(\n          startWith(this.cData.control.value),\n          map(value => {\n            if (!value) {\n              return dataSet;\n            }\n\n            value = value.toLowerCase();\n\n            return dataSet.filter(item =>\n              item.name.toLowerCase().includes(value)\n            );\n          })\n        )\n      )\n    );\n  }\n}\n","import {Component, ChangeDetectionStrategy} from '@angular/core';\nimport {FieldComponent} from '../../field/field.component';\nimport {FieldData} from '../../interfaces/field-data.interface';\n\n@Component({\n  selector: 'fb-checkbox',\n  templateUrl: './checkbox.component.html',\n  styleUrls: ['./checkbox.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class CheckboxComponent extends FieldComponent<FieldData> {}\n","import {ChangeDetectionStrategy, Component, OnInit} from '@angular/core';\nimport {MatChipInputEvent} from '@angular/material/chips';\nimport {Observable} from 'rxjs';\nimport {FieldComponent} from '../../field/field.component';\nimport {FieldData} from '../../interfaces/field-data.interface';\nimport {getHsd, HSD} from '../../utils/get-hsd';\n\ninterface ChipsData extends FieldData {\n  selectable: boolean;\n  removable: boolean;\n  addOnBlur: boolean;\n  unique: boolean;\n  autocomplete?: string;\n  suffix?: HSD;\n  prefix?: HSD;\n}\n\n@Component({\n  selector: 'fb-chips',\n  templateUrl: './chips.component.html',\n  styleUrls: ['./chips.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ChipsComponent extends FieldComponent<ChipsData>\n  implements OnInit {\n\n  data: string[] = [];\n  removable: boolean;\n  prefix$: Observable<string>;\n  suffix$: Observable<string>;\n\n  ngOnInit() {\n    this.data = this.cData.control.value;\n    this.removable = this.cData.hasOwnProperty('removable') ? this.cData.removable : true;\n    this.prefix$ = getHsd('prefix', this.cData);\n    this.suffix$ = getHsd('suffix', this.cData);\n  }\n\n  add(event: MatChipInputEvent) {\n    const value = (event.value || '').trim();\n    const input = event.input;\n\n    if (value && (this.cData.unique ? !this.data.includes(value) : true)) {\n      this.data.push(value);\n      this.cData.control.setValue(this.data);\n    }\n\n    if (input) {\n      input.value = '';\n    }\n  }\n\n  remove(chip: string) {\n    const index = this.cData.control.value.indexOf(chip);\n\n    if (index >= 0) {\n      this.data.splice(index, 1);\n      this.cData.control.setValue(this.data);\n    }\n  }\n}\n","import {\n  AbstractControl,\n  FormArray,\n  FormControl,\n  FormGroup\n} from '@angular/forms';\n\n/**\n * Deep clones the given AbstractControl, preserving values, validators, async validators, and disabled status.\n * @param control AbstractControl\n * @returns AbstractControl\n */\nexport function cloneAbstractControl<T extends AbstractControl>(control: T): T {\n  let newControl: T;\n\n  if (control instanceof FormGroup) {\n    const formGroup = new FormGroup(\n      {},\n      control.validator,\n      control.asyncValidator\n    );\n    const controls = control.controls;\n\n    Object.keys(controls).forEach(key => {\n      formGroup.addControl(key, cloneAbstractControl(controls[key]));\n    });\n\n    newControl = formGroup as any;\n  } else if (control instanceof FormArray) {\n    const formArray = new FormArray(\n      [],\n      control.validator,\n      control.asyncValidator\n    );\n\n    control.controls.forEach(formControl =>\n      formArray.push(cloneAbstractControl(formControl))\n    );\n\n    newControl = formArray as any;\n  } else if (control instanceof FormControl) {\n    newControl = new FormControl(\n      control.value,\n      control.validator,\n      control.asyncValidator\n    ) as any;\n  } else {\n    throw new Error('Error: unexpected control value');\n  }\n\n  if (control.disabled) {\n    newControl.disable({emitEvent: false});\n  }\n\n  return newControl;\n}\n","import {DatePipe} from '@angular/common';\nimport {ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject, OnInit} from '@angular/core';\nimport {FormControl, FormGroup, Validators} from '@angular/forms';\nimport {of} from 'rxjs';\nimport {tap} from 'rxjs/operators';\nimport {FieldComponent} from '../../field/field.component';\nimport {FormBuilderService} from '../../form-builder.service';\nimport {FieldData} from '../../interfaces/field-data.interface';\nimport {COMPONENT_DATA} from '../../utils/create-component-injector';\nimport {cloneAbstractControl} from '../../utils/clone-abstract-control';\n\ninterface DateData extends FieldData {\n  startYear?: number;\n  startAt?: number;\n  touchUi?: boolean;\n  startView?: 'month' | 'year' | 'multi-year';\n  format?: 'number' | string;\n  autocomplete?: string;\n  includeTime?: boolean;\n  labelHours?: string;\n  labelMinutes?: string;\n  placeholderHours?: string;\n  placeholderMinutes?: string;\n}\n\n@Component({\n  selector: 'fb-date-field',\n  templateUrl: './date-field.component.html',\n  styleUrls: ['./date-field.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class DateFieldComponent extends FieldComponent<DateData>\n  implements OnInit {\n  constructor(\n    @Inject(COMPONENT_DATA) public cData: DateData,\n    private cdr: ChangeDetectorRef,\n    private formBuilderService: FormBuilderService\n  ) {\n    super(cData);\n  }\n\n  form: FormGroup;\n  startDate: Date;\n  entryControl: FormControl;\n  hoursControl: FormControl;\n  minutesControl: FormControl;\n\n  ngOnInit() {\n    this.formBuilderService.saveComponents.push(this);\n    this.startDate = this.cData.startAt\n      ? new Date(this.cData.startAt)\n      : new Date();\n\n    const date = new Date(this.cData.control.value);\n\n    this.entryControl = cloneAbstractControl(this.cData.control);\n    this.hoursControl = new FormControl(\n      {value: date.getHours() || 0, disabled: this.cData.control.disabled},\n      [Validators.min(0), Validators.max(23)]\n    );\n    this.minutesControl = new FormControl(\n      {value: date.getMinutes() || 0, disabled: this.cData.control.disabled},\n      [Validators.min(0), Validators.max(59)]\n    );\n\n    /**\n     * Dirty hack for getting numbers to display properly might need revisiting\n     */\n    if (\n      typeof this.entryControl.value === 'number' ||\n      typeof this.entryControl.value === 'string'\n    ) {\n      this.entryControl.setValue(new Date(this.entryControl.value));\n    }\n  }\n\n  save() {\n    return of({}).pipe(\n      tap(() => {\n        let value = this.entryControl.value;\n\n        if (value) {\n          if (this.cData.includeTime) {\n            value.setHours(this.hoursControl.value || 0);\n            value.setMinutes(this.minutesControl.value || 0);\n          }\n\n          if (this.cData.format) {\n            if (this.cData.format === 'number') {\n              value = value.getTime();\n            } else {\n              const pipe = new DatePipe('en');\n\n              value = pipe.transform(value, this.cData.format);\n            }\n          }\n        }\n\n        this.cData.control.setValue(value);\n      })\n    );\n  }\n}\n","import {CdkDragDrop, moveItemInArray} from '@angular/cdk/drag-drop';\nimport {ChangeDetectionStrategy, Component, OnInit} from '@angular/core';\nimport {FieldComponent} from '../../field/field.component';\nimport {FieldData} from '../../interfaces/field-data.interface';\nimport {Option} from '../../interfaces/option.interface';\n\ninterface DragData extends FieldData {\n  options: Option[];\n}\n\n@Component({\n  selector: 'fb-draggable-list',\n  templateUrl: './draggable-list.component.html',\n  styleUrls: ['./draggable-list.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class DraggableListComponent extends FieldComponent<DragData>\n  implements OnInit {\n  ngOnInit() {\n    if (this.cData.control.value.length) {\n      this.cData.options.sort((optionOne, optionTwo) => {\n        const indexOne = this.cData.control.value.indexOf(optionOne);\n        const indexTwo = this.cData.control.value.indexOf(optionTwo);\n        return indexTwo - indexOne;\n      });\n    }\n  }\n\n  drop(event: CdkDragDrop<string[]>) {\n    moveItemInArray(\n      this.cData.options,\n      event.previousIndex,\n      event.currentIndex\n    );\n\n    this.cData.control.setValue(\n      this.cData.options.map(val => {\n        return val.value;\n      })\n    );\n  }\n}\n","export abstract class StorageService {\n  storage: any;\n\n  upload(path: string, data: any, metadata?: any): any {}\n}\n","/**\n * Remove all characters that are not alphanumeric.\n *\n * In case of not finding any alphanumeric characters\n * return string `file-{random number}`\n *\n * @param name\n * File name to format\n */\nexport const formatFileName = (name: string): string => {\n  const extension = name.slice(name.lastIndexOf('.'));\n  name = name.slice(0, name.lastIndexOf('.'));\n  name = (name.match(/[a-zA-Z\\d.]/g) || []).join('');\n  return !!name.length ? name + extension : `file-${Math.floor(Math.random() * 10 ** 5) + 1}${extension}`;\n};\n","export const parseSize = (size: string | number): number => {\n  if (typeof size === 'number') {\n    return size;\n  }\n\n  const KB = 1024;\n  const MB = KB ** 2;\n\n  const num = parseFloat(size);\n  const unit = size.replace(/[0-9]/g, '').toLowerCase();\n\n  switch (unit) {\n    case 'kb': {\n      return num * KB;\n    }\n    case 'mb': {\n      return num * MB;\n    }\n    default: {\n      return 0;\n    }\n  }\n};\n","import {ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, Inject, OnInit, ViewChild} from '@angular/core';\nimport {MatSnackBar} from '@angular/material/snack-bar';\nimport {TranslocoService} from '@ngneat/transloco';\nimport {from, of, throwError} from 'rxjs';\nimport {switchMap, tap} from 'rxjs/operators';\nimport {FieldComponent} from '../../field/field.component';\nimport {FormBuilderService} from '../../form-builder.service';\nimport {FieldData} from '../../interfaces/field-data.interface';\nimport {StorageService} from '../../services/storage.service';\nimport {COMPONENT_DATA} from '../../utils/create-component-injector';\nimport {formatFileName} from '../../utils/format-file-name';\nimport {parseSize} from '../../utils/parse-size';\n\ninterface FileData extends FieldData {\n  emptyLabel?: string;\n  preventClear?: boolean;\n  allowedFileTypes?: string[];\n  forbiddenFileTypes?: string[];\n  minSize?: string | number;\n  maxSize?: string | number;\n}\n\n@Component({\n  selector: 'fb-file',\n  templateUrl: './file.component.html',\n  styleUrls: ['./file.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class FileComponent extends FieldComponent<FileData> implements OnInit {\n  @ViewChild('file', {static: true})\n  fileEl: ElementRef<HTMLInputElement>;\n  value: File;\n  name: string;\n  emptyLabel: string;\n\n  allowedFileTypes: string[];\n  forbiddenFileTypes: string[];\n  minSizeBytes: number;\n  maxSizeBytes: number;\n\n  constructor(\n    @Inject(COMPONENT_DATA) public cData: FileData,\n    private storage: StorageService,\n    private cdr: ChangeDetectorRef,\n    private formBuilderService: FormBuilderService,\n    private transloco: TranslocoService,\n    private snackBar: MatSnackBar\n  ) {\n    super(cData);\n  }\n\n  ngOnInit() {\n    if (this.cData.control.value) {\n      this.name = this.cData.control.value;\n    }\n\n    this.emptyLabel = (this.cData.hasOwnProperty('emptyLabel') ? this.cData.emptyLabel : 'FIELDS.FILE.EMPTY') as string;\n\n    this.formBuilderService.saveComponents.push(this);\n\n    this.allowedFileTypes = this.cData.allowedFileTypes || [];\n    this.forbiddenFileTypes = this.cData.forbiddenFileTypes || [];\n    this.minSizeBytes = this.cData.minSize ? parseSize(this.cData.minSize) : 0;\n    this.maxSizeBytes = this.cData.maxSize ? parseSize(this.cData.maxSize) : 0;\n  }\n\n  errorSnack(message: string = 'GENERAL.ERROR', dismiss: string = 'GENERAL.DISMISS') {\n    this.snackBar.open(\n      this.transloco.translate(message),\n      this.transloco.translate(dismiss),\n      {\n        panelClass: 'snack-bar-error',\n        duration: 5000\n      }\n    );\n  }\n\n  fileChange(ev: Event) {\n    const el = ev.target as HTMLInputElement;\n    const file = Array.from(el.files as FileList)[0] as File;\n\n    Object.defineProperty(file, 'name', {\n      writable: true,\n      value: formatFileName(file.name)\n    });\n\n    if (!this.allowedFileTypes.includes(file.type) && !!this.allowedFileTypes.length) {\n      this.errorSnack('FIELDS.FILE.INVALID_FILE_FORMAT');\n      return throwError('Invalid File Format');\n    }\n\n    if (this.forbiddenFileTypes.includes(file.type)) {\n      this.errorSnack('FIELDS.FILE.FORBIDDEN_FILE_FORMAT');\n      return throwError('Forbidden File Format');\n    }\n\n    if (file.size < this.minSizeBytes) {\n      this.errorSnack('FIELDS.FILE.BELOW_SIZE');\n      return throwError('File below minimal allowed size');\n    }\n\n    if (file.size > this.maxSizeBytes && !!this.maxSizeBytes) {\n      this.errorSnack('FIELDS.FILE.EXCEED_SIZE');\n      return throwError('File exceeding allowed size');\n    }\n\n    this.value = file;\n    if (this.value) {\n      this.name = this.value.name;\n    }\n    el.value = '';\n  }\n\n  clear() {\n    this.name = '';\n    this.cData.control.setValue('');\n  }\n\n  save(moduleId: string, documentId: string) {\n    if (this.value) {\n      const name = [\n        moduleId,\n        documentId,\n        this.value.name\n      ]\n        .join('-');\n\n      return from(\n        this.storage.upload(name, this.value, {\n          contentType: this.value.type,\n          customMetadata: {\n            moduleId,\n            documentId\n          }\n        })\n      ).pipe(\n        switchMap((res: any) => res.ref.getDownloadURL()),\n        tap(url => this.cData.control.setValue(url))\n      );\n    } else {\n      return of({});\n    }\n  }\n}\n","import {GeneratedImage} from '../interfaces/generated-image.interface';\n\nexport function formatGeneratedImages(data: GeneratedImage[]) {\n  return data.reduce((acc, cur, index) => {\n    acc[`generate_${index + 1}`] = Object.entries(cur).reduce((generated, [key, value]) => {\n      generated += `----${key}:${value}`;\n      return generated;\n    }, '');\n    return acc;\n  }, {}) as {\n    [key: string]: string;\n  };\n}\n","import {InjectionToken} from '@angular/core';\n\nexport const STORAGE_URL = new InjectionToken<{}>('STORAGE_URL');\n","/**\n * Switches the location of two items\n * in an array\n */\nexport function switchItemLocations(\n  items: any[],\n  previousIndex: number,\n  currentIndex: number\n) {\n  const itemOne = items[previousIndex];\n  const itemTwo = items[currentIndex];\n\n  items[currentIndex] = itemOne;\n  items[previousIndex] = itemTwo;\n}\n","import {Observable} from 'rxjs';\n\nexport function readFile(blob: Blob): Observable<string> {\n  return new Observable(obs => {\n    if (!(blob instanceof Blob)) {\n      obs.error(new Error('`blob` must be an instance of File or Blob.'));\n      return;\n    }\n\n    const reader = new FileReader();\n\n    reader.onerror = err => obs.error(err);\n    reader.onabort = err => obs.error(err);\n    reader.onload = () => obs.next(reader.result as string);\n    reader.onloadend = () => obs.complete();\n\n    return reader.readAsDataURL(blob);\n  });\n}\n","import {CdkDrag, CdkDragDrop, CdkDragMove, CdkDropList, CdkDropListGroup, moveItemInArray} from '@angular/cdk/drag-drop';\nimport {ViewportRuler} from '@angular/cdk/overlay';\nimport {HttpClient} from '@angular/common/http';\nimport {\n  AfterViewInit,\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  ElementRef,\n  Inject,\n  OnInit,\n  Optional,\n  TemplateRef,\n  ViewChild\n} from '@angular/core';\nimport {MatDialog} from '@angular/material/dialog';\nimport {MatSnackBar} from '@angular/material/snack-bar';\nimport {TranslocoService} from '@ngneat/transloco';\nimport {forkJoin, from, of, throwError} from 'rxjs';\nimport {catchError, map, switchMap, tap} from 'rxjs/operators';\nimport {FieldComponent} from '../../field/field.component';\nimport {FormBuilderService} from '../../form-builder.service';\nimport {FieldData} from '../../interfaces/field-data.interface';\nimport {GeneratedImage} from '../../interfaces/generated-image.interface';\nimport {StorageService} from '../../services/storage.service';\nimport {COMPONENT_DATA} from '../../utils/create-component-injector';\nimport {formatFileName} from '../../utils/format-file-name';\nimport {formatGeneratedImages} from '../../utils/format-generated-images';\nimport {parseSize} from '../../utils/parse-size';\nimport {STORAGE_URL} from '../../utils/storage-url';\nimport {switchItemLocations} from '../../utils/switch-item-locations';\nimport {readFile} from './read-file';\n\ninterface GalleryData extends FieldData {\n  allowUrl?: boolean;\n  allowServerUpload?: boolean;\n  generatedImages?: GeneratedImage[];\n  allowedImageTypes?: string[];\n  forbiddenImageTypes?: string[];\n  minSize?: string | number;\n  maxSize?: string | number;\n}\n\n@Component({\n  selector: 'fb-gallery',\n  templateUrl: './gallery.component.html',\n  styleUrls: ['./gallery.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class GalleryComponent extends FieldComponent<GalleryData>\n  implements OnInit, AfterViewInit {\n  constructor(\n    @Inject(COMPONENT_DATA)\n    public cData: GalleryData,\n    @Optional()\n    @Inject(STORAGE_URL)\n    private storageUrl: string,\n    private dialog: MatDialog,\n    private cdr: ChangeDetectorRef,\n    private http: HttpClient,\n    private storage: StorageService,\n    private formBuilderService: FormBuilderService,\n    private viewportRuler: ViewportRuler,\n    private transloco: TranslocoService,\n    private snackBar: MatSnackBar\n  ) {\n    super(cData);\n  }\n\n  @ViewChild(CdkDropListGroup, {static: true})\n  listGroup: CdkDropListGroup<CdkDropList>;\n  @ViewChild(CdkDropList, {static: true})\n  placeholder: CdkDropList;\n  @ViewChild('modal', {static: true})\n  modalTemplate: TemplateRef<any>;\n  @ViewChild('imagesSort', {static: true})\n  imagesSort: TemplateRef<any>;\n  @ViewChild('file', {static: true})\n  fileEl: ElementRef<HTMLInputElement>;\n  target: CdkDropList | null;\n  targetIndex: number;\n  source: CdkDropList | null;\n  sourceIndex: number;\n  activeContainer: any;\n  files: File[] = [];\n  toRemove: any[] = [];\n\n  allowedImageTypes: string[];\n  forbiddenImageTypes: string[];\n  minSizeBytes: number;\n  maxSizeBytes: number;\n\n  ngOnInit() {\n    this.formBuilderService.saveComponents.push(this);\n\n    this.allowedImageTypes = this.cData.allowedImageTypes || [];\n    this.forbiddenImageTypes = this.cData.forbiddenImageTypes || [];\n    this.minSizeBytes = this.cData.minSize ? parseSize(this.cData.minSize) : 0;\n    this.maxSizeBytes = this.cData.maxSize ? parseSize(this.cData.maxSize) : 0;\n  }\n\n  ngAfterViewInit() {\n    const phElement = this.placeholder.element.nativeElement;\n    const {parentElement} = phElement as any;\n\n    phElement.style.display = 'none';\n    parentElement.removeChild(phElement);\n  }\n\n  openUploadDialog() {\n    this.dialog.open(this.modalTemplate, {\n      width: '420px'\n    });\n  }\n\n  addImage(image: string) {\n    this.http\n      .get(image, {\n        withCredentials: false,\n        responseType: 'blob'\n      })\n      .pipe(\n        switchMap((blob: Blob) => {\n          const type = blob.type.split('/')[1].toLowerCase();\n          if (!this.allowedImageTypes.includes(type) && !!this.allowedImageTypes.length) {\n            return throwError('Invalid Image Format');\n          }\n\n          if (this.forbiddenImageTypes.includes(type)) {\n            return throwError('Forbidden Image Format');\n          }\n\n          if (blob.size < this.minSizeBytes) {\n            return throwError('Image below minimal allowed size');\n          }\n\n          if (blob.size > this.maxSizeBytes && !!this.maxSizeBytes) {\n            return throwError('Image exceeding allowed size');\n          }\n\n          return of(blob);\n        }),\n        this.formBuilderService.notify({\n          error: 'FIELDS.GALLERY.UPLOAD_ERROR',\n          success: null\n        }))\n      .subscribe(res => {\n        const urlCreator = window.URL || (window as any).webkitURL;\n        const value = this.cData.control.value;\n\n        value.push({\n          data: urlCreator.createObjectURL(res),\n          live: true\n        });\n\n        this.cData.control.setValue(value);\n        this.cdr.detectChanges();\n      });\n  }\n\n  openFileUpload() {\n    this.fileEl.nativeElement.click();\n  }\n\n  openSortImages() {\n    this.dialog.open(this.imagesSort, {\n      width: '800px'\n    });\n  }\n\n  drop(event: CdkDragDrop<string[]>) {\n    const value = this.cData.control.value;\n    switchItemLocations(value, event.previousIndex, event.currentIndex);\n    this.cData.control.setValue(value);\n    this.cdr.detectChanges();\n  }\n\n  move(up = false, index: number) {\n    const currentIndex = up ? index - 1 : index + 1;\n    const value = this.cData.control.value;\n    moveItemInArray(value, index, currentIndex);\n    this.cData.control.setValue(value);\n    this.cdr.detectChanges();\n  }\n\n  errorSnack(message: string = 'GENERAL.ERROR', dismiss: string = 'GENERAL.DISMISS') {\n    this.snackBar.open(\n      this.transloco.translate(message),\n      this.transloco.translate(dismiss),\n      {\n        panelClass: 'snack-bar-error',\n        duration: 5000\n      }\n    );\n  }\n\n  filesUploaded(el: HTMLInputElement | FileList) {\n    const files = Array.from((el instanceof FileList ? el : el.files) as FileList);\n    for (const file of files) {\n      Object.defineProperty(file, 'name', {\n        writable: true,\n        value: formatFileName(file.name)\n      });\n\n      const type = file.type.split('/')[1].toLowerCase();\n\n      if (!this.allowedImageTypes.includes(type) && !!this.allowedImageTypes.length) {\n        this.errorSnack('FIELDS.GALLERY.INVALID_IMAGE_FORMAT');\n        return throwError('Invalid Image Format');\n      }\n\n      if (this.forbiddenImageTypes.includes(type)) {\n        this.errorSnack('FIELDS.GALLERY.FORBIDDEN_IMAGE_FORMAT');\n        return throwError('Forbidden Image Format');\n      }\n\n      if (file.size < this.minSizeBytes) {\n        this.errorSnack('FIELDS.GALLERY.BELOW_SIZE');\n        return throwError('Image below minimal allowed size');\n      }\n\n      if (file.size > this.maxSizeBytes && !!this.maxSizeBytes) {\n        this.errorSnack('FIELDS.GALLERY.EXCEED_SIZE');\n        return throwError('Image exceeding allowed size');\n      }\n    }\n\n    forkJoin(\n      files.map(file =>\n        readFile(file).pipe(\n          map(data => ({\n            data,\n            pushToLive: file,\n            live: false\n          }))\n        )\n      )\n    ).subscribe(\n      fls => {\n        const value = this.cData.control.value;\n        value.push(...fls);\n        this.cData.control.setValue(value);\n\n        if (!(el instanceof FileList)) {\n          el.value = '';\n        }\n\n        this.cdr.detectChanges();\n      },\n      () => {\n        if (!(el instanceof FileList)) {\n          el.value = '';\n        }\n      }\n    );\n  }\n\n  removeImage(index: number, item: any) {\n    if (item.live && item.data.includes(this.storageUrl)) {\n      this.toRemove.push(item.data);\n    }\n\n    this.cData.control.value.splice(index, 1);\n  }\n\n  sortDrop(event: CdkDragDrop<string[]>) {\n    const value = this.cData.control.value;\n    moveItemInArray(value, event.previousIndex, event.currentIndex);\n    this.cData.control.setValue(value);\n  }\n\n  /**\n   * Drag and Drop\n   */\n  dragMoved(e: CdkDragMove) {\n    const point = this.getPointerPositionOnPage(e.event);\n\n    this.listGroup._items.forEach(dropList => {\n      if (__isInsideDropListClientRect(dropList, point.x, point.y)) {\n        this.activeContainer = dropList;\n        return;\n      }\n    });\n  }\n\n  dropListDropped() {\n    if (!this.target) {\n      return;\n    }\n\n    const phElement = this.placeholder.element.nativeElement;\n    const parent: any = phElement.parentElement;\n\n    phElement.style.display = 'none';\n\n    const {element} = this.source as any;\n\n    parent.removeChild(phElement);\n    parent.appendChild(phElement);\n    parent.insertBefore(element.nativeElement, parent.children[this.sourceIndex]);\n\n    this.target = null;\n    this.source = null;\n\n    if (this.sourceIndex !== this.targetIndex) {\n      const value = this.cData.control.value;\n      moveItemInArray(value, this.sourceIndex, this.targetIndex);\n      this.cData.control.setValue(value);\n    }\n  }\n\n  /** Determines the point of the page that was touched by the user. */\n  getPointerPositionOnPage(event: MouseEvent | TouchEvent) {\n    // `touches` will be empty for start/end events so we have to fall back to `changedTouches`.\n    const point = __isTouchEvent(event) ? (event.touches[0] || event.changedTouches[0]) : event;\n    const scrollPosition = this.viewportRuler.getViewportScrollPosition();\n\n    return {\n      x: point.pageX - scrollPosition.left,\n      y: point.pageY - scrollPosition.top\n    };\n  }\n\n  /**\n   * Executes all uploads/removes to persist\n   * the changes on server\n   */\n  save(moduleId: string, documentId: string) {\n    if (\n      !this.toRemove.length &&\n      !this.cData.control.value ||\n      !this.cData.control.value.find((val: any) => !val.live)\n    ) {\n      return of([]);\n    }\n\n    return forkJoin([\n      ...this.toRemove.map(file =>\n        from(this.storage.storage.refFromURL(file).delete()).pipe(\n          /**\n           * Dont' fail if files didn't delete\n           */\n          catchError(() => of([]))\n        )\n      ),\n      ...this.cData.control.value.reduce((acc: any[], cur: any) => {\n        if (cur.live !== undefined && !cur.live) {\n\n          const name = [\n            moduleId,\n            documentId,\n            cur.pushToLive.name\n          ]\n            .join('-');\n\n          acc.push(\n            from(\n              this.storage.upload(name, cur.pushToLive, {\n                contentType: cur.pushToLive.type,\n                customMetadata: {\n                  moduleId,\n                  documentId,\n                  ...this.cData.generatedImages &&\n                  formatGeneratedImages(this.cData.generatedImages)\n                }\n              })\n            ).pipe(\n              switchMap((task: any) => task.ref.getDownloadURL()),\n              tap(url => {\n                cur.data = url;\n              })\n            )\n          );\n        } else {\n          acc.push(cur);\n        }\n\n        return acc;\n      }, [])\n    ]).pipe(\n      tap(() =>\n        this.cData.control.setValue(\n          this.cData.control.value.map((item: any) => (item.data ? item.data : item))\n        )\n      )\n    );\n  }\n}\n\nfunction __indexOf(collection: any, node: any) {\n  return Array.prototype.indexOf.call(collection, node);\n}\n\n/** Determines whether an event is a touch event. */\nfunction __isTouchEvent(event: MouseEvent | TouchEvent): event is TouchEvent {\n  return event.type.startsWith('touch');\n}\n\nfunction __isInsideDropListClientRect(dropList: CdkDropList, x: number, y: number) {\n  const {top, bottom, left, right} = dropList.element.nativeElement.getBoundingClientRect();\n  return y >= top && y <= bottom && x >= left && x <= right;\n}\n","import {ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, Inject, OnInit, ViewChild} from '@angular/core';\nimport {FormControl} from '@angular/forms';\nimport {MatSnackBar} from '@angular/material/snack-bar';\nimport {DomSanitizer, SafeResourceUrl} from '@angular/platform-browser';\nimport {TranslocoService} from '@ngneat/transloco';\nimport {from, of, throwError} from 'rxjs';\nimport {switchMap, tap} from 'rxjs/operators';\nimport {FieldComponent} from '../../field/field.component';\nimport {FormBuilderService} from '../../form-builder.service';\nimport {FieldData} from '../../interfaces/field-data.interface';\nimport {GeneratedImage} from '../../interfaces/generated-image.interface';\nimport {StorageService} from '../../services/storage.service';\nimport {COMPONENT_DATA} from '../../utils/create-component-injector';\nimport {formatFileName} from '../../utils/format-file-name';\nimport {formatGeneratedImages} from '../../utils/format-generated-images';\nimport {parseSize} from '../../utils/parse-size';\n\ninterface ImageData extends FieldData {\n  preventServerUpload?: boolean;\n  generatedImages?: GeneratedImage[];\n  allowedImageTypes?: string[];\n  forbiddenImageTypes?: string[];\n  minSize?: string | number;\n  maxSize?: string | number;\n}\n\n@Component({\n  selector: 'fb-image',\n  templateUrl: './image.component.html',\n  styleUrls: ['./image.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ImageComponent extends FieldComponent<ImageData>\n  implements OnInit {\n  constructor(\n    @Inject(COMPONENT_DATA) public cData: ImageData,\n    private storage: StorageService,\n    private cdr: ChangeDetectorRef,\n    private formBuilderService: FormBuilderService,\n    private transloco: TranslocoService,\n    private snackBar: MatSnackBar,\n    private domSanitizer: DomSanitizer\n  ) {\n    super(cData);\n  }\n\n  @ViewChild('file', {static: true})\n  fileEl: ElementRef<HTMLInputElement>;\n  value: File | null;\n  imageUrl: FormControl;\n  disInput = false;\n  imageSrc: SafeResourceUrl;\n\n  allowedImageTypes: string[];\n  forbiddenImageTypes: string[];\n  minSizeBytes: number;\n  maxSizeBytes: number;\n\n  ngOnInit() {\n    this.imageUrl = new FormControl(this.cData.control.value);\n    this.formBuilderService.saveComponents.push(this);\n\n    this.allowedImageTypes = this.cData.allowedImageTypes || [];\n    this.forbiddenImageTypes = this.cData.forbiddenImageTypes || [];\n    this.minSizeBytes = this.cData.minSize ? parseSize(this.cData.minSize) : 0;\n    this.maxSizeBytes = this.cData.maxSize ? parseSize(this.cData.maxSize) : 0;\n  }\n\n  errorSnack(message: string = 'GENERAL.ERROR', dismiss: string = 'GENERAL.DISMISS') {\n    this.snackBar.open(\n      this.transloco.translate(message),\n      this.transloco.translate(dismiss),\n      {\n        panelClass: 'snack-bar-error',\n        duration: 5000\n      }\n    );\n  }\n\n  openFileUpload() {\n    this.fileEl.nativeElement.click();\n  }\n\n  filesImage(event: Event) {\n    const el = event.target as HTMLInputElement;\n    const image = Array.from(el.files as FileList)[0] as File;\n\n    Object.defineProperty(image, 'name', {\n      writable: true,\n      value: formatFileName(image.name)\n    });\n\n    if (!this.allowedImageTypes.includes(image.type) && !!this.allowedImageTypes.length) {\n      this.errorSnack('FIELDS.GALLERY.INVALID_IMAGE_FORMAT');\n      return throwError('Invalid Image Format');\n    }\n\n    if (this.forbiddenImageTypes.includes(image.type)) {\n      this.errorSnack('FIELDS.GALLERY.FORBIDDEN_IMAGE_FORMAT');\n      return throwError('Forbidden Image Format');\n    }\n\n    if (image.size < this.minSizeBytes) {\n      this.errorSnack('FIELDS.GALLERY.BELOW_SIZE');\n      return throwError('Image below minimal allowed size');\n    }\n\n    if (image.size > this.maxSizeBytes && !!this.maxSizeBytes) {\n      this.errorSnack('FIELDS.GALLERY.EXCEED_SIZE');\n      return throwError('Image exceeding allowed size');\n    }\n\n    this.value = image;\n    this.disInput = true;\n    this.imageUrl.setValue(this.value.name);\n\n    const reader = new FileReader();\n    reader.onload = () => {\n      this.imageSrc = this.domSanitizer.bypassSecurityTrustResourceUrl(\n        reader.result as string\n      );\n      this.cdr.detectChanges();\n    };\n    reader.readAsDataURL(this.value);\n    el.value = '';\n  }\n\n  remove() {\n    this.imageUrl.setValue('');\n    this.value = null;\n    this.disInput = false;\n    this.cdr.detectChanges();\n  }\n\n  save(moduleId: string, documentId: string) {\n    if (this.value) {\n      if (this.imageUrl.value && this.imageUrl.value !== this.value.name) {\n        return of(this.imageUrl.value).pipe(\n          tap(() => this.cData.control.setValue(this.imageUrl.value))\n        );\n      } else {\n\n        const name = [\n          moduleId,\n          documentId,\n          this.value.name\n        ]\n          .join('-');\n\n        return from(\n          this.storage.upload(name, this.value, {\n            contentType: this.value.type,\n            customMetadata: {\n              moduleId,\n              documentId,\n              ...(this.cData.generatedImages &&\n                formatGeneratedImages(this.cData.generatedImages))\n            }\n          })\n        ).pipe(\n          switchMap((res: any) => res.ref.getDownloadURL()),\n          tap(url => this.cData.control.setValue(url))\n        );\n      }\n    } else {\n      this.cData.control.setValue(this.imageUrl.value);\n      return of({});\n    }\n  }\n}\n","import {ChangeDetectionStrategy, Component, OnInit} from '@angular/core';\nimport {Observable} from 'rxjs';\nimport {FieldComponent} from '../../field/field.component';\nimport {FieldData} from '../../interfaces/field-data.interface';\nimport {getHsd, HSD} from '../../utils/get-hsd';\n\ninterface InputData extends FieldData {\n  type: 'text' | 'number' | 'email';\n  autocomplete?: string;\n  suffix?: HSD;\n  prefix?: HSD;\n}\n\n@Component({\n  selector: 'fb-input',\n  templateUrl: './input.component.html',\n  styleUrls: ['./input.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class InputComponent extends FieldComponent<InputData> implements OnInit {\n\n  prefix$: Observable<string>;\n  suffix$: Observable<string>;\n\n  ngOnInit() {\n    this.prefix$ = getHsd('prefix', this.cData);\n    this.suffix$ = getHsd('suffix', this.cData);\n  }\n}\n","import {ChangeDetectionStrategy, Component} from '@angular/core';\nimport {FieldComponent} from '../../field/field.component';\nimport {FieldData} from '../../interfaces/field-data.interface';\nimport {Option} from '../../interfaces/option.interface';\n\ninterface RadioData extends FieldData {\n  options: Option[];\n}\n\n@Component({\n  selector: 'fb-radio',\n  templateUrl: './radio.component.html',\n  styleUrls: ['./radio.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class RadioComponent extends FieldComponent<RadioData> {}\n","import {ChangeDetectorRef, Component, Inject, OnInit} from '@angular/core';\nimport {FormControl, Validators} from '@angular/forms';\nimport {of} from 'rxjs';\nimport {tap} from 'rxjs/operators';\nimport {FieldComponent} from '../../field/field.component';\nimport {FormBuilderService} from '../../form-builder.service';\nimport {FieldData} from '../../interfaces/field-data.interface';\nimport {cloneAbstractControl} from '../../utils/clone-abstract-control';\nimport {COMPONENT_DATA} from '../../utils/create-component-injector';\n\ninterface RangeData extends FieldData {\n  min?: number;\n  max?: number;\n}\n\n@Component({\n  selector: 'fb-range',\n  templateUrl: './range.component.html',\n  styleUrls: ['./range.component.css']\n})\nexport class RangeComponent extends FieldComponent<RangeData> implements OnInit {\n\n  entryControl: FormControl;\n  start: FormControl;\n  end: FormControl;\n  min: Date;\n  max: Date;\n\n  constructor(\n    @Inject(COMPONENT_DATA) public cData: RangeData,\n    private cdr: ChangeDetectorRef,\n    private formBuilderService: FormBuilderService\n  ) {\n    super(cData);\n  }\n\n  ngOnInit(): void {\n    this.formBuilderService.saveComponents.push(this);\n\n    this.min = new Date(this.cData.min || 0);\n    this.max = new Date(this.cData.max || Date.now() * 2);\n    this.entryControl = cloneAbstractControl(this.cData.control);\n\n    this.start = new FormControl(\n      {value: this.entryControl.value.start || '', disabled: this.cData.control.disabled},\n      [Validators.min(this.cData.min || 0)]\n    );\n\n    this.end = new FormControl(\n      {value: this.entryControl.value.end || '', disabled: this.cData.control.disabled},\n      [Validators.max(this.cData.max || Date.now() * 2)]\n    );\n  }\n\n  save() {\n    return of({}).pipe(\n      tap(() => {\n        const start = this.start.value;\n        const end = this.end.value;\n        this.cData.control.setValue({start, end});\n      })\n    );\n  }\n}\n","import {InjectionToken} from '@angular/core';\n\nexport const ADDITIONAL_CONTEXT = new InjectionToken<{}>('ADDITIONAL_CONTEXT');\n","export function parseTemplate(\n  value = '',\n  obj: any = {}\n) {\n\n  if (!value.includes('{{')) {\n    return obj[value];\n  } else {\n\n    const lookUp = new RegExp(`{{(.*?)}}`);\n\n    while (lookUp.test(value)) {\n      value = value.replace(\n        lookUp,\n        (RegExp.$1)\n          .split('.')\n          .reduce((acc, cur) =>\n              acc[cur],\n            obj\n          )\n      );\n    }\n\n    return value;\n  }\n}\n","import {InjectionToken} from '@angular/core';\n\nexport const ROLE = new InjectionToken<{}>('ROLE');\n","import {ChangeDetectionStrategy, Component, Inject, OnInit, Optional} from '@angular/core';\nimport {BehaviorSubject, Observable, of} from 'rxjs';\nimport {map, startWith, switchMap, tap} from 'rxjs/operators';\nimport {FieldComponent} from '../../field/field.component';\nimport {FieldData} from '../../interfaces/field-data.interface';\nimport {Option} from '../../interfaces/option.interface';\nimport {WhereFilter} from '../../interfaces/where-filter.interface';\nimport {DbService} from '../../services/db.service';\nimport {ADDITIONAL_CONTEXT} from '../../utils/additional-context';\nimport {COMPONENT_DATA} from '../../utils/create-component-injector';\nimport {parseTemplate} from '../../utils/parse-template';\nimport {ROLE} from '../../utils/role';\nimport {safeEval} from '../../utils/safe-eval';\n\ninterface Populate {\n  collection?: string;\n  nameKey?: string;\n  valueKey?: string;\n  orderBy?: string;\n\n  /**\n   * A method for mapping all of the results\n   * (items: T[]) => any[]\n   */\n  mapResults?: string;\n\n  /**\n   * If a filter is a string\n   * it represents the id of the document\n   */\n  filter?: WhereFilter | string;\n\n  /**\n   * A stringified function that receives\n   * an object with {fieldData: SelectData, value: form.getRawValue(), role: string, additionalContext?: any}\n   * and should return a WhereFilter.\n   * This doesn't work in combination with the dependency property\n   */\n  dynamicFilter?: string;\n\n  /**\n   * Use this property if the field depends on changes\n   * of a different field in the form\n   */\n  dependency?: {\n    key: string;\n\n    /**\n     * A method for defining query dynamically\n     * (value) => {collection: string; orderBy: string; filter: WhereFilter | string}\n     */\n    method: string;\n  };\n}\n\ninterface SelectData extends FieldData {\n  dataSet?: Option[];\n  multiple?: boolean;\n  populate?: Populate;\n  autocomplete?: string;\n}\n\n@Component({\n  selector: 'fb-select',\n  templateUrl: './select.component.html',\n  styleUrls: ['./select.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class SelectComponent extends FieldComponent<SelectData>\n  implements OnInit {\n  dataSet$: Observable<Option[]>;\n  loading$ = new BehaviorSubject(true);\n\n  constructor(\n    @Inject(COMPONENT_DATA) public cData: SelectData,\n    private dbService: DbService,\n    @Inject(ROLE)\n    private role: string,\n    @Optional()\n    @Inject(ADDITIONAL_CONTEXT)\n    private additionalContext: any\n  ) {\n    super(cData);\n  }\n\n  ngOnInit() {\n    if (this.cData.populate) {\n\n      const populate = this.cData.populate as Populate;\n\n      const mapResults = populate.mapResults ? safeEval(populate.mapResults) : null;\n      const documentsMethod = (\n        query?: {\n          collection: string,\n          orderBy: string,\n          filter: WhereFilter | string\n        }\n      ) => {\n\n        this.loading$.next(true);\n\n        if (!query) {\n          this.loading$.next(false);\n          return of([]);\n        }\n\n        if (query.filter && typeof query.filter === 'string') {\n          return this.dbService.getDocument(\n            query.collection,\n            query.filter\n          )\n            .pipe(\n              map(it => {\n                return (mapResults ? mapResults(it) : [it]).map((doc: any) => ({\n                  value: doc[populate.valueKey || 'id'],\n                  name: parseTemplate(\n                    populate.nameKey || 'name',\n                    doc\n                  )\n                }));\n              }),\n              tap(() => this.loading$.next(false))\n            );\n        }\n\n        return this.dbService\n          .getDocumentsSimple(\n            query.collection,\n            query.orderBy,\n            query.filter as WhereFilter\n          )\n          .pipe(\n            map(docs => {\n              if (mapResults) {\n                docs = mapResults(docs, {\n                  fieldData: this.cData,\n                  value: this.cData.form.getRawValue(),\n                  role: this.role,\n                  additionalContext: this.additionalContext\n                });\n              }\n\n              return docs.map(doc => ({\n                value: doc[populate.valueKey || 'id'],\n                name: parseTemplate(\n                  populate.nameKey || 'name',\n                  doc\n                )\n              }));\n            }),\n            tap(() => this.loading$.next(false))\n          );\n      };\n\n      if (populate.dependency) {\n\n        const pointer = this.cData.pointers[populate.dependency.key];\n        const gm = safeEval(populate.dependency.method);\n\n        this.dataSet$ = pointer.control.valueChanges\n          .pipe(\n            startWith(\n              pointer.control.value\n            ),\n            switchMap(value =>\n              documentsMethod(\n                gm(value, {\n                  fieldData: this.cData,\n                  value: this.cData.form.getRawValue(),\n                  role: this.role,\n                  additionalContext: this.additionalContext\n                })\n              )\n            )\n          );\n      } else {\n\n        let filter: WhereFilter = populate.filter as WhereFilter;\n\n        if (populate.dynamicFilter) {\n          filter = safeEval(populate.dynamicFilter)({\n            fieldData: this.cData,\n            value: this.cData.form.getRawValue(),\n            role: this.role,\n            additionalContext: this.additionalContext\n          });\n        }\n\n        this.dataSet$ = documentsMethod({\n          collection: populate.collection,\n          orderBy: populate.orderBy,\n          filter\n        } as any);\n      }\n    } else {\n      this.dataSet$ = of(this.cData.dataSet as any);\n    }\n  }\n}\n","import {ChangeDetectionStrategy, Component, OnInit} from '@angular/core';\nimport {FieldComponent} from '../../field/field.component';\nimport {FieldData} from '../../interfaces/field-data.interface';\n\ninterface SliderData extends FieldData {\n  validation: {\n    minimum: number;\n    maximum: number;\n  };\n  thumbLabel: boolean;\n  tickInterval: number;\n  starAt: number;\n  endAt: number;\n}\n\n@Component({\n  selector: 'fb-slider',\n  templateUrl: './slider.component.html',\n  styleUrls: ['./slider.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class SliderComponent extends FieldComponent<SliderData>\n  implements OnInit {\n  startAt: number;\n  endAt: number;\n\n  ngOnInit() {\n    this.startAt = this.cData.starAt\n      ? this.cData.starAt\n      : this.cData.validation.minimum\n      ? this.cData.validation.minimum\n      : 0;\n    this.endAt = this.cData.endAt\n      ? this.cData.endAt\n      : this.cData.validation.maximum\n      ? this.cData.validation.maximum\n      : 100;\n  }\n}\n","import {Component, ChangeDetectionStrategy, OnInit} from '@angular/core';\nimport {Observable} from 'rxjs';\nimport {FieldComponent} from '../../field/field.component';\nimport {FieldData} from '../../interfaces/field-data.interface';\nimport {getHsd, HSD} from '../../utils/get-hsd';\n\ninterface TextareaData extends FieldData {\n  rows?: number;\n  cols?: number;\n  autocomplete?: string;\n  suffix?: HSD;\n  prefix?: HSD;\n}\n\n@Component({\n  selector: 'fb-textarea',\n  templateUrl: './textarea.component.html',\n  styleUrls: ['./textarea.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class TextareaComponent extends FieldComponent<TextareaData> implements OnInit {\n\n  prefix$: Observable<string>;\n  suffix$: Observable<string>;\n\n  ngOnInit() {\n    this.prefix$ = getHsd('prefix', this.cData);\n    this.suffix$ = getHsd('suffix', this.cData);\n  }\n}\n","import {ChangeDetectionStrategy, Component} from '@angular/core';\nimport {FieldComponent} from '../../field/field.component';\nimport {FieldData} from '../../interfaces/field-data.interface';\n\n@Component({\n  selector: 'fb-toggle',\n  templateUrl: './toggle.component.html',\n  styleUrls: ['./toggle.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ToggleComponent extends FieldComponent<FieldData> {}\n","import {\n  AfterViewInit,\n  ChangeDetectionStrategy,\n  Component,\n  ElementRef,\n  Inject,\n  OnInit,\n  TemplateRef,\n  ViewChild\n} from '@angular/core';\nimport {FormBuilder, FormGroup, Validators} from '@angular/forms';\nimport {MatDialog} from '@angular/material/dialog';\nimport {filter, take} from 'rxjs/operators';\nimport {FieldComponent} from '../../field/field.component';\nimport 'tinymce/plugins/code';\nimport 'tinymce/plugins/print';\nimport 'tinymce/plugins/wordcount';\nimport 'tinymce/plugins/link';\nimport 'tinymce/plugins/image';\nimport 'tinymce/plugins/imagetools';\nimport 'tinymce/plugins/fullscreen';\nimport 'tinymce/plugins/lists';\nimport 'tinymce/plugins/autolink';\nimport 'tinymce/plugins/advlist';\nimport 'tinymce/plugins/table';\nimport {FormBuilderComponent} from '../../form-builder.component';\nimport {FieldData} from '../../interfaces/field-data.interface';\nimport {StorageService} from '../../services/storage.service';\nimport {COMPONENT_DATA} from '../../utils/create-component-injector';\n\ndeclare const tinymce: any;\n\nexport interface WysiwygData extends FieldData {\n  menubar?: string;\n  toolbar?: string;\n  height?: number;\n}\n\n@Component({\n  selector: 'fb-wysiwyg',\n  templateUrl: './wysiwyg.component.html',\n  styleUrls: ['./wysiwyg.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class WysiwygComponent extends FieldComponent<WysiwygData>\n  implements OnInit, AfterViewInit {\n  constructor(\n    @Inject(COMPONENT_DATA) public cData: WysiwygData,\n    private fb: FormBuilder,\n    private dialog: MatDialog,\n    private storage: StorageService,\n    private formBuilderComponent: FormBuilderComponent\n  ) {\n    super(cData);\n  }\n\n  @ViewChild('textarea', {static: true})\n  textarea: ElementRef;\n\n  @ViewChild('youTubeDialog', {static: true})\n  youTubeDialogTemplate: TemplateRef<any>;\n\n  editor: any;\n  ytForm: FormGroup;\n  ytDefault = {\n    fullWidth: true,\n    showPlayerControls: true,\n    privacyEnhancedMode: false,\n    align: 'left'\n  };\n\n  ngOnInit() {\n    this.ytForm = this.fb.group({\n      value: ['', Validators.required],\n      ...this.ytDefault\n    });\n\n    this.cData.control.statusChanges.subscribe(value => {\n      if (value === 'DISABLED') {\n        tinymce.activeEditor.getBody().setAttribute('readonly', true);\n      } else if (this.cData.control.disabled) {\n        tinymce.activeEditor.getBody().setAttribute('readonly', false);\n      }\n    });\n  }\n\n  ngAfterViewInit() {\n    this.registerTiny();\n  }\n\n  private registerTiny() {\n    tinymce.init({\n      target: this.textarea.nativeElement,\n      branding: false,\n      height: this.cData.height || 420,\n      plugins: [\n        'code',\n        'print',\n        'wordcount',\n        'link',\n        'lists',\n        'advlist',\n        'autolink',\n        'image',\n        'imagetools',\n        'fullscreen',\n        'table'\n      ],\n      menubar: this.cData.menubar || 'edit insert view format table tools help',\n      image_advtab: true,\n\n      /**\n       * Link settings\n       */\n      default_link_target: '_blank',\n      readonly: this.cData.control.disabled,\n      toolbar: this.cData.toolbar || [\n        'undo redo',\n        'insert',\n        'styleselect',\n        'bold italic',\n        'forecolor backcolor',\n        'alignleft aligncenter alignright alignjustify',\n        'bullist numlist outdent indent',\n        'link',\n        'image',\n        'youTube',\n        'fullscreen',\n      ].join(' | '),\n\n      images_upload_handler: (blobInfo: any, success: any, failure: any) => {\n        this.storage\n          .upload(\n            blobInfo.filename(),\n            blobInfo.blob(),\n            this.formBuilderComponent.id ? {\n              customMetadata: {\n                collection: this.formBuilderComponent.id\n              }\n            } : {}\n          )\n          .then((data: any) => data.ref.getDownloadURL())\n          .then((url: any) => success(url))\n          .catch((error: any) => failure(error.toString()));\n      },\n\n      setup: (editor: any) => {\n        this.editor = editor;\n\n        editor.on('keyup change', () => {\n          const tinyContent = editor.getContent();\n          this.cData.control.setValue(tinyContent);\n        });\n\n        editor.ui.registry.addButton('youTube', {\n          type: 'button',\n          icon: 'embed',\n          tooltip: 'Embed youtube video',\n          onAction: () => {\n            this.ytForm.reset(this.ytDefault);\n            this.dialog\n              .open(this.youTubeDialogTemplate, {width: '500px'})\n              .afterClosed()\n              .pipe(\n                filter(value => !!value),\n                take(1)\n              )\n              .subscribe(() => {\n                const data = this.ytForm.getRawValue();\n                let url = data.privacyEnhancedMode\n                  ? 'https://www.youtube-nocookie.com/embed/'\n                  : 'https://www.youtube.com/embed/';\n\n                url = url + data.value;\n\n                if (!data.showPlayerControls) {\n                  data.value += '?controls=0';\n                }\n\n                const iframe = `<iframe width=\"560\" height=\"315\" src=\"${url}\" frameborder=\"0\"\n                    allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>`;\n\n                editor.insertContent(\n                  data.fullWidth\n                    ? `<div class=\"evw-full\" style=\"text-align: ${data.align}\">${iframe}</div>`\n                    : `<div style=\"text-align: ${data.align}\">${iframe}</div>`\n                );\n              });\n          }\n        });\n      }\n    });\n  }\n}\n","import {ComponentType} from '../enums/component-type.enum';\nimport {AutocompleteComponent} from '../fields/autocomplete/autocomplete.component';\nimport {CheckboxComponent} from '../fields/checkbox/checkbox.component';\nimport {ChipsComponent} from '../fields/chips/chips.component';\nimport {DateFieldComponent} from '../fields/date-field/date-field.component';\nimport {DraggableListComponent} from '../fields/draggable-list/draggable-list.component';\nimport {FileComponent} from '../fields/file/file.component';\nimport {GalleryComponent} from '../fields/gallery/gallery.component';\nimport {ImageComponent} from '../fields/image/image.component';\nimport {InputComponent} from '../fields/input/input.component';\nimport {RadioComponent} from '../fields/radio/radio.component';\nimport {RangeComponent} from '../fields/range/range.component';\nimport {SelectComponent} from '../fields/select/select.component';\nimport {SliderComponent} from '../fields/slider/slider.component';\nimport {TextareaComponent} from '../fields/textarea/textarea.component';\nimport {ToggleComponent} from '../fields/toggle/toggle.component';\nimport {WysiwygComponent} from '../fields/wysiwyg/wysiwyg.component';\n\n\nexport const COMPONENT_TYPE_COMPONENT_MAP = {\n  [ComponentType.Input]: InputComponent,\n  [ComponentType.Toggle]: ToggleComponent,\n  [ComponentType.Select]: SelectComponent,\n  [ComponentType.File]: FileComponent,\n  [ComponentType.Image]: ImageComponent,\n  [ComponentType.Gallery]: GalleryComponent,\n  [ComponentType.Checkbox]: CheckboxComponent,\n  [ComponentType.Autocomplete]: AutocompleteComponent,\n  [ComponentType.Date]: DateFieldComponent,\n  [ComponentType.Range]: RangeComponent,\n  [ComponentType.Slider]: SliderComponent,\n  [ComponentType.Wysiwyg]: WysiwygComponent,\n  [ComponentType.Draggable]: DraggableListComponent,\n  [ComponentType.Radio]: RadioComponent,\n  [ComponentType.Chips]: ChipsComponent,\n  [ComponentType.Textarea]: TextareaComponent\n};\n","export enum SchemaType {\n  Object = 'object',\n  Array = 'array',\n\n  // Simple\n  String = 'string',\n  Number = 'number',\n  Integer = 'integer',\n  Boolean = 'boolean',\n  Null = 'null'\n}\n","import {AbstractControl} from '@angular/forms';\n\n// @dynamic\nexport class SchemaValidators {\n  static multipleOf(num: number) {\n    return (control: AbstractControl) => {\n      return control.value % num === 0 ? null : {multipleOf: num};\n    };\n  }\n}\n","import {ComponentType} from '../enums/component-type.enum';\nimport {SchemaType} from '../enums/schema-type.enum';\n\nexport function schemaToComponent(schemaType: SchemaType) {\n  switch (schemaType) {\n    case SchemaType.String:\n      return {\n        type: ComponentType.Input,\n        configuration: {\n          type: 'text'\n        }\n      };\n\n    case SchemaType.Number:\n    case SchemaType.Integer:\n      return {\n        type: ComponentType.Input,\n        configuration: {\n          type: 'number'\n        }\n      };\n\n    case SchemaType.Boolean:\n      return {\n        type: ComponentType.Checkbox\n      };\n\n    case SchemaType.Array:\n      return {\n        type: ComponentType.Chips\n      };\n  }\n}\n","import {moveItemInArray} from '@angular/cdk/drag-drop';\nimport {ComponentPortal} from '@angular/cdk/portal';\nimport {Injector} from '@angular/core';\nimport {FormArray, FormControl, FormGroup, Validators} from '@angular/forms';\nimport {COMPONENT_TYPE_COMPONENT_MAP} from '../consts/component-type-component-map.const';\nimport {SchemaType} from '../enums/schema-type.enum';\nimport {State} from '../enums/state.enum';\nimport {FieldComponent} from '../field/field.component';\nimport {CompiledField} from '../interfaces/compiled-field.interface';\nimport {Control} from '../interfaces/control.type';\nimport {Definitions} from '../interfaces/definitions.interface';\nimport {SchemaValidators} from '../validators/schema-validators.class';\nimport {createComponentInjector} from './create-component-injector';\nimport {CustomFields} from './custom-fields';\nimport {safeEval} from './safe-eval';\nimport {schemaToComponent} from './schema-to-component';\n\nexport interface PropertyDefinition {\n  type: SchemaType;\n  description?: string;\n  default?: any;\n}\n\nexport interface StringPropertyDefinition extends PropertyDefinition {\n  type: SchemaType.String;\n  default?: string;\n\n  pattern?: string;\n  minLength?: number;\n  maxLength?: number;\n}\n\nexport interface NumberPropertyDefinition extends PropertyDefinition {\n  type: SchemaType.Number | SchemaType.Integer;\n  default?: number;\n\n  minimum?: number;\n  maximum?: number;\n  exclusiveMinimum?: boolean;\n  exclusiveMaximum?: boolean;\n  multipleOf?: number;\n}\n\nexport interface BooleanPropertyDefinition extends PropertyDefinition {\n  type: SchemaType.Boolean;\n  default?: boolean;\n}\n\nexport interface ArrayPropertyDefinition extends PropertyDefinition {\n  type: SchemaType.Array;\n  items?: any;\n  contains?: any;\n}\n\nexport interface Pointer {\n  key: string;\n  type: SchemaType;\n  control: Control;\n  validation: any;\n\n  formatOnSave?: (item: any, dataSet?: any) => any;\n  formatOnLoad?: (item: any) => any;\n  formatOnCreate?: (item: any, dataSet?: any) => any;\n  formatOnEdit?: (item: any, dataSet?: any) => any;\n\n  /**\n   * Arrays can have these properties\n   */\n  arrayType?: SchemaType;\n  properties?: any;\n  required?: string[];\n  arrayPointers?: Pointers[];\n}\n\nexport interface Pointers {\n  [key: string]: Pointer;\n}\n\n// @dynamic\nexport class Parser {\n  constructor(\n    public schema: any,\n    public injector: Injector,\n    public state: State,\n    public role: string,\n    public definitions: Definitions = {},\n    public customFields: CustomFields = {}\n  ) {}\n\n  form: FormGroup;\n  pointers: Pointers = {};\n\n  static standardizeKey(key: string) {\n    if (key[0] === '/') {\n      key = key.slice(1, key.length);\n    }\n\n    return key;\n  }\n\n  static stringControl(\n    definition: StringPropertyDefinition,\n    required: boolean\n  ) {\n    const controlValidation: any[] = [];\n    const validation: any = {};\n\n    if (required) {\n      controlValidation.push(Validators.required);\n      validation.required = true;\n    }\n\n    if (definition.maxLength) {\n      controlValidation.push(Validators.maxLength(definition.maxLength));\n      validation.maxLength = definition.maxLength;\n    }\n\n    if (definition.minLength) {\n      controlValidation.push(Validators.minLength(definition.minLength));\n      validation.minLength = definition.minLength;\n    }\n\n    if (definition.pattern) {\n      controlValidation.push(Validators.pattern(definition.pattern));\n      validation.patter = definition.pattern;\n    }\n\n    return {\n      control: new FormControl(definition.default || '', controlValidation),\n      validation\n    };\n  }\n\n  static numberControl(\n    definition: NumberPropertyDefinition,\n    required: boolean\n  ) {\n    const validation: any = {};\n    const controlValidation: any[] = [];\n\n    if (required) {\n      controlValidation.push(Validators.required);\n      validation.required = true;\n    }\n\n    if (definition.minimum) {\n      const minimum =\n        definition.minimum + (definition.exclusiveMinimum ? 1 : 0);\n      controlValidation.push(Validators.min(minimum));\n      validation.minimum = minimum;\n    }\n\n    if (definition.maximum) {\n      const maximum =\n        definition.maximum - (definition.exclusiveMaximum ? 1 : 0);\n      controlValidation.push(Validators.max(maximum));\n      validation.maximum = maximum;\n    }\n\n    if (definition.multipleOf) {\n      controlValidation.push(\n        SchemaValidators.multipleOf(definition.multipleOf)\n      );\n      validation.multipleOf = definition.multipleOf;\n    }\n\n    return {\n      control: new FormControl(definition.default || null, controlValidation),\n      validation\n    };\n  }\n\n  static booleanControl(\n    definition: BooleanPropertyDefinition,\n    required: boolean\n  ) {\n    const controlValidation: any[] = [];\n    const validation: any = {};\n\n    if (required) {\n      controlValidation.push(Validators.required);\n      validation.required = true;\n    }\n\n    return {\n      control: new FormControl(definition.default || false, controlValidation),\n      validation\n    };\n  }\n\n  buildForm(\n    value?: any,\n    required: string[] = [],\n    base = '/',\n    addId = true\n  ) {\n    const properties = this.buildProperties(\n      this.schema.properties || {},\n      required,\n      base,\n      addId\n    );\n\n    this.form = properties.form;\n    this.pointers = properties.pointers;\n\n    if (value) {\n      this.form.patchValue(value);\n    }\n\n    return this.form;\n  }\n\n  buildProperties(\n    properties: object,\n    required: string[] = [],\n    base = '/',\n    addId = true\n  ) {\n    const {form, pointers} = [\n      ...Object.entries(properties),\n      /**\n       * Add the id field as a property so that\n       * it can be added to the form if needed\n       */\n      ...(addId\n        ? [\n            [\n              'id',\n              {\n                type: 'string'\n              }\n            ]\n          ]\n        : [])\n    ].reduce(\n      (group, [key, value]: [string, any]) => {\n        const isRequired = required.includes(key);\n\n        let parsed: {\n          control: any;\n          validation: any;\n          arrayType?: SchemaType;\n          properties?: any;\n          required?: string[];\n        };\n\n        switch (value.type) {\n          case SchemaType.String:\n            parsed = Parser.stringControl(value, isRequired);\n            break;\n\n          case SchemaType.Number:\n          case SchemaType.Integer:\n            parsed = Parser.numberControl(value, isRequired);\n            break;\n\n          case SchemaType.Boolean:\n            parsed = Parser.booleanControl(value, isRequired);\n            break;\n\n          case SchemaType.Object:\n            const objectProperties = this.buildProperties(\n              /**\n               * Supporting both {type: 'object', properties: {}} and\n               * {type: 'object', items: {properties: {}}}\n               */\n              value.properties || (value.items && value.items.properties ? value.items.properties : {}),\n              value.required || value.items && value.items.required ? value.items.required : [],\n              base + key + '/',\n              false\n            );\n\n            for (const added in objectProperties.pointers) {\n              if (objectProperties.pointers.hasOwnProperty(added)) {\n                // @ts-ignore\n                group.pointers[added] = objectProperties.pointers[added];\n              }\n            }\n\n            parsed = {\n              control: objectProperties.form,\n              validation: {}\n            };\n            break;\n\n          case SchemaType.Array:\n            parsed = this.buildArray(base, value);\n            break;\n        }\n\n        const pointerKey = base + key;\n        const definition = this.getFromDefinitions(pointerKey) || {};\n\n        // @ts-ignore\n        group.form[key] = parsed.control;\n        // @ts-ignore\n        group.pointers[pointerKey] = {\n          key,\n          type: value.type,\n          ...definition.formatOnLoad\n            && {formatOnLoad: safeEval(definition.formatOnLoad)},\n          ...definition.formatOnSave\n            && {formatOnSave: safeEval(definition.formatOnSave)},\n          ...definition.formatOnCreate\n            && {formatOnCreate: safeEval(definition.formatOnCreate)},\n          ...definition.formatOnEdit\n            && {formatOnEdit: safeEval(definition.formatOnEdit)},\n          // @ts-ignore\n          ...parsed\n        };\n\n        return group;\n      },\n      {\n        form: {},\n        pointers: {}\n      }\n    );\n\n    return {\n      pointers,\n      form: new FormGroup(form)\n    };\n  }\n\n  /**\n   * @param pointerKey Lookup key for the pointer\n   * @param pointer Entire pointer object that should be used\n   * @param definitions Entire definitions object that should be used\n   * @param single Defines if the field shown in the form or in the table\n   * @param arrayRoot If the field is in an array what root lookup to use\n   */\n  field(\n    pointerKey: string,\n    pointer: Pointer,\n    definitions: Definitions = {},\n    single = true,\n    arrayRoot?: string\n  ): CompiledField {\n\n    if (!pointer) {\n      console.log('Pointers: ', this.pointers);\n      throw new Error(`Couldn't find pointer for ${pointerKey}.`);\n    }\n\n    const {key, type, control, validation} = pointer;\n    const definition = {\n      label: key,\n      ...this.getFromDefinitions(pointerKey, definitions)\n    };\n\n    if (\n      (\n        definition.disableOn &&\n        (\n          Array.isArray(definition.disableOn) ?\n            definition.disableOn.includes(this.state)\n            : definition.disableOn === this.state\n        )\n      ) ||\n      (\n        definition.disableForRoles &&\n        (\n          Array.isArray(definition.disableForRoles) ?\n            definition.disableForRoles.includes(this.role)\n            : definition.disableForRoles === this.role\n        )\n      )\n    ) {\n      control.disable();\n    }\n\n    /**\n     * We don't show labels in the table\n     */\n    if (!single) {\n      definition.label = '';\n    }\n\n    if (!definition.component) {\n      definition.component = schemaToComponent(type);\n    }\n\n    // @ts-ignore\n    const component = COMPONENT_TYPE_COMPONENT_MAP[definition.component.type] || this.customFields[definition.component.type];\n\n    if (!component) {\n      // @ts-ignore\n      throw new Error(`Couldn't find a component defined for type: ${definition.component.type}`);\n    }\n\n    const portal = new ComponentPortal<FieldComponent<any>>(\n      component,\n      null,\n      createComponentInjector(this.injector, {\n        control,\n        validation,\n        single,\n        pointers: this.pointers,\n        form: this.form,\n        ...definition,\n        // @ts-ignore\n        ...(definition.component.configuration || {})\n      })\n    );\n\n    return {\n      pointer: pointerKey,\n      control,\n      portal,\n      validation,\n      placeholder: definition.placeholder || '',\n      label: definition.label,\n      onlyOn: definition.onlyOn\n    };\n  }\n\n  addArrayItem(\n    pointer: string,\n    loadHooks = false,\n    parentArray?: {\n      index: number,\n      pointer: string\n    }\n  ) {\n    const pointers = parentArray ? (this.pointers[parentArray.pointer] as any).arrayPointers[parentArray.index] : this.pointers;\n    const target = pointers[pointer];\n    const control = pointers[pointer].control as FormArray;\n\n    if (\n      target.arrayType === SchemaType.Array ||\n      target.arrayType === SchemaType.Object\n    ) {\n      const properties = this.buildProperties(\n        target.properties,\n        target.required,\n        pointer + '/',\n        false\n      );\n\n      if (loadHooks) {\n        this.loadHooks(properties.pointers);\n      }\n      // @ts-ignore\n      target.arrayPointers.unshift(properties.pointers);\n      control.controls.unshift(properties.form);\n\n      return properties.pointers;\n    } else {\n      const cont = new FormControl('');\n      control.controls.unshift(cont);\n      return cont;\n    }\n  }\n\n  moveArrayItem(\n    pointer: string,\n    fromIndex: number,\n    toIndex: number,\n    parentArray?: {\n      index: number,\n      pointer: string\n    }\n  ) {\n    const pointers = parentArray ? (this.pointers[parentArray.pointer] as any).arrayPointers[parentArray.index] : this.pointers;\n    const target = pointers[pointer];\n    const control = pointers[pointer].control as FormArray;\n\n    if (\n      target.arrayType === SchemaType.Array ||\n      target.arrayType === SchemaType.Object\n    ) {\n      moveItemInArray(\n        target.arrayPointers as any[],\n        fromIndex,\n        toIndex\n      );\n    }\n\n    moveItemInArray(\n      control.controls,\n      fromIndex,\n      toIndex\n    );\n  }\n\n  removeArrayItem(\n    pointer: string,\n    index: number,\n    parentArray?: {\n      index: number,\n      pointer: string\n    }\n  ) {\n    const pointers = parentArray ? (this.pointers[parentArray.pointer] as any).arrayPointers[parentArray.index] : this.pointers;\n    pointers[pointer].arrayPointers.splice(index, 1);\n    (pointers[pointer].control as FormArray).removeAt(index);\n  }\n\n  loadHooks(pointers = this.pointers) {\n    Object.values(pointers).forEach(entry => {\n      /**\n       * TODO:\n       * For the moment formatOn methods are\n       * only supported on FormControls.\n       * We might want to expand on this later on.\n       */\n      if (entry.control instanceof FormControl && entry.formatOnLoad) {\n        const adjustedValue = entry.formatOnLoad(entry.control.value);\n\n        if (adjustedValue !== entry.control.value) {\n          entry.control.setValue(adjustedValue);\n        }\n      }\n    });\n  }\n\n  preSaveHooks(\n    currentState: State,\n    statesToProcess = [State.Create, State.Edit],\n    pointers = this.pointers\n  ) {\n\n    const preSaveData = this.form.getRawValue();\n\n    Object.values(pointers).forEach(entry => {\n      /**\n       * TODO:\n       * For the moment formatOn methods are\n       * only supported on FormControls.\n       * We might want to expand on this later on.\n       */\n      if (entry.control instanceof FormControl) {\n        let value = entry.control.value;\n\n        if (entry.formatOnSave) {\n          value = entry.formatOnSave(value, preSaveData);\n        }\n\n        if (statesToProcess.includes(currentState)) {\n          if (currentState === State.Edit && entry.formatOnEdit) {\n            value = entry.formatOnEdit(value, preSaveData);\n          } else if (entry.formatOnCreate) {\n            value = entry.formatOnCreate(value, preSaveData);\n          }\n        }\n\n        if (value !== entry.control.value) {\n          entry.control.setValue(value);\n        }\n      }\n\n      if (entry.arrayPointers) {\n        entry.arrayPointers.forEach(arrayPointers =>\n          this.preSaveHooks(currentState, statesToProcess, arrayPointers)\n        );\n      }\n    });\n  }\n\n  getFromDefinitions(\n    key: string,\n    definitions: Definitions = this.definitions\n  ) {\n    return definitions[Parser.standardizeKey(key)];\n  }\n\n  /**\n   * TODO:\n   * - Handle contains case\n   * - Handle items or contains as array not object\n   */\n  private buildArray(base: string, definition: ArrayPropertyDefinition) {\n    if (!definition.items) {\n      return {\n        control: new FormControl([]),\n        ...(definition.items\n          ? {\n              arrayType: definition.items.type,\n              properties: definition.items.properties,\n              required: definition.items.required,\n              validation: {}\n            }\n          : {\n              arrayType: SchemaType.String,\n              validation: {}\n            })\n      };\n    } else {\n      return {\n        arrayType: definition.items.type,\n        properties: definition.items.properties,\n        required: definition.items.required,\n        validation: {},\n        control: new FormArray([]),\n        arrayPointers: []\n      };\n    }\n  }\n}\n","import {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  EventEmitter,\n  Inject,\n  Injector,\n  Input,\n  OnChanges,\n  OnDestroy,\n  Optional,\n  Output,\n  SimpleChanges\n} from '@angular/core';\nimport {FormGroup} from '@angular/forms';\nimport {forkJoin, of, Subscription} from 'rxjs';\nimport {SegmentType} from './enums/segment-type.enum';\nimport {State} from './enums/state.enum';\nimport {FormBuilderService} from './form-builder.service';\nimport {CompiledSegment} from './interfaces/compiled-segment.interface';\nimport {FormBuilderData} from './interfaces/form-builder-data.interface';\nimport {CUSTOM_FIELDS, CustomFields} from './utils/custom-fields';\nimport {filterAndCompileSegments} from './utils/filter-and-compile-segments';\nimport {Parser} from './utils/parser';\nimport {ROLE} from './utils/role';\n\n@Component({\n  selector: 'fb-form-builder',\n  templateUrl: './form-builder.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [FormBuilderService]\n})\nexport class FormBuilderComponent implements OnChanges, OnDestroy {\n  constructor(\n    private injector: Injector,\n    @Optional()\n    @Inject(ROLE)\n    private role: string,\n    @Optional()\n    @Inject(CUSTOM_FIELDS)\n    private customFields: CustomFields,\n    private cdr: ChangeDetectorRef,\n    private service: FormBuilderService\n  ) { }\n\n  @Input()\n  data: FormBuilderData;\n\n  @Input()\n  value: any;\n\n  @Input()\n  id: string;\n\n  @Output()\n  valueChanges = new EventEmitter<any>();\n\n  @Output()\n  validityChanges = new EventEmitter<boolean>();\n\n  form: FormGroup;\n  parser: Parser;\n  segments: CompiledSegment[];\n\n  @Input()\n  state: State = State.Create;\n\n  private changeSubscription: Subscription;\n  private statusSubscription: Subscription;\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.data) {\n      this.render();\n    }\n\n    if (changes.value && this.form) {\n      this.form.patchValue(changes.value.currentValue);\n    }\n  }\n\n  ngOnDestroy() {\n    if (this.changeSubscription) {\n      this.changeSubscription.unsubscribe();\n    }\n\n    if (this.statusSubscription) {\n      this.statusSubscription.unsubscribe();\n    }\n  }\n\n  process() {\n    this.parser.preSaveHooks(\n      this.state\n    );\n\n    return this.form.getRawValue();\n  }\n\n  save(\n    collectionId: string,\n    documentId: string\n  ) {\n\n    const toExec = this.service.saveComponents.map(comp =>\n      comp.save(collectionId, documentId)\n    );\n\n    return toExec.length ? forkJoin(toExec) : of({});\n  }\n\n  saveAndProcess(\n    collectionId: string,\n    documentId: string\n  ) {\n    this.process();\n\n    return this.save(\n      collectionId,\n      documentId\n    );\n  }\n\n  private render() {\n    const value = this.data.value || {};\n    const definitions = this.data.definitions || {};\n\n    this.parser = new Parser(\n      this.data.schema,\n      this.injector,\n      this.state,\n      this.role,\n      definitions,\n      this.customFields\n    );\n\n    this.form = this.parser.buildForm(\n      value,\n      [],\n      '/',\n      false\n    );\n\n    this.parser.loadHooks();\n\n    this.segments = filterAndCompileSegments(\n      this.data.segments ||\n      [{\n        title: '',\n        fields: Object.keys(this.parser.pointers),\n        columnsDesktop: 12,\n        type: SegmentType.Empty\n      }],\n      this.parser,\n      definitions,\n      this.injector,\n      value\n    );\n\n    if (this.changeSubscription) {\n      this.changeSubscription.unsubscribe();\n    }\n\n    if (this.statusSubscription) {\n      this.statusSubscription.unsubscribe();\n    }\n\n    this.changeSubscription = this.form.valueChanges\n      .subscribe(val => {\n        this.valueChanges.emit(val);\n      });\n\n    this.statusSubscription = this.form.statusChanges\n      .subscribe(val => {\n        this.validityChanges.emit(val === 'VALID');\n      });\n\n    this.cdr.markForCheck();\n  }\n}\n","import {Directive, ElementRef, EventEmitter, HostListener, Input, Output, Renderer2} from '@angular/core';\n\n@Directive({\n  selector: '[fbDropzone]'\n})\nexport class DropzoneDirective {\n  constructor(\n    private el: ElementRef,\n    private renderer: Renderer2\n  ) {}\n\n  @Input() hoverClass = 'active';\n  @Output() dropped = new EventEmitter<FileList>();\n  @Output() hovered = new EventEmitter<boolean>();\n\n  @HostListener('drop', ['$event'])\n  onDrop($event: any) {\n    $event.preventDefault();\n    this.dropped.emit($event.dataTransfer.files);\n    this.renderer.removeClass(this.el.nativeElement, this.hoverClass);\n    this.hovered.emit(false);\n  }\n\n  @HostListener('dragover', ['$event'])\n  onDragOver($event: Event) {\n    $event.preventDefault();\n    this.renderer.addClass(this.el.nativeElement, this.hoverClass);\n    this.hovered.emit(true);\n  }\n\n  @HostListener('dragleave', ['$event'])\n  onDragLeave($event: Event) {\n    $event.preventDefault();\n    this.renderer.removeClass(this.el.nativeElement, this.hoverClass);\n    this.hovered.emit(false);\n  }\n}\n","import {Pipe, PipeTransform} from '@angular/core';\nimport {CompiledField} from '../../interfaces/compiled-field.interface';\nimport {Parser} from '../../utils/parser';\n\n@Pipe({\n  name: 'showField'\n})\nexport class ShowFieldPipe implements PipeTransform {\n  transform(fields: CompiledField[], parser: Parser): CompiledField[] {\n    return fields.filter(\n      field =>\n        !field.onlyOn ||\n        (\n          Array.isArray(field.onlyOn) ?\n            field.onlyOn.includes(parser.state) :\n            field.onlyOn === parser.state\n        )\n    );\n  }\n}\n","import {DragDropModule} from '@angular/cdk/drag-drop';\nimport {PortalModule} from '@angular/cdk/portal';\nimport {CommonModule} from '@angular/common';\nimport {NgModule} from '@angular/core';\nimport {ReactiveFormsModule} from '@angular/forms';\nimport {MatAutocompleteModule} from '@angular/material/autocomplete';\nimport {MatButtonModule} from '@angular/material/button';\nimport {MatCardModule} from '@angular/material/card';\nimport {MatCheckboxModule} from '@angular/material/checkbox';\nimport {MatChipsModule} from '@angular/material/chips';\nimport {MatNativeDateModule} from '@angular/material/core';\nimport {MatDatepickerModule} from '@angular/material/datepicker';\nimport {MatDialogModule} from '@angular/material/dialog';\nimport {MatDividerModule} from '@angular/material/divider';\nimport {MatExpansionModule} from '@angular/material/expansion';\nimport {MatFormFieldModule} from '@angular/material/form-field';\nimport {MatIconModule} from '@angular/material/icon';\nimport {MatInputModule} from '@angular/material/input';\nimport {MatProgressSpinnerModule} from '@angular/material/progress-spinner';\nimport {MatRadioModule} from '@angular/material/radio';\nimport {MatSelectModule} from '@angular/material/select';\nimport {MatSlideToggleModule} from '@angular/material/slide-toggle';\nimport {MatSliderModule} from '@angular/material/slider';\nimport {MatTabsModule} from '@angular/material/tabs';\nimport {MatTooltipModule} from '@angular/material/tooltip';\nimport {SanitizeModule} from '@jaspero/ng-helpers';\nimport {TranslocoModule} from '@ngneat/transloco';\nimport {DropzoneDirective} from './directives/dropzone/dropzone.directive';\nimport {FieldComponent} from './field/field.component';\nimport {AutocompleteComponent} from './fields/autocomplete/autocomplete.component';\nimport {CheckboxComponent} from './fields/checkbox/checkbox.component';\nimport {ChipsComponent} from './fields/chips/chips.component';\nimport {DateFieldComponent} from './fields/date-field/date-field.component';\nimport {DraggableListComponent} from './fields/draggable-list/draggable-list.component';\nimport {FileComponent} from './fields/file/file.component';\nimport {GalleryComponent} from './fields/gallery/gallery.component';\nimport {ImageComponent} from './fields/image/image.component';\nimport {InputComponent} from './fields/input/input.component';\nimport {RadioComponent} from './fields/radio/radio.component';\nimport {RangeComponent} from './fields/range/range.component';\nimport {SelectComponent} from './fields/select/select.component';\nimport {SliderComponent} from './fields/slider/slider.component';\nimport {TextareaComponent} from './fields/textarea/textarea.component';\nimport {ToggleComponent} from './fields/toggle/toggle.component';\nimport {WysiwygComponent} from './fields/wysiwyg/wysiwyg.component';\nimport {FormBuilderComponent} from './form-builder.component';\nimport {ShowFieldPipe} from './pipes/show-field/show-field.pipe';\nimport {SegmentComponent} from './segment/segment.component';\nimport {AccordionComponent} from './segments/accordion/accordion.component';\nimport {CardComponent} from './segments/card/card.component';\nimport {EmptyComponent} from './segments/empty/empty.component';\nimport {StepperComponent} from './segments/stepper/stepper.component';\nimport {TabsComponent} from './segments/tabs/tabs.component';\n\n@NgModule({\n  declarations: [\n\n    /**\n     * Fields\n     */\n    FieldComponent,\n\n    AutocompleteComponent,\n    CheckboxComponent,\n    ChipsComponent,\n    DateFieldComponent,\n    RangeComponent,\n    DraggableListComponent,\n    FileComponent,\n    GalleryComponent,\n    ImageComponent,\n    InputComponent,\n    RadioComponent,\n    SelectComponent,\n    SliderComponent,\n    TextareaComponent,\n    ToggleComponent,\n    WysiwygComponent,\n\n    /**\n     * Segments\n     */\n    SegmentComponent,\n\n    AccordionComponent,\n    CardComponent,\n    EmptyComponent,\n    StepperComponent,\n    TabsComponent,\n\n    /**\n     * Directives\n     */\n    DropzoneDirective,\n\n    /**\n     * Pipes\n     */\n    ShowFieldPipe,\n\n    FormBuilderComponent\n  ],\n  imports: [\n    CommonModule,\n    ReactiveFormsModule,\n\n    /**\n     * Material\n     */\n    MatFormFieldModule,\n    MatInputModule,\n    MatButtonModule,\n    MatAutocompleteModule,\n    MatSelectModule,\n    MatSliderModule,\n    MatSlideToggleModule,\n    MatCheckboxModule,\n    MatChipsModule,\n    MatIconModule,\n    MatDatepickerModule,\n    MatNativeDateModule,\n    DragDropModule,\n    MatDialogModule,\n    MatTooltipModule,\n    MatProgressSpinnerModule,\n    MatExpansionModule,\n    MatDividerModule,\n    PortalModule,\n    MatCardModule,\n    MatTabsModule,\n    MatRadioModule,\n\n    /**\n     * Jp Helpers\n     */\n    SanitizeModule,\n\n    /**\n     * Other\n     */\n    TranslocoModule\n  ],\n  exports: [FormBuilderComponent]\n})\nexport class FormBuilderModule {\n}\n","/**\n * Public API Surface of form-builder\n */\nexport * from './lib/form-builder.component';\nexport * from './lib/form-builder.module';\nexport * from './lib/form-builder.service';\nexport * from './lib/field/field.component';\n\nexport * from './lib/services/db.service';\nexport * from './lib/services/storage.service';\n\nexport * from './lib/utils/parser';\nexport * from './lib/utils/parse-template';\nexport * from './lib/utils/safe-eval';\nexport * from './lib/utils/format-generated-images';\nexport * from './lib/utils/format-file-name';\nexport * from './lib/utils/clone-abstract-control';\nexport * from './lib/utils/switch-item-locations';\n\n/**\n * Interfaces\n */\nexport * from './lib/interfaces/definitions.interface';\nexport * from './lib/interfaces/definitions.interface';\nexport * from './lib/interfaces/option.interface';\nexport * from './lib/interfaces/segment.interface';\nexport * from './lib/interfaces/field-data.interface';\nexport * from './lib/interfaces/form-builder-data.interface';\n\n/**\n * Enums\n */\nexport * from './lib/enums/component-type.enum';\nexport * from './lib/enums/schema-type.enum';\nexport * from './lib/enums/segment-type.enum';\nexport * from './lib/enums/state.enum';\n\n/**\n * Injectors\n */\nexport * from './lib/utils/role';\nexport * from './lib/utils/additional-context';\nexport * from './lib/utils/storage-url';\nexport * from './lib/utils/custom-fields';\nexport {COMPONENT_DATA} from './lib/utils/create-component-injector';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {DropzoneDirective as ɵx} from './lib/directives/dropzone/dropzone.directive';\nexport {AutocompleteComponent as ɵa} from './lib/fields/autocomplete/autocomplete.component';\nexport {CheckboxComponent as ɵb} from './lib/fields/checkbox/checkbox.component';\nexport {ChipsComponent as ɵc} from './lib/fields/chips/chips.component';\nexport {DateFieldComponent as ɵd} from './lib/fields/date-field/date-field.component';\nexport {DraggableListComponent as ɵf} from './lib/fields/draggable-list/draggable-list.component';\nexport {FileComponent as ɵg} from './lib/fields/file/file.component';\nexport {GalleryComponent as ɵh} from './lib/fields/gallery/gallery.component';\nexport {ImageComponent as ɵi} from './lib/fields/image/image.component';\nexport {InputComponent as ɵj} from './lib/fields/input/input.component';\nexport {RadioComponent as ɵk} from './lib/fields/radio/radio.component';\nexport {RangeComponent as ɵe} from './lib/fields/range/range.component';\nexport {SelectComponent as ɵl} from './lib/fields/select/select.component';\nexport {SliderComponent as ɵm} from './lib/fields/slider/slider.component';\nexport {TextareaComponent as ɵn} from './lib/fields/textarea/textarea.component';\nexport {ToggleComponent as ɵo} from './lib/fields/toggle/toggle.component';\nexport {WysiwygComponent as ɵp} from './lib/fields/wysiwyg/wysiwyg.component';\nexport {ShowFieldPipe as ɵy} from './lib/pipes/show-field/show-field.pipe';\nexport {SegmentComponent as ɵq} from './lib/segment/segment.component';\nexport {AccordionComponent as ɵs} from './lib/segments/accordion/accordion.component';\nexport {CardComponent as ɵt} from './lib/segments/card/card.component';\nexport {EmptyComponent as ɵu} from './lib/segments/empty/empty.component';\nexport {StepperComponent as ɵv} from './lib/segments/stepper/stepper.component';\nexport {TabsComponent as ɵw} from './lib/segments/tabs/tabs.component';\nexport {SEGMENT_DATA as ɵr} from './lib/utils/create-segment-injector';"],"names":["SegmentType","State","tap","catchError","throwError","Injectable","TranslocoService","MatSnackBar","InjectionToken","PortalInjector","get","moveItemInArray","Component","Inject","Injector","HostBinding","ChangeDetectionStrategy","ComponentPortal","ComponentType","of","map","BehaviorSubject","switchMap","startWith","FormGroup","FormArray","FormControl","Validators","DatePipe","ChangeDetectorRef","from","ViewChild","Observable","forkJoin","Optional","MatDialog","HttpClient","ViewportRuler","CdkDropListGroup","CdkDropList","DomSanitizer","filter","take","FormBuilder","_a","SchemaType","portal","EventEmitter","Input","Output","Directive","ElementRef","Renderer2","HostListener","Pipe","NgModule","CommonModule","ReactiveFormsModule","MatFormFieldModule","MatInputModule","MatButtonModule","MatAutocompleteModule","MatSelectModule","MatSliderModule","MatSlideToggleModule","MatCheckboxModule","MatChipsModule","MatIconModule","MatDatepickerModule","MatNativeDateModule","DragDropModule","MatDialogModule","MatTooltipModule","MatProgressSpinnerModule","MatExpansionModule","MatDividerModule","PortalModule","MatCardModule","MatTabsModule","MatRadioModule","SanitizeModule","TranslocoModule"],"mappings":";;;;;;IAAA,WAAY,WAAW;QACrB,8BAAe,CAAA;QACf,4BAAa,CAAA;QACb,sCAAuB,CAAA;QACvB,4BAAa,CAAA;QACb,kCAAmB,CAAA;IACrB,CAAC,EANWA,mBAAW,KAAXA,mBAAW;;ICAvB,WAAY,KAAK;QACf,0BAAiB,CAAA;QACjB,sBAAa,CAAA;IACf,CAAC,EAHWC,aAAK,KAALA,aAAK;;;QCQf,4BACU,SAA2B,EAC3B,QAAqB;YADrB,cAAS,GAAT,SAAS,CAAkB;YAC3B,aAAQ,GAAR,QAAQ,CAAa;;;;;YAQ/B,mBAAc,GAAU,EAAE,CAAC;SAN1B;QAQD,mCAAM,GAAN,UACE,OAGM;YAJR,iBA0CC;YAzCC,wBAAA,EAAA,YAGM;YAEN,IAAM,YAAY,mBAChB,OAAO,EAAE,6BAA6B,EACtC,KAAK,EAAE,0BAA0B,IAC9B,OAAO,CACX,CAAC;YAEF,OAAO,UAAI,OAAsB;gBAC/B,OAAO,OAAO,CAAC,IAAI,CACjBC,aAAG,CAAC;oBACF,IAAI,YAAY,CAAC,OAAO,EAAE;wBACxB,KAAI,CAAC,QAAQ,CAAC,IAAI,CAChB,KAAI,CAAC,SAAS,CAAC,SAAS,CAAC,YAAY,CAAC,OAAO,CAAC,EAC9C,KAAI,CAAC,SAAS,CAAC,SAAS,CAAC,iBAAiB,CAAC,EAC3C;4BACE,QAAQ,EAAE,IAAI;yBACf,CACF,CAAC;qBACH;iBACF,CAAC,EACFC,oBAAU,CAAC,UAAA,GAAG;oBACZ,IAAI,YAAY,CAAC,KAAK,EAAE;wBACtB,KAAI,CAAC,QAAQ,CAAC,IAAI,CAChB,KAAI,CAAC,SAAS,CAAC,SAAS,CAAC,YAAY,CAAC,KAAK,CAAC,EAC5C,KAAI,CAAC,SAAS,CAAC,SAAS,CAAC,iBAAiB,CAAC,EAC3C;4BACE,UAAU,EAAE,iBAAiB;4BAC7B,QAAQ,EAAE,IAAI;yBACf,CACF,CAAC;qBACH;oBAED,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;oBACnB,OAAOC,eAAU,CAAC,GAAG,CAAC,CAAC;iBACxB,CAAC,CACH,CAAC;aACH,CAAC;SACH;;;;gBAxDFC,eAAU;;;gBAJHC,0BAAgB;gBADhBC,oBAAW;;;QCKN,aAAa,GAAG,IAAIC,mBAAc,CAAK,eAAe;;ICNnE;;;;;;;;;;;;;;IAcA;IAEA,IAAI,aAAa,GAAG,UAAS,CAAC,EAAE,CAAC;QAC7B,aAAa,GAAG,MAAM,CAAC,cAAc;aAChC,EAAE,SAAS,EAAE,EAAE,EAAE,YAAY,KAAK,IAAI,UAAU,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,EAAE,CAAC;YAC5E,UAAU,CAAC,EAAE,CAAC,IAAI,KAAK,IAAI,CAAC,IAAI,CAAC;gBAAE,IAAI,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC;oBAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;QAC/E,OAAO,aAAa,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAC/B,CAAC,CAAC;aAEc,SAAS,CAAC,CAAC,EAAE,CAAC;QAC1B,aAAa,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QACpB,SAAS,EAAE,KAAK,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC,EAAE;QACvC,CAAC,CAAC,SAAS,GAAG,CAAC,KAAK,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,SAAS,GAAG,CAAC,CAAC,SAAS,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC;IACzF,CAAC;IAEM,IAAI,QAAQ,GAAG;QAClB,QAAQ,GAAG,MAAM,CAAC,MAAM,IAAI,SAAS,QAAQ,CAAC,CAAC;YAC3C,KAAK,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;gBACjD,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;gBACjB,KAAK,IAAI,CAAC,IAAI,CAAC;oBAAE,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;wBAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;aAChF;YACD,OAAO,CAAC,CAAC;SACZ,CAAA;QACD,OAAO,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;IAC3C,CAAC,CAAA;aAEe,MAAM,CAAC,CAAC,EAAE,CAAC;QACvB,IAAI,CAAC,GAAG,EAAE,CAAC;QACX,KAAK,IAAI,CAAC,IAAI,CAAC;YAAE,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC;gBAC/E,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAChB,IAAI,CAAC,IAAI,IAAI,IAAI,OAAO,MAAM,CAAC,qBAAqB,KAAK,UAAU;YAC/D,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,qBAAqB,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACpE,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,MAAM,CAAC,SAAS,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;oBAC1E,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;aACzB;QACL,OAAO,CAAC,CAAC;IACb,CAAC;aAEe,UAAU,CAAC,UAAU,EAAE,MAAM,EAAE,GAAG,EAAE,IAAI;QACpD,IAAI,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,MAAM,GAAG,IAAI,KAAK,IAAI,GAAG,IAAI,GAAG,MAAM,CAAC,wBAAwB,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,IAAI,EAAE,CAAC,CAAC;QAC7H,IAAI,OAAO,OAAO,KAAK,QAAQ,IAAI,OAAO,OAAO,CAAC,QAAQ,KAAK,UAAU;YAAE,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,UAAU,EAAE,MAAM,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;;YAC1H,KAAK,IAAI,CAAC,GAAG,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE;gBAAE,IAAI,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC;oBAAE,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC;QAClJ,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;IAClE,CAAC;aAEe,OAAO,CAAC,UAAU,EAAE,SAAS;QACzC,OAAO,UAAU,MAAM,EAAE,GAAG,IAAI,SAAS,CAAC,MAAM,EAAE,GAAG,EAAE,UAAU,CAAC,CAAC,EAAE,CAAA;IACzE,CAAC;aAEe,UAAU,CAAC,WAAW,EAAE,aAAa;QACjD,IAAI,OAAO,OAAO,KAAK,QAAQ,IAAI,OAAO,OAAO,CAAC,QAAQ,KAAK,UAAU;YAAE,OAAO,OAAO,CAAC,QAAQ,CAAC,WAAW,EAAE,aAAa,CAAC,CAAC;IACnI,CAAC;aAEe,SAAS,CAAC,OAAO,EAAE,UAAU,EAAE,CAAC,EAAE,SAAS;QACvD,SAAS,KAAK,CAAC,KAAK,IAAI,OAAO,KAAK,YAAY,CAAC,GAAG,KAAK,GAAG,IAAI,CAAC,CAAC,UAAU,OAAO,IAAI,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;QAC5G,OAAO,KAAK,CAAC,KAAK,CAAC,GAAG,OAAO,CAAC,EAAE,UAAU,OAAO,EAAE,MAAM;YACrD,SAAS,SAAS,CAAC,KAAK,IAAI,IAAI;gBAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;aAAE;YAAC,OAAO,CAAC,EAAE;gBAAE,MAAM,CAAC,CAAC,CAAC,CAAC;aAAE,EAAE;YAC3F,SAAS,QAAQ,CAAC,KAAK,IAAI,IAAI;gBAAE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;aAAE;YAAC,OAAO,CAAC,EAAE;gBAAE,MAAM,CAAC,CAAC,CAAC,CAAC;aAAE,EAAE;YAC9F,SAAS,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC,EAAE;YAC9G,IAAI,CAAC,CAAC,SAAS,GAAG,SAAS,CAAC,KAAK,CAAC,OAAO,EAAE,UAAU,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC;SACzE,CAAC,CAAC;IACP,CAAC;aAEe,WAAW,CAAC,OAAO,EAAE,IAAI;QACrC,IAAI,CAAC,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,cAAa,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;gBAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACjH,OAAO,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,OAAO,MAAM,KAAK,UAAU,KAAK,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,cAAa,OAAO,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACzJ,SAAS,IAAI,CAAC,CAAC,IAAI,OAAO,UAAU,CAAC,IAAI,OAAO,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE;QAClE,SAAS,IAAI,CAAC,EAAE;YACZ,IAAI,CAAC;gBAAE,MAAM,IAAI,SAAS,CAAC,iCAAiC,CAAC,CAAC;YAC9D,OAAO,CAAC;gBAAE,IAAI;oBACV,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI;wBAAE,OAAO,CAAC,CAAC;oBAC7J,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC;wBAAE,EAAE,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC;oBACxC,QAAQ,EAAE,CAAC,CAAC,CAAC;wBACT,KAAK,CAAC,CAAC;wBAAC,KAAK,CAAC;4BAAE,CAAC,GAAG,EAAE,CAAC;4BAAC,MAAM;wBAC9B,KAAK,CAAC;4BAAE,CAAC,CAAC,KAAK,EAAE,CAAC;4BAAC,OAAO,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC;wBACxD,KAAK,CAAC;4BAAE,CAAC,CAAC,KAAK,EAAE,CAAC;4BAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;4BAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;4BAAC,SAAS;wBACjD,KAAK,CAAC;4BAAE,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC;4BAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;4BAAC,SAAS;wBACjD;4BACI,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE;gCAAE,CAAC,GAAG,CAAC,CAAC;gCAAC,SAAS;6BAAE;4BAC5G,IAAI,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;gCAAE,CAAC,CAAC,KAAK,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;gCAAC,MAAM;6BAAE;4BACtF,IAAI,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE;gCAAE,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;gCAAC,CAAC,GAAG,EAAE,CAAC;gCAAC,MAAM;6BAAE;4BACrE,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE;gCAAE,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;gCAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gCAAC,MAAM;6BAAE;4BACnE,IAAI,CAAC,CAAC,CAAC,CAAC;gCAAE,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC;4BACtB,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;4BAAC,SAAS;qBAC9B;oBACD,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;iBAC9B;gBAAC,OAAO,CAAC,EAAE;oBAAE,EAAE,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;oBAAC,CAAC,GAAG,CAAC,CAAC;iBAAE;wBAAS;oBAAE,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;iBAAE;YAC1D,IAAI,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC;gBAAE,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;YAAC,OAAO,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;SACpF;IACL,CAAC;IAEM,IAAI,eAAe,GAAG,MAAM,CAAC,MAAM,IAAI,UAAS,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE;QAC9D,IAAI,EAAE,KAAK,SAAS;YAAE,EAAE,GAAG,CAAC,CAAC;QAC7B,MAAM,CAAC,cAAc,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,UAAU,EAAE,IAAI,EAAE,GAAG,EAAE,cAAa,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;IACzF,CAAC,KAAK,UAAS,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE;QACtB,IAAI,EAAE,KAAK,SAAS;YAAE,EAAE,GAAG,CAAC,CAAC;QAC7B,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IACjB,CAAC,CAAC,CAAC;aAEa,YAAY,CAAC,CAAC,EAAE,OAAO;QACnC,KAAK,IAAI,CAAC,IAAI,CAAC;YAAE,IAAI,CAAC,KAAK,SAAS,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC;gBAAE,eAAe,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IACvG,CAAC;aAEe,QAAQ,CAAC,CAAC;QACtB,IAAI,CAAC,GAAG,OAAO,MAAM,KAAK,UAAU,IAAI,MAAM,CAAC,QAAQ,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;QAC9E,IAAI,CAAC;YAAE,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACxB,IAAI,CAAC,IAAI,OAAO,CAAC,CAAC,MAAM,KAAK,QAAQ;YAAE,OAAO;gBAC1C,IAAI,EAAE;oBACF,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM;wBAAE,CAAC,GAAG,KAAK,CAAC,CAAC;oBACnC,OAAO,EAAE,KAAK,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC;iBAC3C;aACJ,CAAC;QACF,MAAM,IAAI,SAAS,CAAC,CAAC,GAAG,yBAAyB,GAAG,iCAAiC,CAAC,CAAC;IAC3F,CAAC;aAEe,MAAM,CAAC,CAAC,EAAE,CAAC;QACvB,IAAI,CAAC,GAAG,OAAO,MAAM,KAAK,UAAU,IAAI,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QAC3D,IAAI,CAAC,CAAC;YAAE,OAAO,CAAC,CAAC;QACjB,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;QACjC,IAAI;YACA,OAAO,CAAC,CAAC,KAAK,KAAK,CAAC,IAAI,CAAC,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,IAAI;gBAAE,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;SAC9E;QACD,OAAO,KAAK,EAAE;YAAE,CAAC,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;SAAE;gBAC/B;YACJ,IAAI;gBACA,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC;oBAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;aACpD;oBACO;gBAAE,IAAI,CAAC;oBAAE,MAAM,CAAC,CAAC,KAAK,CAAC;aAAE;SACpC;QACD,OAAO,EAAE,CAAC;IACd,CAAC;aAEe,QAAQ;QACpB,KAAK,IAAI,EAAE,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE;YAC9C,EAAE,GAAG,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACzC,OAAO,EAAE,CAAC;IACd,CAAC;aAEe,cAAc;QAC1B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE;YAAE,CAAC,IAAI,SAAS,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC;QACpF,KAAK,IAAI,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE;YAC5C,KAAK,IAAI,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE;gBAC7D,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QACpB,OAAO,CAAC,CAAC;IACb,CAAC;IAAA,CAAC;aAEc,OAAO,CAAC,CAAC;QACrB,OAAO,IAAI,YAAY,OAAO,IAAI,IAAI,CAAC,CAAC,GAAG,CAAC,EAAE,IAAI,IAAI,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC;IACzE,CAAC;aAEe,gBAAgB,CAAC,OAAO,EAAE,UAAU,EAAE,SAAS;QAC3D,IAAI,CAAC,MAAM,CAAC,aAAa;YAAE,MAAM,IAAI,SAAS,CAAC,sCAAsC,CAAC,CAAC;QACvF,IAAI,CAAC,GAAG,SAAS,CAAC,KAAK,CAAC,OAAO,EAAE,UAAU,IAAI,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC;QAC9D,OAAO,CAAC,GAAG,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,OAAO,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,aAAa,CAAC,GAAG,cAAc,OAAO,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC;QACtH,SAAS,IAAI,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC;YAAE,CAAC,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,IAAI,OAAO,IAAI,OAAO,CAAC,UAAU,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE;QAC1I,SAAS,MAAM,CAAC,CAAC,EAAE,CAAC,IAAI,IAAI;YAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;SAAE;QAAC,OAAO,CAAC,EAAE;YAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;SAAE,EAAE;QAClF,SAAS,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,KAAK,YAAY,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE;QACxH,SAAS,OAAO,CAAC,KAAK,IAAI,MAAM,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,EAAE;QAClD,SAAS,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC,EAAE;QAClD,SAAS,MAAM,CAAC,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,MAAM;YAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACtF,CAAC;aAEe,gBAAgB,CAAC,CAAC;QAC9B,IAAI,CAAC,EAAE,CAAC,CAAC;QACT,OAAO,CAAC,GAAG,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,OAAO,EAAE,UAAU,CAAC,IAAI,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,cAAc,OAAO,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC;QAC5I,SAAS,IAAI,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,IAAI,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,KAAK,QAAQ,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE;IACnJ,CAAC;aAEe,aAAa,CAAC,CAAC;QAC3B,IAAI,CAAC,MAAM,CAAC,aAAa;YAAE,MAAM,IAAI,SAAS,CAAC,sCAAsC,CAAC,CAAC;QACvF,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;QACnC,OAAO,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,OAAO,QAAQ,KAAK,UAAU,GAAG,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,EAAE,CAAC,GAAG,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,OAAO,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,aAAa,CAAC,GAAG,cAAc,OAAO,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;QACjN,SAAS,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,UAAU,CAAC,IAAI,OAAO,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,OAAO,EAAE,MAAM,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE;QAChK,SAAS,MAAM,CAAC,OAAO,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,UAAS,CAAC,IAAI,OAAO,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,EAAE;IAChI,CAAC;aAEe,oBAAoB,CAAC,MAAM,EAAE,GAAG;QAC5C,IAAI,MAAM,CAAC,cAAc,EAAE;YAAE,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC,CAAC;SAAE;aAAM;YAAE,MAAM,CAAC,GAAG,GAAG,GAAG,CAAC;SAAE;QAC/G,OAAO,MAAM,CAAC;IAClB,CAAC;IAAA,CAAC;IAEF,IAAI,kBAAkB,GAAG,MAAM,CAAC,MAAM,IAAI,UAAS,CAAC,EAAE,CAAC;QACnD,MAAM,CAAC,cAAc,CAAC,CAAC,EAAE,SAAS,EAAE,EAAE,UAAU,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;IACxE,CAAC,IAAI,UAAS,CAAC,EAAE,CAAC;QACd,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;IACrB,CAAC,CAAC;aAEc,YAAY,CAAC,GAAG;QAC5B,IAAI,GAAG,IAAI,GAAG,CAAC,UAAU;YAAE,OAAO,GAAG,CAAC;QACtC,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,IAAI,GAAG,IAAI,IAAI;YAAE,KAAK,IAAI,CAAC,IAAI,GAAG;gBAAE,IAAI,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;oBAAE,eAAe,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC;QAC5G,kBAAkB,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;QAChC,OAAO,MAAM,CAAC;IAClB,CAAC;aAEe,eAAe,CAAC,GAAG;QAC/B,OAAO,CAAC,GAAG,IAAI,GAAG,CAAC,UAAU,IAAI,GAAG,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,CAAC;IAC5D,CAAC;aAEe,sBAAsB,CAAC,QAAQ,EAAE,UAAU;QACvD,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE;YAC3B,MAAM,IAAI,SAAS,CAAC,gDAAgD,CAAC,CAAC;SACzE;QACD,OAAO,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IACpC,CAAC;aAEe,sBAAsB,CAAC,QAAQ,EAAE,UAAU,EAAE,KAAK;QAC9D,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE;YAC3B,MAAM,IAAI,SAAS,CAAC,gDAAgD,CAAC,CAAC;SACzE;QACD,UAAU,CAAC,GAAG,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;QAChC,OAAO,KAAK,CAAC;IACjB;;QC/Na,YAAY,GAAG,IAAIA,mBAAc,CAAK,cAAc,EAAE;aAEnD,qBAAqB,CAAC,QAAQ,EAAE,UAAU;QACxD,IAAM,cAAc,GAAG,IAAI,OAAO,EAAE,CAAC;QACrC,cAAc,CAAC,GAAG,CAAC,YAAY,EAAE,UAAU,CAAC,CAAC;QAC7C,OAAO,IAAIC,qBAAc,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;IACtD;;;QCcE,0BAC+B,KAAkB,EACxC,QAAkB;YADI,UAAK,GAAL,KAAK,CAAa;YACxC,aAAQ,GAAR,QAAQ,CAAU;YAM3B,wBAAmB,GAA6B,EAAE,CAAC;YACnD,gBAAW,GAA2B,EAAE,CAAC;SANrC;QAcJ,mCAAQ,GAAR;YAAA,iBA0CC;YAzCC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YAClC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YACpD,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC;YAC3C,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,IAAI,EAAE,CAAC;;;;YAKtC,IAAI,CAAC,cAAc,GAAG,wBAAwB,CAC5C,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,cAAc,IAAI,EAAE,EACvC,IAAI,CAAC,KAAK,CAAC,MAAM,EACjB,IAAI,CAAC,KAAK,CAAC,WAAW,EACtB,IAAI,CAAC,QAAQ,EACb,IAAI,CAAC,OAAO,CAAC,UAAU,CACxB,CAAC;YAEF,IAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,KAAe,CAAC;;;;YAK3C,IAAI,KAAK,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE;gBACpC,IAAI,MAAM,SAAA,CAAC;gBAEX,IAAI;oBACF,MAAM,GAAGC,eAAG,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;iBAC9C;gBAAC,OAAO,CAAC,EAAE,GAAE;gBAEd,IAAI,MAAM,EAAE;oBACV,MAAM,CAAC,OAAO,CAAC,cAAM,OAAA,KAAI,CAAC,YAAY,CAAC,KAAK,CAAC,GAAA,CAAC,CAAC;oBAE9C,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,OAAuB,CAAC,UAAU,CACtD,MAAM,CACP,CAAC;oBAEF,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;;wBAEtC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC;qBACpE;iBACF;aACF;SACF;QAED,uCAAY,GAAZ,UAAa,QAAe;YAA5B,iBAmDC;YAnDY,yBAAA,EAAA,eAAe;YAC1B,IAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,KAAe,CAAC;YAC3C,IAAM,QAAQ,GAAQ,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,YAAY,CAClD,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,EAAE,IAAI,KAAK,EACjC,QAAQ,EACR,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG;gBAClB,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM;gBAC1B,KAAK,EAAE,CAAC;aACT,GAAG,SAAS,CACd,CAAC;YAEF,IAAI,MAAuB,CAAC;YAE5B,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,EAAE;gBACrD,MAAM,GAAI,IAAI,CAAC,OAAO,CAAC,MAAmB,CAAC,GAAG,CAAC,UAAA,GAAG;oBAEhD,GAAG,GAAG,CAAC,KAAI,CAAC,KAAK,CAAC,MAAM,IAAI,EAAE,IAAI,GAAG,CAAC;oBAEtC,OAAO,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAC5B,GAAG,EACH,QAAQ,CAAC,GAAG,CAAC,EACb,KAAI,CAAC,KAAK,CAAC,WAAW,EACtB,IAAI,EACJ,KAAK,CACN,CAAC;iBACH,CAAC,CAAC;aACJ;iBAAM;gBACL,MAAM,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAC/B,KAAK,kCAEA,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,KACvB,OAAO,EAAE,QAAQ,KAEnB,IAAI,CAAC,KAAK,CAAC,WAAW,CACvB,CAAC,CAAC;aACJ;YAED,IAAI,CAAC,WAAW,CAAC,OAAO,CACtB,MAAM,CACP,CAAC;YAEF,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAC9B,IAAI,CAAC,cAAc,GAAG,wBAAwB,CAC5C,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,cAAc,IAAI,EAAE,EACvC,IAAI,CAAC,KAAK,CAAC,MAAM,EACjB,IAAI,CAAC,KAAK,CAAC,WAAW,EACtB,IAAI,CAAC,QAAQ,EACb,IAAI,CAAC,OAAO,CAAC,UAAU,EACvB,IAAI,CAAC,OAAO,CAAC,KAAK,CACnB,CACF,CAAC;SACH;QAED,oCAAS,GAAT,UAAU,EAAW,EAAE,SAAiB;YACtC,IAAI,OAAe,CAAC;YAEpB,IAAI,EAAE,EAAE;gBACN,OAAO,GAAG,SAAS,KAAK,CAAC,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,GAAG,SAAS,GAAG,CAAC,CAAC;aACzE;iBAAM;gBACL,OAAO,GAAG,SAAS,MAAM,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,SAAS,GAAG,CAAC,CAAC;aAC3E;YAEDC,wBAAe,CACb,IAAI,CAAC,WAAW,EAChB,SAAS,EACT,OAAO,CACR,CAAC;YAEFA,wBAAe,CACb,IAAI,CAAC,mBAAmB,EACxB,SAAS,EACT,OAAO,CACR,CAAC;YAEF,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,aAAa,CAC7B,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,EAAE,IAAI,IAAI,CAAC,OAAO,CAAC,KAAe,EACxD,SAAS,EACT,OAAO,EACP,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG;gBAClB,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM;gBAC1B,KAAK,EAAE,CAAC;aACT,GAAG,SAAS,CACd,CAAC;SACH;QAED,0CAAe,GAAf,UAAgB,KAAa;YAC3B,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,eAAe,CAC/B,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,EAAE,IAAI,IAAI,CAAC,OAAO,CAAC,KAAe,EACxD,KAAK,EACL,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG;gBAClB,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM;gBAC1B,KAAK,EAAE,CAAC;aACT,GAAG,SAAS,CACd,CAAC;YACF,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YAC1C,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;SACnC;;;;gBAlKFC,cAAS,SAAC;oBACT,QAAQ,EAAE,YAAY;oBACtB,QAAQ,EAAE,EAAE;iBACb;;;gDAGIC,WAAM,SAAC,YAAY;gBAvBgBC,aAAQ;;;0BAiC7CC,gBAAW,SAAC,OAAO;qBAGnBA,gBAAW,SAAC,IAAI;;;;QCRqB,sCAAgB;QAAxD;;;QAIE,qCAAQ,GAAR;YAAA,iBAsBC;YArBC,iBAAM,QAAQ,WAAE,CAAC;YAEjB,IAAI,CAAC,UAAU,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,aAAa,IAAI,EAAE,EAAE,GAAG,CAC5D,UAAC,MAAqB,IAAK,QAAC;gBAC1B,KAAK,EAAE,MAAM,CAAC,KAAK;gBACnB,MAAM,EAAE,CAAC,MAAM,CAAC,MAAM,IAAI,EAAE,EAAE,GAAG,CAAC,UAAA,GAAG,IACnC,OAAA,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CACrB,GAAG,EACH,KAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAClB,KAAI,CAAC,KAAK,CAAC,WAAW,CACvB,GAAA,CACF;gBACD,cAAc,EAAE,wBAAwB,CACtC,MAAM,CAAC,cAAc,IAAI,EAAE,EAC3B,KAAI,CAAC,KAAK,CAAC,MAAM,EACjB,KAAI,CAAC,KAAK,CAAC,WAAW,EACtB,KAAI,CAAC,QAAQ,EACb,KAAI,CAAC,OAAO,CAAC,UAAU,CACxB;aACF,IAAC,CACH,CAAC;SACH;;KA1BH,CAAwC,gBAAgB;;gBANvDH,cAAS,SAAC;oBACT,QAAQ,EAAE,cAAc;oBACxB,0lCAAyC;oBAEzC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;;QClBkC,iCAAgB;QAAnD;;;QACE,sBAAI,iCAAM;iBAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC,MAAyB,CAAC;aAC/C;;;WAAA;;KAHH,CAAmC,gBAAgB;;gBANlDJ,cAAS,SAAC;oBACT,QAAQ,EAAE,SAAS;oBACnB,sxEAAoC;oBAEpC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;;QCCmC,kCAAgB;QAApD;;;QACE,sBAAI,kCAAM;iBAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC,MAAyB,CAAC;aAC/C;;;WAAA;;KAHH,CAAoC,gBAAgB;;gBANnDJ,cAAS,SAAC;oBACT,QAAQ,EAAE,UAAU;oBACpB,0kEAAqC;oBAErC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;;QCAqC,oCAAgB;QAAtD;;;;KAAA,CAAsC,gBAAgB;;gBANrDJ,cAAS,SAAC;oBACT,QAAQ,EAAE,YAAY;oBACtB,yCAAuC;oBAEvC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;aCRe,QAAQ,CAAC,MAAc;QACrC,IAAI,KAAU,CAAC;QAEf,IAAI;;YAEF,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC;SACtB;QAAC,OAAO,CAAC,EAAE,GAAE;QAEd,OAAO,KAAK,CAAC;IACf;;;QCgCmC,iCAAmC;QAAtE;;;QAKE,sBAAI,wCAAa;iBAAjB;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC,aAAkC,CAAC;aACxD;;;WAAA;QAED,gCAAQ,GAAR;YAAA,iBA4BC;YA3BC,iBAAM,QAAQ,WAAE,CAAC;YAEjB,IAAI,IAAI,CAAC,aAAa,CAAC,iBAAiB,EAAE;gBACxC,IAAI,CAAC,iBAAiB,GAAG,QAAQ,CAC/B,IAAI,CAAC,aAAa,CAAC,iBAA2B,CAC/C,CAAC;aACH;YAED,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,GAAG,CACrC,UAAA,GAAG,IAAI,wCACF,GAAG,KACN,MAAM,EAAE,CAAC,GAAG,CAAC,MAAM,IAAI,EAAE,EAAE,GAAG,CAAC,UAAA,GAAG,IAChC,OAAA,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CACrB,GAAG,EACH,KAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAClB,KAAI,CAAC,KAAK,CAAC,WAAW,CACvB,GAAA,CACF,EACD,cAAc,EAAE,wBAAwB,CACtC,GAAG,CAAC,cAAc,IAAI,EAAE,EACxB,KAAI,CAAC,KAAK,CAAC,MAAM,EACjB,KAAI,CAAC,KAAK,CAAC,WAAW,EACtB,KAAI,CAAC,QAAQ,EACb,KAAI,CAAC,OAAO,CAAC,UAAU,CACxB,OACD,CACH,CAAC;SACH;QAED,iCAAS,GAAT,UAAU,KAAwB;YAChC,IAAI,IAAI,CAAC,iBAAiB,EAAE;gBAC1B,IAAI,CAAC,iBAAiB,CACpB,KAAK,EACL,IAAI,CAAC,KAAK,CACX,CAAC;aACH;SACF;;KA9CH,CAAmC,gBAAmC;;gBANrEJ,cAAS,SAAC;oBACT,QAAQ,EAAE,SAAS;oBACnB,mmCAAoC;oBAEpC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;;ICjCM,IAAM,0BAA0B;QACrC,GAAChB,mBAAW,CAAC,KAAK,IAAG,cAAc;QACnC,GAACA,mBAAW,CAAC,IAAI,IAAG,aAAa;QACjC,GAACA,mBAAW,CAAC,SAAS,IAAG,kBAAkB;QAC3C,GAACA,mBAAW,CAAC,IAAI,IAAG,aAAa;QACjC,GAACA,mBAAW,CAAC,OAAO,IAAG,gBAAgB;WACxC;;ICXD,IAAY,aAGX;IAHD,WAAY,aAAa;QACvB,sCAAqB,CAAA;QACrB,wCAAuB,CAAA;IACzB,CAAC,EAHW,aAAa,KAAb,aAAa,QAGxB;IAED,IAAY,eAGX;IAHD,WAAY,eAAe;QACzB,gCAAa,CAAA;QACb,gCAAa,CAAA;IACf,CAAC,EAHW,eAAe,KAAf,eAAe,QAG1B;IAED,IAAY,iBAGX;IAHD,WAAY,iBAAiB;QAC3B,sCAAiB,CAAA;QACjB,0CAAqB,CAAA;IACvB,CAAC,EAHW,iBAAiB,KAAjB,iBAAiB;;aCEb,cAAc,CAC5B,OAAgB,EAChB,MAAc,EACd,WAAwB,EACxB,QAAkB,EAClB,UAAe,EACf,MAAW;;QAAX,uBAAA,EAAA,WAAW;QAEX,IAAM,OAAO,GAAa,EAAE,CAAC;QAE7B,IAAI,MAAM,GAA+B,EAAE,CAAC;QAE5C,IAAI,OAAO,CAAC,cAAc,EAAE;YAC1B,OAAO,CAAC,IAAI,CAAC,SAAO,OAAO,CAAC,cAAgB,CAAC,CAAC;SAC/C;QAED,IAAI,OAAO,CAAC,aAAa,EAAE;YACzB,OAAO,CAAC,IAAI,CAAC,WAAS,OAAO,CAAC,aAAe,CAAC,CAAC;SAChD;QAED,IAAI,OAAO,CAAC,aAAa,EAAE;YACzB,OAAO,CAAC,IAAI,CAAC,WAAS,OAAO,CAAC,aAAe,CAAC,CAAC;SAChD;;;;;QAMD,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;YACnB,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACxB;QAED,IAAI,OAAO,CAAC,OAAO,EAAE;YACnB,OAAO,CAAC,IAAI,OAAZ,OAAO,WAAS,OAAO,CAAC,OAAO,GAAE;SAClC;QAED,IAAI,OAAO,CAAC,MAAM,EAAE;;;;YAKlB,IAAI,OAAO,CAAC,KAAK,EAAE;;gBAEjB,MAAM,GAAG,CAAC,OAAO,CAAC,MAAM,IAAI,EAAE,EAAE,GAAG,CAAC,UAAA,EAAE,IAAI,OAAA,OAAO,CAAC,KAAK,GAAG,EAAE,GAAA,CAAC,CAAC;aAC/D;iBAAM;gBACL,MAAM,GAAG,CAAC,OAAO,CAAC,MAAM,IAAI,EAAE;;qBAE3B,MAAM,CAAC,UAAC,GAAoB,EAAE,GAAW;oBACxC,IAAM,UAAU,GAAG,MAAM,CAAC,kBAAkB,CAAC,GAAG,EAAE,WAAW,CAAC,CAAC;oBAE/D,IACE,CAAC,UAAU;wBACX,CAAC,UAAU,CAAC,KAAK;yBAEf,OAAO,UAAU,CAAC,KAAK,KAAK,QAAQ;4BAClC,UAAU,CAAC,KAAK,KAAK,MAAM,CAAC,IAAI;4BAChC,UAAU,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CACzC,EACD;wBACA,GAAG,CAAC,IAAI,CACN,MAAM,CAAC,KAAK,CAAC,GAAG,EAAE,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,WAAW,CAAC,CACrD,CAAC;qBACH;oBAED,OAAO,GAAG,CAAC;iBACZ,EAAE,EAAE,CAAC,CAAC;aACV;SACF;QAED,IAAM,eAAe,GAAG,gCACnB,OAAO,KACV,OAAO,SAAA;YACP,MAAM,QAAA;YACN,UAAU,YAAA,GACQ,CAAC;;;;;QAMrB,IAAI,OAAO,CAAC,UAAU,EAAE;YAEtB,eAAe,CAAC,UAAU,GAAG,EAAE,CAAC;YAChC,IAAM,SAAS,GAAG,UAAU,IAAI,EAAE,CAAC;;gBAEnC,KAAkB,IAAA,KAAA,SAAA,OAAO,CAAC,UAAU,CAAA,gBAAA,4BAAE;oBAAjC,IAAM,GAAG,WAAA;oBACZ,IAAI,SAAS,SAAA,CAAC;oBAEd,IAAM,IAAI,GAAG,GAAG,CAAC,IAAI,IAAI,aAAa,CAAC,QAAQ,CAAC;oBAChD,IAAM,MAAM,GAAG,GAAG,CAAC,MAAM,IAAI,eAAe,CAAC,IAAI,CAAC;oBAClD,IAAM,UAAU,GAAG,GAAG,CAAC,UAAU,IAAI,iBAAiB,CAAC,MAAM,CAAC;oBAC9D,IAAM,cAAc,GAAG,GAAG,CAAC,cAAc,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;oBAEvD,IAAI,GAAG,CAAC,SAAS,EAAE;wBACjB,SAAS,GAAG,QAAQ,CAAC,GAAG,CAAC,SAAmB,CAAC,CAAC;qBAC/C;oBAED,IAAI,SAAS,EAAE;;;;wBAKb,IAAI,UAAU,KAAK,iBAAiB,CAAC,MAAM,EAAE;;;;4BAK3C,IACE,CAAC,MAAM,KAAK,eAAe,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC;iCACxD,MAAM,KAAK,eAAe,CAAC,IAAI,IAAI,SAAS,CAAC,SAAS,CAAC,CAAC,EACzD;gCACA,OAAO,IAAI,CAAC;6BACb;yBACF;wBAED,eAAe,CAAC,UAAU,CAAC,IAAI,CAAC,gBAC9B,SAAS,WAAA;4BACT,IAAI,MAAA;4BACJ,MAAM,QAAA;4BACN,cAAc,gBAAA;4BACd,UAAU,YAAA,IACP,GAAG,CAAC,IAAI,IAAI;4BACb,IAAI,EAAE,GAAG,CAAC,IAAI;yBACf,CACmB,CAAC,CAAC;qBACzB;iBACF;;;;;;;;;SACF;QAED,OAAO,gBACL,SAAS,EAAE,IAAIiB,sBAAe,CAC5B,0BAA0B,CAAC,OAAO,CAAC,IAAI,IAAIjB,mBAAW,CAAC,IAAI,CAAC,EAC5D,IAAI,EACJ,qBAAqB,CAAC,QAAQ,kBAC5B,OAAO,EAAE,eAAe,EACxB,MAAM,QAAA;gBACN,WAAW,aAAA,IACR,MAAM,IAAI,EAAC,MAAM,QAAA,EAAC,EACrB,CACH,IACE,eAAe,CACA,CAAC;IACvB;;aCtJgB,wBAAwB,CACtC,QAAmB,EACnB,MAAc,EACd,WAAwB,EACxB,QAAkB,EAClB,KAAU,EACV,MAAe;QAEf,OAAO,QAAQ,CAAC,MAAM,CAAC,UAAC,GAAG,EAAE,GAAG;YAC9B,IAAI,CAAC,GAAG,CAAC,aAAa,IAAI,GAAG,CAAC,aAAa,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE;gBAEjE,IAAM,QAAQ,GAAG,cAAc,CAC7B,GAAG,EACH,MAAM,EACN,WAAW,EACX,QAAQ,EACR,KAAK,EACL,MAAM,CACP,CAAC;gBAEF,IAAI,QAAQ,EAAE;oBACZ,GAAG,CAAC,IAAI;;oBAEN,QAAQ,CACT,CAAC;iBACH;aACF;YAED,OAAO,GAAG,CAAC;SACZ,EAAE,EAAE,CAAC,CAAC;IACT;;ICpCA,WAAY,aAAa;QACvB,gCAAe,CAAA;QACf,kCAAiB,CAAA;QACjB,8BAAa,CAAA;QACb,gCAAe,CAAA;QACf,oCAAmB,CAAA;QACnB,kCAAiB,CAAA;QACjB,sCAAqB,CAAA;QACrB,8BAAa,CAAA;QACb,gCAAe,CAAA;QACf,gCAAe,CAAA;QACf,kCAAiB,CAAA;QACjB,8CAA6B,CAAA;QAC7B,oCAAmB,CAAA;QACnB,gCAAe,CAAA;QACf,wCAAuB,CAAA;QACvB,sCAAqB,CAAA;IACvB,CAAC,EAjBWkB,qBAAa,KAAbA,qBAAa;;;QCGzB;SAgEC;QA9DC,gCAAY,GAAZ,UACE,QAAgB,EAChB,QAAiB,EACjB,IAGC,EACD,MAAY,EACZ,OAAuB;YAEvB,OAAOC,OAAE,CAAC,EAAE,CAAC,CAAC;SACf;QAED,sCAAkB,GAAlB,UACE,QAAgB,EAChB,OAAgB,EAChB,MAAoB;YAEpB,OAAOA,OAAE,CAAC,EAAE,CAAC,CAAC;SACf;QAED,mCAAe,GAAf,UACE,QAAgB,EAChB,QAAiB,EACjB,IAGC,EACD,MAAY,EACZ,OAAuB;YAEvB,OAAOA,OAAE,CAAC,EAAE,CAAC,CAAC;SACf;QAED,+BAAW,GAAX,UACE,QAAgB,EAChB,UAAkB,EAClB,MAAc;YAAd,uBAAA,EAAA,cAAc;YAEd,OAAOA,OAAE,EAAE,CAAC;SACb;QAED,+BAAW,GAAX,UACE,QAAgB,EAChB,UAAkB,EAClB,IAAS,EACT,OAAa;YAEb,OAAOA,OAAE,EAAE,CAAC;SACb;QAED,kCAAc,GAAd,UAAe,QAAgB,EAAE,UAAkB;YACjD,OAAOA,OAAE,EAAE,CAAC;SACb;QAED,qCAAiB,GAAjB,UAAkB,KAAa,EAAE,QAAgB;YAC/C,OAAOA,OAAE,EAAE,CAAC;SACb;QAED,qCAAiB,GAAjB,UAAkB,EAAU;YAC1B,OAAOA,OAAE,EAAE,CAAC;SACb;wBACF;KAAA;;QChEY,cAAc,GAAG,IAAIX,mBAAc,CAAK,gBAAgB,EAAE;aAEvD,uBAAuB,CAAC,QAAkB,EAAE,UAAe;QACzE,IAAM,cAAc,GAAG,IAAI,OAAO,EAAE,CAAC;QACrC,cAAc,CAAC,GAAG,CAAC,cAAc,EAAE,UAAU,CAAC,CAAC;QAC/C,OAAO,IAAIC,qBAAc,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;IACtD;;ICLA;;QAME,wBACiC,KAAQ;YAAR,UAAK,GAAL,KAAK,CAAG;YAGvC,IAAM,OAAO,GAAG;gBACd,eAAY,IAAI,CAAC,KAAK,CAAC,cAAc,IAAI,EAAE,CAAE;aAC9C,CAAC;YAEF,IAAI,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE;gBAC5B,OAAO,CAAC,IAAI,CAAC,gBAAc,IAAI,CAAC,KAAK,CAAC,aAAe,CAAC,CAAC;aACxD;YAED,IAAI,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE;gBAC5B,OAAO,CAAC,IAAI,CAAC,gBAAc,IAAI,CAAC,KAAK,CAAC,aAAe,CAAC,CAAC;aACxD;YAED,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE;gBACpB,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;aAChC;YAED,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SAChC;;;;gBA1BFG,cAAS,SAAC;oBACT,QAAQ,EAAE,UAAU;oBACpB,QAAQ,EAAE,EAAE;iBACb;;;gDAGIC,WAAM,SAAC,cAAc;;;wBAsBvBE,gBAAW,SAAC,OAAO;;;aCvBN,MAAM,CACpB,GAAW,EACX,IAAe;QAEf,IAAI,IAAI,CAAC,GAAG,CAAC,EAAE;YAEb,IAAI,MAAS,CAAC;YAEd,QAAQ,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI;gBACpB,KAAK,SAAS;oBACZ,MAAI,GAAG,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC;oBAEjC,IAAI,MAAI,EAAE;wBACR,OAAO,IAAI,CAAC,IAAI,CAAC,YAAY;6BAC1B,IAAI,CACHK,aAAG,CAAC,UAAA,KAAK,IACP,OAAA,MAAI,CACF,IAAI,CAAC,OAAO,CAAC,KAAK,EAClB,KAAK,CACN,GAAA,CACF,CACF,CAAC;qBACL;oBAED,MAAM;gBACR,KAAK,QAAQ;oBACX,MAAI,GAAG,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC;oBAEjC,IAAI,MAAI,EAAE;wBACR,OAAOD,OAAE,CAAC,MAAI,CACZ,IAAI,CAAC,OAAO,CAAC,KAAK,EAClB,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CACxB,CAAC,CAAC;qBACJ;oBACD,MAAM;gBACR,KAAK,MAAM,CAAC;gBACZ;oBACE,OAAOA,OAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC;aAC9B;SACF;QAED,OAAOA,OAAE,CAAC,EAAE,CAAC,CAAC;IAChB;;;QCjB2C,yCAAgC;QAEzE,+BACiC,KAAuB,EAC9C,SAAoB;YAF9B,YAIE,kBAAM,KAAK,CAAC,SACb;YAJgC,WAAK,GAAL,KAAK,CAAkB;YAC9C,eAAS,GAAT,SAAS,CAAW;YAM9B,cAAQ,GAAG,IAAIE,oBAAe,CAAC,IAAI,CAAC,CAAC;;SAHpC;QAOD,wCAAQ,GAAR;YAAA,iBAgDC;YA9CC,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;YAC5C,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;YAE5C,IAAI,QAA0D,CAAC;YAE/D,IAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;gBAEhB,IAAA,UAAQ,GAAI,IAAI,CAAC,KAAK,SAAd,CAAe;gBAE9B,QAAQ,GAAG,IAAI,CAAC,SAAS;qBACtB,kBAAkB,CACjB,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,UAAU,EAC9B,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,EAC3B,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAC3B;qBACA,IAAI,CACHD,aAAG,CAAC,UAAA,IAAI,IACN,OAAA,IAAI,CAAC,GAAG,CAAC,UAAA,GAAG,IAAI,QAAC;oBACf,KAAK,EAAE,GAAG,CAAC,UAAQ,CAAC,QAAQ,IAAI,IAAI,CAAC;oBACrC,IAAI,EAAE,GAAG,CAAC,UAAQ,CAAC,OAAO,CAAC;iBAC5B,IAAC,CAAC,GAAA,CACJ,EACDlB,aAAG,CAAC,cAAM,OAAA,KAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,GAAA,CAAC,CACrC,CAAC;aACL;iBAAM;gBACL,QAAQ,GAAGiB,OAAE,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;aACnC;YAED,IAAI,CAAC,YAAY,GAAG,QAAQ,CAAC,IAAI,CAC/BG,mBAAS,CAAC,UAAA,OAAO,IACf,OAAA,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,YAAY,CAAC,IAAI,CAClCC,mBAAS,CAAC,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EACnCH,aAAG,CAAC,UAAA,KAAK;gBACP,IAAI,CAAC,KAAK,EAAE;oBACV,OAAO,OAAO,CAAC;iBAChB;gBAED,KAAK,GAAG,KAAK,CAAC,WAAW,EAAE,CAAC;gBAE5B,OAAO,OAAO,CAAC,MAAM,CAAC,UAAA,IAAI,IACxB,OAAA,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAA,CACxC,CAAC;aACH,CAAC,CACH,GAAA,CACF,CACF,CAAC;SACH;;KA9DH,CAA2C,cAAgC;;gBAN1ER,cAAS,SAAC;oBACT,QAAQ,EAAE,iBAAiB;oBAC3B,s1BAA4C;oBAE5C,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;gDAIIH,WAAM,SAAC,cAAc;gBA9BlB,SAAS;;;;QCEsB,qCAAyB;QAAhE;;;;KAAA,CAAuC,cAAyB;;gBAN/DD,cAAS,SAAC;oBACT,QAAQ,EAAE,aAAa;oBACvB,6RAAwC;oBAExC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;;QCcmC,kCAAyB;QAN7D;YAAA,4DA2CC;YAlCC,UAAI,GAAa,EAAE,CAAC;;SAkCrB;QA7BC,iCAAQ,GAAR;YACE,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC;YACrC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,WAAW,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,IAAI,CAAC;YACtF,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;YAC5C,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;SAC7C;QAED,4BAAG,GAAH,UAAI,KAAwB;YAC1B,IAAM,KAAK,GAAG,CAAC,KAAK,CAAC,KAAK,IAAI,EAAE,EAAE,IAAI,EAAE,CAAC;YACzC,IAAM,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;YAE1B,IAAI,KAAK,KAAK,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,EAAE;gBACpE,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBACtB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aACxC;YAED,IAAI,KAAK,EAAE;gBACT,KAAK,CAAC,KAAK,GAAG,EAAE,CAAC;aAClB;SACF;QAED,+BAAM,GAAN,UAAO,IAAY;YACjB,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;YAErD,IAAI,KAAK,IAAI,CAAC,EAAE;gBACd,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBAC3B,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aACxC;SACF;;KApCH,CAAoC,cAAyB;;gBAN5DJ,cAAS,SAAC;oBACT,QAAQ,EAAE,UAAU;oBACpB,+9BAAqC;oBAErC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;ICfD;;;;;aAKgB,oBAAoB,CAA4B,OAAU;QACxE,IAAI,UAAa,CAAC;QAElB,IAAI,OAAO,YAAYQ,eAAS,EAAE;YAChC,IAAM,WAAS,GAAG,IAAIA,eAAS,CAC7B,EAAE,EACF,OAAO,CAAC,SAAS,EACjB,OAAO,CAAC,cAAc,CACvB,CAAC;YACF,IAAM,UAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC;YAElC,MAAM,CAAC,IAAI,CAAC,UAAQ,CAAC,CAAC,OAAO,CAAC,UAAA,GAAG;gBAC/B,WAAS,CAAC,UAAU,CAAC,GAAG,EAAE,oBAAoB,CAAC,UAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;aAChE,CAAC,CAAC;YAEH,UAAU,GAAG,WAAgB,CAAC;SAC/B;aAAM,IAAI,OAAO,YAAYC,eAAS,EAAE;YACvC,IAAM,WAAS,GAAG,IAAIA,eAAS,CAC7B,EAAE,EACF,OAAO,CAAC,SAAS,EACjB,OAAO,CAAC,cAAc,CACvB,CAAC;YAEF,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAA,WAAW,IAClC,OAAA,WAAS,CAAC,IAAI,CAAC,oBAAoB,CAAC,WAAW,CAAC,CAAC,GAAA,CAClD,CAAC;YAEF,UAAU,GAAG,WAAgB,CAAC;SAC/B;aAAM,IAAI,OAAO,YAAYC,iBAAW,EAAE;YACzC,UAAU,GAAG,IAAIA,iBAAW,CAC1B,OAAO,CAAC,KAAK,EACb,OAAO,CAAC,SAAS,EACjB,OAAO,CAAC,cAAc,CAChB,CAAC;SACV;aAAM;YACL,MAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC,CAAC;SACpD;QAED,IAAI,OAAO,CAAC,QAAQ,EAAE;YACpB,UAAU,CAAC,OAAO,CAAC,EAAC,SAAS,EAAE,KAAK,EAAC,CAAC,CAAC;SACxC;QAED,OAAO,UAAU,CAAC;IACpB;;;QCxBwC,sCAAwB;QAE9D,4BACiC,KAAe,EACtC,GAAsB,EACtB,kBAAsC;YAHhD,YAKE,kBAAM,KAAK,CAAC,SACb;YALgC,WAAK,GAAL,KAAK,CAAU;YACtC,SAAG,GAAH,GAAG,CAAmB;YACtB,wBAAkB,GAAlB,kBAAkB,CAAoB;;SAG/C;QAQD,qCAAQ,GAAR;YACE,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAClD,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO;kBAC/B,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;kBAC5B,IAAI,IAAI,EAAE,CAAC;YAEf,IAAM,IAAI,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YAEhD,IAAI,CAAC,YAAY,GAAG,oBAAoB,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;YAC7D,IAAI,CAAC,YAAY,GAAG,IAAIA,iBAAW,CACjC,EAAC,KAAK,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,EAAC,EACpE,CAACC,gBAAU,CAAC,GAAG,CAAC,CAAC,CAAC,EAAEA,gBAAU,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CACxC,CAAC;YACF,IAAI,CAAC,cAAc,GAAG,IAAID,iBAAW,CACnC,EAAC,KAAK,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,EAAC,EACtE,CAACC,gBAAU,CAAC,GAAG,CAAC,CAAC,CAAC,EAAEA,gBAAU,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CACxC,CAAC;;;;YAKF,IACE,OAAO,IAAI,CAAC,YAAY,CAAC,KAAK,KAAK,QAAQ;gBAC3C,OAAO,IAAI,CAAC,YAAY,CAAC,KAAK,KAAK,QAAQ,EAC3C;gBACA,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;aAC/D;SACF;QAED,iCAAI,GAAJ;YAAA,iBAyBC;YAxBC,OAAOR,OAAE,CAAC,EAAE,CAAC,CAAC,IAAI,CAChBjB,aAAG,CAAC;gBACF,IAAI,KAAK,GAAG,KAAI,CAAC,YAAY,CAAC,KAAK,CAAC;gBAEpC,IAAI,KAAK,EAAE;oBACT,IAAI,KAAI,CAAC,KAAK,CAAC,WAAW,EAAE;wBAC1B,KAAK,CAAC,QAAQ,CAAC,KAAI,CAAC,YAAY,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC;wBAC7C,KAAK,CAAC,UAAU,CAAC,KAAI,CAAC,cAAc,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC;qBAClD;oBAED,IAAI,KAAI,CAAC,KAAK,CAAC,MAAM,EAAE;wBACrB,IAAI,KAAI,CAAC,KAAK,CAAC,MAAM,KAAK,QAAQ,EAAE;4BAClC,KAAK,GAAG,KAAK,CAAC,OAAO,EAAE,CAAC;yBACzB;6BAAM;4BACL,IAAM,IAAI,GAAG,IAAI0B,eAAQ,CAAC,IAAI,CAAC,CAAC;4BAEhC,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;yBAClD;qBACF;iBACF;gBAED,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;aACpC,CAAC,CACH,CAAC;SACH;;KAtEH,CAAwC,cAAwB;;gBAN/DhB,cAAS,SAAC;oBACT,QAAQ,EAAE,eAAe;oBACzB,8mDAA0C;oBAE1C,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;gDAIIH,WAAM,SAAC,cAAc;gBAjCOgB,sBAAiB;gBAK1C,kBAAkB;;;;QCUkB,0CAAwB;QAApE;;;QAEE,yCAAQ,GAAR;YAAA,iBAQC;YAPC,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,EAAE;gBACnC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,UAAC,SAAS,EAAE,SAAS;oBAC3C,IAAM,QAAQ,GAAG,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;oBAC7D,IAAM,QAAQ,GAAG,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;oBAC7D,OAAO,QAAQ,GAAG,QAAQ,CAAC;iBAC5B,CAAC,CAAC;aACJ;SACF;QAED,qCAAI,GAAJ,UAAK,KAA4B;YAC/BlB,wBAAe,CACb,IAAI,CAAC,KAAK,CAAC,OAAO,EAClB,KAAK,CAAC,aAAa,EACnB,KAAK,CAAC,YAAY,CACnB,CAAC;YAEF,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CACzB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,UAAA,GAAG;gBACxB,OAAO,GAAG,CAAC,KAAK,CAAC;aAClB,CAAC,CACH,CAAC;SACH;;KAxBH,CAA4C,cAAwB;;gBANnEC,cAAS,SAAC;oBACT,QAAQ,EAAE,mBAAmB;oBAC7B,meAA8C;oBAE9C,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;;QCfD;SAIC;QADC,+BAAM,GAAN,UAAO,IAAY,EAAE,IAAS,EAAE,QAAc,KAAS;6BACxD;KAAA;;ICJD;;;;;;;;;QASa,cAAc,GAAG,UAAC,IAAY;QACzC,IAAM,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC;QACpD,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC;QAC5C,IAAI,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,IAAI,EAAE,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC;QACnD,OAAO,CAAC,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,GAAG,SAAS,GAAG,WAAQ,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,SAAA,EAAE,EAAI,CAAC,CAAA,CAAC,GAAG,CAAC,IAAG,SAAW,CAAC;IAC1G;;ICdO,IAAM,SAAS,GAAG,UAAC,IAAqB;QAC7C,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;YAC5B,OAAO,IAAI,CAAC;SACb;QAED,IAAM,EAAE,GAAG,IAAI,CAAC;QAChB,IAAM,EAAE,GAAG,SAAA,EAAE,EAAI,CAAC,CAAA,CAAC;QAEnB,IAAM,GAAG,GAAG,UAAU,CAAC,IAAI,CAAC,CAAC;QAC7B,IAAM,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC,WAAW,EAAE,CAAC;QAEtD,QAAQ,IAAI;YACV,KAAK,IAAI,EAAE;gBACT,OAAO,GAAG,GAAG,EAAE,CAAC;aACjB;YACD,KAAK,IAAI,EAAE;gBACT,OAAO,GAAG,GAAG,EAAE,CAAC;aACjB;YACD,SAAS;gBACP,OAAO,CAAC,CAAC;aACV;SACF;IACH,CAAC;;;QCMkC,iCAAwB;QAYzD,uBACiC,KAAe,EACtC,OAAuB,EACvB,GAAsB,EACtB,kBAAsC,EACtC,SAA2B,EAC3B,QAAqB;YAN/B,YAQE,kBAAM,KAAK,CAAC,SACb;YARgC,WAAK,GAAL,KAAK,CAAU;YACtC,aAAO,GAAP,OAAO,CAAgB;YACvB,SAAG,GAAH,GAAG,CAAmB;YACtB,wBAAkB,GAAlB,kBAAkB,CAAoB;YACtC,eAAS,GAAT,SAAS,CAAkB;YAC3B,cAAQ,GAAR,QAAQ,CAAa;;SAG9B;QAED,gCAAQ,GAAR;YACE,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,EAAE;gBAC5B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC;aACtC;YAED,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,mBAAmB,CAAW,CAAC;YAEpH,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAElD,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,gBAAgB,IAAI,EAAE,CAAC;YAC1D,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,KAAK,CAAC,kBAAkB,IAAI,EAAE,CAAC;YAC9D,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YAC3E,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;SAC5E;QAED,kCAAU,GAAV,UAAW,OAAiC,EAAE,OAAmC;YAAtE,wBAAA,EAAA,yBAAiC;YAAE,wBAAA,EAAA,2BAAmC;YAC/E,IAAI,CAAC,QAAQ,CAAC,IAAI,CAChB,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,OAAO,CAAC,EACjC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,OAAO,CAAC,EACjC;gBACE,UAAU,EAAE,iBAAiB;gBAC7B,QAAQ,EAAE,IAAI;aACf,CACF,CAAC;SACH;QAED,kCAAU,GAAV,UAAW,EAAS;YAClB,IAAM,EAAE,GAAG,EAAE,CAAC,MAA0B,CAAC;YACzC,IAAM,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,KAAiB,CAAC,CAAC,CAAC,CAAS,CAAC;YAEzD,MAAM,CAAC,cAAc,CAAC,IAAI,EAAE,MAAM,EAAE;gBAClC,QAAQ,EAAE,IAAI;gBACd,KAAK,EAAE,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC;aACjC,CAAC,CAAC;YAEH,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE;gBAChF,IAAI,CAAC,UAAU,CAAC,iCAAiC,CAAC,CAAC;gBACnD,OAAOZ,eAAU,CAAC,qBAAqB,CAAC,CAAC;aAC1C;YAED,IAAI,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;gBAC/C,IAAI,CAAC,UAAU,CAAC,mCAAmC,CAAC,CAAC;gBACrD,OAAOA,eAAU,CAAC,uBAAuB,CAAC,CAAC;aAC5C;YAED,IAAI,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,YAAY,EAAE;gBACjC,IAAI,CAAC,UAAU,CAAC,wBAAwB,CAAC,CAAC;gBAC1C,OAAOA,eAAU,CAAC,iCAAiC,CAAC,CAAC;aACtD;YAED,IAAI,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,YAAY,IAAI,CAAC,CAAC,IAAI,CAAC,YAAY,EAAE;gBACxD,IAAI,CAAC,UAAU,CAAC,yBAAyB,CAAC,CAAC;gBAC3C,OAAOA,eAAU,CAAC,6BAA6B,CAAC,CAAC;aAClD;YAED,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;YAClB,IAAI,IAAI,CAAC,KAAK,EAAE;gBACd,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;aAC7B;YACD,EAAE,CAAC,KAAK,GAAG,EAAE,CAAC;SACf;QAED,6BAAK,GAAL;YACE,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;YACf,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;SACjC;QAED,4BAAI,GAAJ,UAAK,QAAgB,EAAE,UAAkB;YAAzC,iBAwBC;YAvBC,IAAI,IAAI,CAAC,KAAK,EAAE;gBACd,IAAM,IAAI,GAAG;oBACX,QAAQ;oBACR,UAAU;oBACV,IAAI,CAAC,KAAK,CAAC,IAAI;iBAChB;qBACE,IAAI,CAAC,GAAG,CAAC,CAAC;gBAEb,OAAO0B,SAAI,CACT,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,EAAE;oBACpC,WAAW,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI;oBAC5B,cAAc,EAAE;wBACd,QAAQ,UAAA;wBACR,UAAU,YAAA;qBACX;iBACF,CAAC,CACH,CAAC,IAAI,CACJR,mBAAS,CAAC,UAAC,GAAQ,IAAK,OAAA,GAAG,CAAC,GAAG,CAAC,cAAc,EAAE,GAAA,CAAC,EACjDpB,aAAG,CAAC,UAAA,GAAG,IAAI,OAAA,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAA,CAAC,CAC7C,CAAC;aACH;iBAAM;gBACL,OAAOiB,OAAE,CAAC,EAAE,CAAC,CAAC;aACf;SACF;;KAlHH,CAAmC,cAAwB;;gBAN1DP,cAAS,SAAC;oBACT,QAAQ,EAAE,SAAS;oBACnB,4sBAAoC;oBAEpC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;gDAcIH,WAAM,SAAC,cAAc;gBAjClB,cAAc;gBARWgB,sBAAiB;gBAM1C,kBAAkB;gBAJlBvB,0BAAgB;gBADhBC,oBAAW;;;yBA4BhBwB,cAAS,SAAC,MAAM,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC;;;aC3BnB,qBAAqB,CAAC,IAAsB;QAC1D,OAAO,IAAI,CAAC,MAAM,CAAC,UAAC,GAAG,EAAE,GAAG,EAAE,KAAK;YACjC,GAAG,CAAC,eAAY,KAAK,GAAG,CAAC,CAAE,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,SAAS,EAAE,EAAY;oBAAZ,KAAA,aAAY,EAAX,GAAG,QAAA,EAAE,KAAK,QAAA;gBAC/E,SAAS,IAAI,SAAO,GAAG,SAAI,KAAO,CAAC;gBACnC,OAAO,SAAS,CAAC;aAClB,EAAE,EAAE,CAAC,CAAC;YACP,OAAO,GAAG,CAAC;SACZ,EAAE,EAAE,CAEJ,CAAC;IACJ;;QCVa,WAAW,GAAG,IAAIvB,mBAAc,CAAK,aAAa;;ICF/D;;;;aAIgB,mBAAmB,CACjC,KAAY,EACZ,aAAqB,EACrB,YAAoB;QAEpB,IAAM,OAAO,GAAG,KAAK,CAAC,aAAa,CAAC,CAAC;QACrC,IAAM,OAAO,GAAG,KAAK,CAAC,YAAY,CAAC,CAAC;QAEpC,KAAK,CAAC,YAAY,CAAC,GAAG,OAAO,CAAC;QAC9B,KAAK,CAAC,aAAa,CAAC,GAAG,OAAO,CAAC;IACjC;;aCZgB,QAAQ,CAAC,IAAU;QACjC,OAAO,IAAIwB,eAAU,CAAC,UAAA,GAAG;YACvB,IAAI,EAAE,IAAI,YAAY,IAAI,CAAC,EAAE;gBAC3B,GAAG,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,6CAA6C,CAAC,CAAC,CAAC;gBACpE,OAAO;aACR;YAED,IAAM,MAAM,GAAG,IAAI,UAAU,EAAE,CAAC;YAEhC,MAAM,CAAC,OAAO,GAAG,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,GAAA,CAAC;YACvC,MAAM,CAAC,OAAO,GAAG,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,GAAA,CAAC;YACvC,MAAM,CAAC,MAAM,GAAG,cAAM,OAAA,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,MAAgB,CAAC,GAAA,CAAC;YACxD,MAAM,CAAC,SAAS,GAAG,cAAM,OAAA,GAAG,CAAC,QAAQ,EAAE,GAAA,CAAC;YAExC,OAAO,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;SACnC,CAAC,CAAC;IACL;;;QC+BsC,oCAA2B;QAE/D,0BAES,KAAkB,EAGjB,UAAkB,EAClB,MAAiB,EACjB,GAAsB,EACtB,IAAgB,EAChB,OAAuB,EACvB,kBAAsC,EACtC,aAA4B,EAC5B,SAA2B,EAC3B,QAAqB;YAb/B,YAeE,kBAAM,KAAK,CAAC,SACb;YAdQ,WAAK,GAAL,KAAK,CAAa;YAGjB,gBAAU,GAAV,UAAU,CAAQ;YAClB,YAAM,GAAN,MAAM,CAAW;YACjB,SAAG,GAAH,GAAG,CAAmB;YACtB,UAAI,GAAJ,IAAI,CAAY;YAChB,aAAO,GAAP,OAAO,CAAgB;YACvB,wBAAkB,GAAlB,kBAAkB,CAAoB;YACtC,mBAAa,GAAb,aAAa,CAAe;YAC5B,eAAS,GAAT,SAAS,CAAkB;YAC3B,cAAQ,GAAR,QAAQ,CAAa;YAoB/B,WAAK,GAAW,EAAE,CAAC;YACnB,cAAQ,GAAU,EAAE,CAAC;;SAlBpB;QAyBD,mCAAQ,GAAR;YACE,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAElD,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,KAAK,CAAC,iBAAiB,IAAI,EAAE,CAAC;YAC5D,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,KAAK,CAAC,mBAAmB,IAAI,EAAE,CAAC;YAChE,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YAC3E,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;SAC5E;QAED,0CAAe,GAAf;YACE,IAAM,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,aAAa,CAAC;YAClD,IAAA,aAAa,GAAI,SAAgB,cAApB,CAAqB;YAEzC,SAAS,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;YACjC,aAAa,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;SACtC;QAED,2CAAgB,GAAhB;YACE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;gBACnC,KAAK,EAAE,OAAO;aACf,CAAC,CAAC;SACJ;QAED,mCAAQ,GAAR,UAAS,KAAa;YAAtB,iBA2CC;YA1CC,IAAI,CAAC,IAAI;iBACN,GAAG,CAAC,KAAK,EAAE;gBACV,eAAe,EAAE,KAAK;gBACtB,YAAY,EAAE,MAAM;aACrB,CAAC;iBACD,IAAI,CACHV,mBAAS,CAAC,UAAC,IAAU;gBACnB,IAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;gBACnD,IAAI,CAAC,KAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,KAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE;oBAC7E,OAAOlB,eAAU,CAAC,sBAAsB,CAAC,CAAC;iBAC3C;gBAED,IAAI,KAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;oBAC3C,OAAOA,eAAU,CAAC,wBAAwB,CAAC,CAAC;iBAC7C;gBAED,IAAI,IAAI,CAAC,IAAI,GAAG,KAAI,CAAC,YAAY,EAAE;oBACjC,OAAOA,eAAU,CAAC,kCAAkC,CAAC,CAAC;iBACvD;gBAED,IAAI,IAAI,CAAC,IAAI,GAAG,KAAI,CAAC,YAAY,IAAI,CAAC,CAAC,KAAI,CAAC,YAAY,EAAE;oBACxD,OAAOA,eAAU,CAAC,8BAA8B,CAAC,CAAC;iBACnD;gBAED,OAAOe,OAAE,CAAC,IAAI,CAAC,CAAC;aACjB,CAAC,EACF,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC;gBAC7B,KAAK,EAAE,6BAA6B;gBACpC,OAAO,EAAE,IAAI;aACd,CAAC,CAAC;iBACJ,SAAS,CAAC,UAAA,GAAG;gBACZ,IAAM,UAAU,GAAG,MAAM,CAAC,GAAG,IAAK,MAAc,CAAC,SAAS,CAAC;gBAC3D,IAAM,KAAK,GAAG,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC;gBAEvC,KAAK,CAAC,IAAI,CAAC;oBACT,IAAI,EAAE,UAAU,CAAC,eAAe,CAAC,GAAG,CAAC;oBACrC,IAAI,EAAE,IAAI;iBACX,CAAC,CAAC;gBAEH,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;gBACnC,KAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;aAC1B,CAAC,CAAC;SACN;QAED,yCAAc,GAAd;YACE,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;SACnC;QAED,yCAAc,GAAd;YACE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;gBAChC,KAAK,EAAE,OAAO;aACf,CAAC,CAAC;SACJ;QAED,+BAAI,GAAJ,UAAK,KAA4B;YAC/B,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC;YACvC,mBAAmB,CAAC,KAAK,EAAE,KAAK,CAAC,aAAa,EAAE,KAAK,CAAC,YAAY,CAAC,CAAC;YACpE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YACnC,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;SAC1B;QAED,+BAAI,GAAJ,UAAK,EAAU,EAAE,KAAa;YAAzB,mBAAA,EAAA,UAAU;YACb,IAAM,YAAY,GAAG,EAAE,GAAG,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,CAAC;YAChD,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC;YACvCR,wBAAe,CAAC,KAAK,EAAE,KAAK,EAAE,YAAY,CAAC,CAAC;YAC5C,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YACnC,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;SAC1B;QAED,qCAAU,GAAV,UAAW,OAAiC,EAAE,OAAmC;YAAtE,wBAAA,EAAA,yBAAiC;YAAE,wBAAA,EAAA,2BAAmC;YAC/E,IAAI,CAAC,QAAQ,CAAC,IAAI,CAChB,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,OAAO,CAAC,EACjC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,OAAO,CAAC,EACjC;gBACE,UAAU,EAAE,iBAAiB;gBAC7B,QAAQ,EAAE,IAAI;aACf,CACF,CAAC;SACH;QAED,wCAAa,GAAb,UAAc,EAA+B;;YAA7C,iBA2DC;YA1DC,IAAM,KAAK,GAAG,KAAK,CAAC,IAAI,EAAE,EAAE,YAAY,QAAQ,GAAG,EAAE,GAAG,EAAE,CAAC,KAAK,EAAc,CAAC;;gBAC/E,KAAmB,IAAA,UAAA,SAAA,KAAK,CAAA,4BAAA,+CAAE;oBAArB,IAAM,IAAI,kBAAA;oBACb,MAAM,CAAC,cAAc,CAAC,IAAI,EAAE,MAAM,EAAE;wBAClC,QAAQ,EAAE,IAAI;wBACd,KAAK,EAAE,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC;qBACjC,CAAC,CAAC;oBAEH,IAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;oBAEnD,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE;wBAC7E,IAAI,CAAC,UAAU,CAAC,qCAAqC,CAAC,CAAC;wBACvD,OAAOP,eAAU,CAAC,sBAAsB,CAAC,CAAC;qBAC3C;oBAED,IAAI,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;wBAC3C,IAAI,CAAC,UAAU,CAAC,uCAAuC,CAAC,CAAC;wBACzD,OAAOA,eAAU,CAAC,wBAAwB,CAAC,CAAC;qBAC7C;oBAED,IAAI,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,YAAY,EAAE;wBACjC,IAAI,CAAC,UAAU,CAAC,2BAA2B,CAAC,CAAC;wBAC7C,OAAOA,eAAU,CAAC,kCAAkC,CAAC,CAAC;qBACvD;oBAED,IAAI,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,YAAY,IAAI,CAAC,CAAC,IAAI,CAAC,YAAY,EAAE;wBACxD,IAAI,CAAC,UAAU,CAAC,4BAA4B,CAAC,CAAC;wBAC9C,OAAOA,eAAU,CAAC,8BAA8B,CAAC,CAAC;qBACnD;iBACF;;;;;;;;;YAED6B,aAAQ,CACN,KAAK,CAAC,GAAG,CAAC,UAAA,IAAI,IACZ,OAAA,QAAQ,CAAC,IAAI,CAAC,CAAC,IAAI,CACjBb,aAAG,CAAC,UAAA,IAAI,IAAI,QAAC;gBACX,IAAI,MAAA;gBACJ,UAAU,EAAE,IAAI;gBAChB,IAAI,EAAE,KAAK;aACZ,IAAC,CAAC,CACJ,GAAA,CACF,CACF,CAAC,SAAS,CACT,UAAA,GAAG;gBACD,IAAM,KAAK,GAAG,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC;gBACvC,KAAK,CAAC,IAAI,OAAV,KAAK,WAAS,GAAG,GAAE;gBACnB,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;gBAEnC,IAAI,EAAE,EAAE,YAAY,QAAQ,CAAC,EAAE;oBAC7B,EAAE,CAAC,KAAK,GAAG,EAAE,CAAC;iBACf;gBAED,KAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;aAC1B,EACD;gBACE,IAAI,EAAE,EAAE,YAAY,QAAQ,CAAC,EAAE;oBAC7B,EAAE,CAAC,KAAK,GAAG,EAAE,CAAC;iBACf;aACF,CACF,CAAC;SACH;QAED,sCAAW,GAAX,UAAY,KAAa,EAAE,IAAS;YAClC,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE;gBACpD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aAC/B;YAED,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;SAC3C;QAED,mCAAQ,GAAR,UAAS,KAA4B;YACnC,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC;YACvCT,wBAAe,CAAC,KAAK,EAAE,KAAK,CAAC,aAAa,EAAE,KAAK,CAAC,YAAY,CAAC,CAAC;YAChE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;SACpC;;;;QAKD,oCAAS,GAAT,UAAU,CAAc;YAAxB,iBASC;YARC,IAAM,KAAK,GAAG,IAAI,CAAC,wBAAwB,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;YAErD,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,UAAA,QAAQ;gBACpC,IAAI,4BAA4B,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE;oBAC5D,KAAI,CAAC,eAAe,GAAG,QAAQ,CAAC;oBAChC,OAAO;iBACR;aACF,CAAC,CAAC;SACJ;QAED,0CAAe,GAAf;YACE,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;gBAChB,OAAO;aACR;YAED,IAAM,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,aAAa,CAAC;YACzD,IAAM,MAAM,GAAQ,SAAS,CAAC,aAAa,CAAC;YAE5C,SAAS,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;YAE1B,IAAA,OAAO,GAAI,IAAI,CAAC,MAAa,QAAtB,CAAuB;YAErC,MAAM,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;YAC9B,MAAM,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;YAC9B,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,aAAa,EAAE,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC;YAE9E,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;YACnB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;YAEnB,IAAI,IAAI,CAAC,WAAW,KAAK,IAAI,CAAC,WAAW,EAAE;gBACzC,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC;gBACvCA,wBAAe,CAAC,KAAK,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;gBAC3D,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;aACpC;SACF;;QAGD,mDAAwB,GAAxB,UAAyB,KAA8B;;YAErD,IAAM,KAAK,GAAG,cAAc,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC,cAAc,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC;YAC5F,IAAM,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,yBAAyB,EAAE,CAAC;YAEtE,OAAO;gBACL,CAAC,EAAE,KAAK,CAAC,KAAK,GAAG,cAAc,CAAC,IAAI;gBACpC,CAAC,EAAE,KAAK,CAAC,KAAK,GAAG,cAAc,CAAC,GAAG;aACpC,CAAC;SACH;;;;;QAMD,+BAAI,GAAJ,UAAK,QAAgB,EAAE,UAAkB;YAAzC,iBA2DC;YA1DC,IACE,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM;gBACrB,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK;gBACzB,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,UAAC,GAAQ,IAAK,OAAA,CAAC,GAAG,CAAC,IAAI,GAAA,CAAC,EACvD;gBACA,OAAOQ,OAAE,CAAC,EAAE,CAAC,CAAC;aACf;YAED,OAAOc,aAAQ,UACV,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,UAAA,IAAI,IACvB,OAAAH,SAAI,CAAC,KAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,IAAI;;;;YAIvD3B,oBAAU,CAAC,cAAM,OAAAgB,OAAE,CAAC,EAAE,CAAC,GAAA,CAAC,CACzB,GAAA,CACF,EACE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,UAAC,GAAU,EAAE,GAAQ;gBACtD,IAAI,GAAG,CAAC,IAAI,KAAK,SAAS,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE;oBAEvC,IAAM,IAAI,GAAG;wBACX,QAAQ;wBACR,UAAU;wBACV,GAAG,CAAC,UAAU,CAAC,IAAI;qBACpB;yBACE,IAAI,CAAC,GAAG,CAAC,CAAC;oBAEb,GAAG,CAAC,IAAI,CACNW,SAAI,CACF,KAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,EAAE,GAAG,CAAC,UAAU,EAAE;wBACxC,WAAW,EAAE,GAAG,CAAC,UAAU,CAAC,IAAI;wBAChC,cAAc,kBACZ,QAAQ,UAAA;4BACR,UAAU,YAAA,IACP,KAAI,CAAC,KAAK,CAAC,eAAe;4BAC7B,qBAAqB,CAAC,KAAI,CAAC,KAAK,CAAC,eAAe,CAAC,CAClD;qBACF,CAAC,CACH,CAAC,IAAI,CACJR,mBAAS,CAAC,UAAC,IAAS,IAAK,OAAA,IAAI,CAAC,GAAG,CAAC,cAAc,EAAE,GAAA,CAAC,EACnDpB,aAAG,CAAC,UAAA,GAAG;wBACL,GAAG,CAAC,IAAI,GAAG,GAAG,CAAC;qBAChB,CAAC,CACH,CACF,CAAC;iBACH;qBAAM;oBACL,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;iBACf;gBAED,OAAO,GAAG,CAAC;aACZ,EAAE,EAAE,CAAC,EACN,CAAC,IAAI,CACLA,aAAG,CAAC,cACF,OAAA,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CACzB,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,UAAC,IAAS,IAAK,QAAC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,IAAC,CAAC,CAC5E,GAAA,CACF,CACF,CAAC;SACH;;KAjVH,CAAsC,cAA2B;;gBANhEU,cAAS,SAAC;oBACT,QAAQ,EAAE,YAAY;oBACtB,4wGAAuC;oBAEvC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;gDAIIH,WAAM,SAAC,cAAc;6CAErBqB,aAAQ,YACRrB,WAAM,SAAC,WAAW;gBAxCfsB,gBAAS;gBATfN,sBAAiB;gBAJXO,eAAU;gBAsBV,cAAc;gBAHd,kBAAkB;gBApBlBC,qBAAa;gBAgBb/B,0BAAgB;gBADhBC,oBAAW;;;4BAqDhBwB,cAAS,SAACO,yBAAgB,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC;8BAE1CP,cAAS,SAACQ,oBAAW,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC;gCAErCR,cAAS,SAAC,OAAO,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC;6BAEjCA,cAAS,SAAC,YAAY,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC;yBAEtCA,cAAS,SAAC,MAAM,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC;;IAwTnC,SAAS,SAAS,CAAC,UAAe,EAAE,IAAS;QAC3C,OAAO,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;IACxD,CAAC;IAED;IACA,SAAS,cAAc,CAAC,KAA8B;QACpD,OAAO,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;IACxC,CAAC;IAED,SAAS,4BAA4B,CAAC,QAAqB,EAAE,CAAS,EAAE,CAAS;QACzE,IAAA,KAA6B,QAAQ,CAAC,OAAO,CAAC,aAAa,CAAC,qBAAqB,EAAE,EAAlF,GAAG,SAAA,EAAE,MAAM,YAAA,EAAE,IAAI,UAAA,EAAE,KAAK,WAA0D,CAAC;QAC1F,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,MAAM,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,KAAK,CAAC;IAC5D;;;QCjXoC,kCAAyB;QAE3D,wBACiC,KAAgB,EACvC,OAAuB,EACvB,GAAsB,EACtB,kBAAsC,EACtC,SAA2B,EAC3B,QAAqB,EACrB,YAA0B;YAPpC,YASE,kBAAM,KAAK,CAAC,SACb;YATgC,WAAK,GAAL,KAAK,CAAW;YACvC,aAAO,GAAP,OAAO,CAAgB;YACvB,SAAG,GAAH,GAAG,CAAmB;YACtB,wBAAkB,GAAlB,kBAAkB,CAAoB;YACtC,eAAS,GAAT,SAAS,CAAkB;YAC3B,cAAQ,GAAR,QAAQ,CAAa;YACrB,kBAAY,GAAZ,YAAY,CAAc;YASpC,cAAQ,GAAG,KAAK,CAAC;;SANhB;QAcD,iCAAQ,GAAR;YACE,IAAI,CAAC,QAAQ,GAAG,IAAIL,iBAAW,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YAC1D,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAElD,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,KAAK,CAAC,iBAAiB,IAAI,EAAE,CAAC;YAC5D,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,KAAK,CAAC,mBAAmB,IAAI,EAAE,CAAC;YAChE,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YAC3E,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;SAC5E;QAED,mCAAU,GAAV,UAAW,OAAiC,EAAE,OAAmC;YAAtE,wBAAA,EAAA,yBAAiC;YAAE,wBAAA,EAAA,2BAAmC;YAC/E,IAAI,CAAC,QAAQ,CAAC,IAAI,CAChB,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,OAAO,CAAC,EACjC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,OAAO,CAAC,EACjC;gBACE,UAAU,EAAE,iBAAiB;gBAC7B,QAAQ,EAAE,IAAI;aACf,CACF,CAAC;SACH;QAED,uCAAc,GAAd;YACE,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;SACnC;QAED,mCAAU,GAAV,UAAW,KAAY;YAAvB,iBA0CC;YAzCC,IAAM,EAAE,GAAG,KAAK,CAAC,MAA0B,CAAC;YAC5C,IAAM,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,KAAiB,CAAC,CAAC,CAAC,CAAS,CAAC;YAE1D,MAAM,CAAC,cAAc,CAAC,KAAK,EAAE,MAAM,EAAE;gBACnC,QAAQ,EAAE,IAAI;gBACd,KAAK,EAAE,cAAc,CAAC,KAAK,CAAC,IAAI,CAAC;aAClC,CAAC,CAAC;YAEH,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE;gBACnF,IAAI,CAAC,UAAU,CAAC,qCAAqC,CAAC,CAAC;gBACvD,OAAOtB,eAAU,CAAC,sBAAsB,CAAC,CAAC;aAC3C;YAED,IAAI,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;gBACjD,IAAI,CAAC,UAAU,CAAC,uCAAuC,CAAC,CAAC;gBACzD,OAAOA,eAAU,CAAC,wBAAwB,CAAC,CAAC;aAC7C;YAED,IAAI,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC,YAAY,EAAE;gBAClC,IAAI,CAAC,UAAU,CAAC,2BAA2B,CAAC,CAAC;gBAC7C,OAAOA,eAAU,CAAC,kCAAkC,CAAC,CAAC;aACvD;YAED,IAAI,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC,YAAY,IAAI,CAAC,CAAC,IAAI,CAAC,YAAY,EAAE;gBACzD,IAAI,CAAC,UAAU,CAAC,4BAA4B,CAAC,CAAC;gBAC9C,OAAOA,eAAU,CAAC,8BAA8B,CAAC,CAAC;aACnD;YAED,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YACnB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACrB,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YAExC,IAAM,MAAM,GAAG,IAAI,UAAU,EAAE,CAAC;YAChC,MAAM,CAAC,MAAM,GAAG;gBACd,KAAI,CAAC,QAAQ,GAAG,KAAI,CAAC,YAAY,CAAC,8BAA8B,CAC9D,MAAM,CAAC,MAAgB,CACxB,CAAC;gBACF,KAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;aAC1B,CAAC;YACF,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACjC,EAAE,CAAC,KAAK,GAAG,EAAE,CAAC;SACf;QAED,+BAAM,GAAN;YACE,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;YAC3B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;YAClB,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;YACtB,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;SAC1B;QAED,6BAAI,GAAJ,UAAK,QAAgB,EAAE,UAAkB;YAAzC,iBAkCC;YAjCC,IAAI,IAAI,CAAC,KAAK,EAAE;gBACd,IAAI,IAAI,CAAC,QAAQ,CAAC,KAAK,IAAI,IAAI,CAAC,QAAQ,CAAC,KAAK,KAAK,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE;oBAClE,OAAOe,OAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,IAAI,CACjCjB,aAAG,CAAC,cAAM,OAAA,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAA,CAAC,CAC5D,CAAC;iBACH;qBAAM;oBAEL,IAAM,IAAI,GAAG;wBACX,QAAQ;wBACR,UAAU;wBACV,IAAI,CAAC,KAAK,CAAC,IAAI;qBAChB;yBACE,IAAI,CAAC,GAAG,CAAC,CAAC;oBAEb,OAAO4B,SAAI,CACT,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,EAAE;wBACpC,WAAW,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI;wBAC5B,cAAc,kBACZ,QAAQ,UAAA;4BACR,UAAU,YAAA,KACN,IAAI,CAAC,KAAK,CAAC,eAAe;4BAC5B,qBAAqB,CAAC,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,EACpD;qBACF,CAAC,CACH,CAAC,IAAI,CACJR,mBAAS,CAAC,UAAC,GAAQ,IAAK,OAAA,GAAG,CAAC,GAAG,CAAC,cAAc,EAAE,GAAA,CAAC,EACjDpB,aAAG,CAAC,UAAA,GAAG,IAAI,OAAA,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAA,CAAC,CAC7C,CAAC;iBACH;aACF;iBAAM;gBACL,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;gBACjD,OAAOiB,OAAE,CAAC,EAAE,CAAC,CAAC;aACf;SACF;;KAxIH,CAAoC,cAAyB;;gBAN5DP,cAAS,SAAC;oBACT,QAAQ,EAAE,UAAU;oBACpB,kuCAAqC;oBAErC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;gDAIIH,WAAM,SAAC,cAAc;gBAxBlB,cAAc;gBAXWgB,sBAAiB;gBAQ1C,kBAAkB;gBAJlBvB,0BAAgB;gBAFhBC,oBAAW;gBACXiC,4BAAY;;;yBA2CjBT,cAAS,SAAC,MAAM,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC;;;;QC3BC,kCAAyB;QAA7D;;;QAKE,iCAAQ,GAAR;YACE,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;YAC5C,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;SAC7C;;KARH,CAAoC,cAAyB;;gBAN5DnB,cAAS,SAAC;oBACT,QAAQ,EAAE,UAAU;oBACpB,4oDAAqC;oBAErC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;;QCHmC,kCAAyB;QAA7D;;;;KAAA,CAAoC,cAAyB;;gBAN5DJ,cAAS,SAAC;oBACT,QAAQ,EAAE,UAAU;oBACpB,yhBAAqC;oBAErC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;;QCMmC,kCAAyB;QAQ3D,wBACiC,KAAgB,EACvC,GAAsB,EACtB,kBAAsC;YAHhD,YAKE,kBAAM,KAAK,CAAC,SACb;YALgC,WAAK,GAAL,KAAK,CAAW;YACvC,SAAG,GAAH,GAAG,CAAmB;YACtB,wBAAkB,GAAlB,kBAAkB,CAAoB;;SAG/C;QAED,iCAAQ,GAAR;YACE,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAElD,IAAI,CAAC,GAAG,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC;YACzC,IAAI,CAAC,GAAG,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;YACtD,IAAI,CAAC,YAAY,GAAG,oBAAoB,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;YAE7D,IAAI,CAAC,KAAK,GAAG,IAAIU,iBAAW,CAC1B,EAAC,KAAK,EAAE,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,KAAK,IAAI,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,EAAC,EACnF,CAACC,gBAAU,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CACtC,CAAC;YAEF,IAAI,CAAC,GAAG,GAAG,IAAID,iBAAW,CACxB,EAAC,KAAK,EAAE,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,GAAG,IAAI,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,EAAC,EACjF,CAACC,gBAAU,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,CACnD,CAAC;SACH;QAED,6BAAI,GAAJ;YAAA,iBAQC;YAPC,OAAOR,OAAE,CAAC,EAAE,CAAC,CAAC,IAAI,CAChBjB,aAAG,CAAC;gBACF,IAAM,KAAK,GAAG,KAAI,CAAC,KAAK,CAAC,KAAK,CAAC;gBAC/B,IAAM,GAAG,GAAG,KAAI,CAAC,GAAG,CAAC,KAAK,CAAC;gBAC3B,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAC,KAAK,OAAA,EAAE,GAAG,KAAA,EAAC,CAAC,CAAC;aAC3C,CAAC,CACH,CAAC;SACH;;KA1CH,CAAoC,cAAyB;;gBAL5DU,cAAS,SAAC;oBACT,QAAQ,EAAE,UAAU;oBACpB,yyBAAqC;;iBAEtC;;;gDAUIC,WAAM,SAAC,cAAc;gBA7BlBgB,sBAAiB;gBAKjB,kBAAkB;;;QCHb,kBAAkB,GAAG,IAAIrB,mBAAc,CAAK,oBAAoB;;aCF7D,aAAa,CAC3B,KAAU,EACV,GAAa;QADb,sBAAA,EAAA,UAAU;QACV,oBAAA,EAAA,QAAa;QAGb,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;YACzB,OAAO,GAAG,CAAC,KAAK,CAAC,CAAC;SACnB;aAAM;YAEL,IAAM,MAAM,GAAG,IAAI,MAAM,CAAC,WAAW,CAAC,CAAC;YAEvC,OAAO,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;gBACzB,KAAK,GAAG,KAAK,CAAC,OAAO,CACnB,MAAM,EACN,CAAC,MAAM,CAAC,EAAE;qBACP,KAAK,CAAC,GAAG,CAAC;qBACV,MAAM,CAAC,UAAC,GAAG,EAAE,GAAG,IACb,OAAA,GAAG,CAAC,GAAG,CAAC,GAAA,EACV,GAAG,CACJ,CACJ,CAAC;aACH;YAED,OAAO,KAAK,CAAC;SACd;IACH;;QCvBa,IAAI,GAAG,IAAIA,mBAAc,CAAK,MAAM;;;QCkEZ,mCAA0B;QAK7D,yBACiC,KAAiB,EACxC,SAAoB,EAEpB,IAAY,EAGZ,iBAAsB;YAPhC,YASE,kBAAM,KAAK,CAAC,SACb;YATgC,WAAK,GAAL,KAAK,CAAY;YACxC,eAAS,GAAT,SAAS,CAAW;YAEpB,UAAI,GAAJ,IAAI,CAAQ;YAGZ,uBAAiB,GAAjB,iBAAiB,CAAK;YAThC,cAAQ,GAAG,IAAIa,oBAAe,CAAC,IAAI,CAAC,CAAC;;SAYpC;QAED,kCAAQ,GAAR;YAAA,iBAgHC;YA/GC,IAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;gBAEvB,IAAM,UAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,QAAoB,CAAC;gBAEjD,IAAM,YAAU,GAAG,UAAQ,CAAC,UAAU,GAAG,QAAQ,CAAC,UAAQ,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC;gBAC9E,IAAM,iBAAe,GAAG,UACtB,KAIC;oBAGD,KAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oBAEzB,IAAI,CAAC,KAAK,EAAE;wBACV,KAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;wBAC1B,OAAOF,OAAE,CAAC,EAAE,CAAC,CAAC;qBACf;oBAED,IAAI,KAAK,CAAC,MAAM,IAAI,OAAO,KAAK,CAAC,MAAM,KAAK,QAAQ,EAAE;wBACpD,OAAO,KAAI,CAAC,SAAS,CAAC,WAAW,CAC/B,KAAK,CAAC,UAAU,EAChB,KAAK,CAAC,MAAM,CACb;6BACE,IAAI,CACHC,aAAG,CAAC,UAAA,EAAE;4BACJ,OAAO,CAAC,YAAU,GAAG,YAAU,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,UAAC,GAAQ,IAAK,QAAC;gCAC7D,KAAK,EAAE,GAAG,CAAC,UAAQ,CAAC,QAAQ,IAAI,IAAI,CAAC;gCACrC,IAAI,EAAE,aAAa,CACjB,UAAQ,CAAC,OAAO,IAAI,MAAM,EAC1B,GAAG,CACJ;6BACF,IAAC,CAAC,CAAC;yBACL,CAAC,EACFlB,aAAG,CAAC,cAAM,OAAA,KAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,GAAA,CAAC,CACrC,CAAC;qBACL;oBAED,OAAO,KAAI,CAAC,SAAS;yBAClB,kBAAkB,CACjB,KAAK,CAAC,UAAU,EAChB,KAAK,CAAC,OAAO,EACb,KAAK,CAAC,MAAqB,CAC5B;yBACA,IAAI,CACHkB,aAAG,CAAC,UAAA,IAAI;wBACN,IAAI,YAAU,EAAE;4BACd,IAAI,GAAG,YAAU,CAAC,IAAI,EAAE;gCACtB,SAAS,EAAE,KAAI,CAAC,KAAK;gCACrB,KAAK,EAAE,KAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,EAAE;gCACpC,IAAI,EAAE,KAAI,CAAC,IAAI;gCACf,iBAAiB,EAAE,KAAI,CAAC,iBAAiB;6BAC1C,CAAC,CAAC;yBACJ;wBAED,OAAO,IAAI,CAAC,GAAG,CAAC,UAAA,GAAG,IAAI,QAAC;4BACtB,KAAK,EAAE,GAAG,CAAC,UAAQ,CAAC,QAAQ,IAAI,IAAI,CAAC;4BACrC,IAAI,EAAE,aAAa,CACjB,UAAQ,CAAC,OAAO,IAAI,MAAM,EAC1B,GAAG,CACJ;yBACF,IAAC,CAAC,CAAC;qBACL,CAAC,EACFlB,aAAG,CAAC,cAAM,OAAA,KAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,GAAA,CAAC,CACrC,CAAC;iBACL,CAAC;gBAEF,IAAI,UAAQ,CAAC,UAAU,EAAE;oBAEvB,IAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,UAAQ,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;oBAC7D,IAAM,IAAE,GAAG,QAAQ,CAAC,UAAQ,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;oBAEhD,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,OAAO,CAAC,YAAY;yBACzC,IAAI,CACHqB,mBAAS,CACP,OAAO,CAAC,OAAO,CAAC,KAAK,CACtB,EACDD,mBAAS,CAAC,UAAA,KAAK,IACb,OAAA,iBAAe,CACb,IAAE,CAAC,KAAK,EAAE;wBACR,SAAS,EAAE,KAAI,CAAC,KAAK;wBACrB,KAAK,EAAE,KAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,EAAE;wBACpC,IAAI,EAAE,KAAI,CAAC,IAAI;wBACf,iBAAiB,EAAE,KAAI,CAAC,iBAAiB;qBAC1C,CAAC,CACH,GAAA,CACF,CACF,CAAC;iBACL;qBAAM;oBAEL,IAAI,MAAM,GAAgB,UAAQ,CAAC,MAAqB,CAAC;oBAEzD,IAAI,UAAQ,CAAC,aAAa,EAAE;wBAC1B,MAAM,GAAG,QAAQ,CAAC,UAAQ,CAAC,aAAa,CAAC,CAAC;4BACxC,SAAS,EAAE,IAAI,CAAC,KAAK;4BACrB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,EAAE;4BACpC,IAAI,EAAE,IAAI,CAAC,IAAI;4BACf,iBAAiB,EAAE,IAAI,CAAC,iBAAiB;yBAC1C,CAAC,CAAC;qBACJ;oBAED,IAAI,CAAC,QAAQ,GAAG,iBAAe,CAAC;wBAC9B,UAAU,EAAE,UAAQ,CAAC,UAAU;wBAC/B,OAAO,EAAE,UAAQ,CAAC,OAAO;wBACzB,MAAM,QAAA;qBACA,CAAC,CAAC;iBACX;aACF;iBAAM;gBACL,IAAI,CAAC,QAAQ,GAAGH,OAAE,CAAC,IAAI,CAAC,KAAK,CAAC,OAAc,CAAC,CAAC;aAC/C;SACF;;KAjIH,CAAqC,cAA0B;;gBAN9DP,cAAS,SAAC;oBACT,QAAQ,EAAE,WAAW;oBACrB,0wBAAsC;oBAEtC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;gDAOIH,WAAM,SAAC,cAAc;gBAnElB,SAAS;6CAqEZA,WAAM,SAAC,IAAI;gDAEXqB,aAAQ,YACRrB,WAAM,SAAC,kBAAkB;;;;QC1DO,mCAA0B;QAA/D;;;QAKE,kCAAQ,GAAR;YACE,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM;kBAC5B,IAAI,CAAC,KAAK,CAAC,MAAM;kBACjB,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,OAAO;sBAC7B,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,OAAO;sBAC7B,CAAC,CAAC;YACN,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK;kBACzB,IAAI,CAAC,KAAK,CAAC,KAAK;kBAChB,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,OAAO;sBAC7B,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,OAAO;sBAC7B,GAAG,CAAC;SACT;;KAhBH,CAAqC,cAA0B;;gBAN9DD,cAAS,SAAC;oBACT,QAAQ,EAAE,WAAW;oBACrB,gdAAsC;oBAEtC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;;QCAsC,qCAA4B;QAAnE;;;QAKE,oCAAQ,GAAR;YACE,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;YAC5C,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;SAC7C;;KARH,CAAuC,cAA4B;;gBANlEJ,cAAS,SAAC;oBACT,QAAQ,EAAE,aAAa;oBACvB,0rBAAwC;oBAExC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;;QCToC,mCAAyB;QAA9D;;;;KAAA,CAAqC,cAAyB;;gBAN7DJ,cAAS,SAAC;oBACT,QAAQ,EAAE,WAAW;oBACrB,qVAAsC;oBAEtC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;;QCmCqC,oCAA2B;QAE/D,0BACiC,KAAkB,EACzC,EAAe,EACf,MAAiB,EACjB,OAAuB,EACvB,oBAA0C;YALpD,YAOE,kBAAM,KAAK,CAAC,SACb;YAPgC,WAAK,GAAL,KAAK,CAAa;YACzC,QAAE,GAAF,EAAE,CAAa;YACf,YAAM,GAAN,MAAM,CAAW;YACjB,aAAO,GAAP,OAAO,CAAgB;YACvB,0BAAoB,GAApB,oBAAoB,CAAsB;YAapD,eAAS,GAAG;gBACV,SAAS,EAAE,IAAI;gBACf,kBAAkB,EAAE,IAAI;gBACxB,mBAAmB,EAAE,KAAK;gBAC1B,KAAK,EAAE,MAAM;aACd,CAAC;;SAfD;QAiBD,mCAAQ,GAAR;YAAA,iBAaC;YAZC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,EAAE,CAAC,KAAK,iBACzB,KAAK,EAAE,CAAC,EAAE,EAAEW,gBAAU,CAAC,QAAQ,CAAC,IAC7B,IAAI,CAAC,SAAS,EACjB,CAAC;YAEH,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,aAAa,CAAC,SAAS,CAAC,UAAA,KAAK;gBAC9C,IAAI,KAAK,KAAK,UAAU,EAAE;oBACxB,OAAO,CAAC,YAAY,CAAC,OAAO,EAAE,CAAC,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;iBAC/D;qBAAM,IAAI,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,EAAE;oBACtC,OAAO,CAAC,YAAY,CAAC,OAAO,EAAE,CAAC,YAAY,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;iBAChE;aACF,CAAC,CAAC;SACJ;QAED,0CAAe,GAAf;YACE,IAAI,CAAC,YAAY,EAAE,CAAC;SACrB;QAEO,uCAAY,GAAZ;YAAA,iBAsGP;YArGC,OAAO,CAAC,IAAI,CAAC;gBACX,MAAM,EAAE,IAAI,CAAC,QAAQ,CAAC,aAAa;gBACnC,QAAQ,EAAE,KAAK;gBACf,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,GAAG;gBAChC,OAAO,EAAE;oBACP,MAAM;oBACN,OAAO;oBACP,WAAW;oBACX,MAAM;oBACN,OAAO;oBACP,SAAS;oBACT,UAAU;oBACV,OAAO;oBACP,YAAY;oBACZ,YAAY;oBACZ,OAAO;iBACR;gBACD,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,IAAI,0CAA0C;gBACzE,YAAY,EAAE,IAAI;;;;gBAKlB,mBAAmB,EAAE,QAAQ;gBAC7B,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ;gBACrC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,IAAI;oBAC7B,WAAW;oBACX,QAAQ;oBACR,aAAa;oBACb,aAAa;oBACb,qBAAqB;oBACrB,+CAA+C;oBAC/C,gCAAgC;oBAChC,MAAM;oBACN,OAAO;oBACP,SAAS;oBACT,YAAY;iBACb,CAAC,IAAI,CAAC,KAAK,CAAC;gBAEb,qBAAqB,EAAE,UAAC,QAAa,EAAE,OAAY,EAAE,OAAY;oBAC/D,KAAI,CAAC,OAAO;yBACT,MAAM,CACL,QAAQ,CAAC,QAAQ,EAAE,EACnB,QAAQ,CAAC,IAAI,EAAE,EACf,KAAI,CAAC,oBAAoB,CAAC,EAAE,GAAG;wBAC7B,cAAc,EAAE;4BACd,UAAU,EAAE,KAAI,CAAC,oBAAoB,CAAC,EAAE;yBACzC;qBACF,GAAG,EAAE,CACP;yBACA,IAAI,CAAC,UAAC,IAAS,IAAK,OAAA,IAAI,CAAC,GAAG,CAAC,cAAc,EAAE,GAAA,CAAC;yBAC9C,IAAI,CAAC,UAAC,GAAQ,IAAK,OAAA,OAAO,CAAC,GAAG,CAAC,GAAA,CAAC;yBAChC,KAAK,CAAC,UAAC,KAAU,IAAK,OAAA,OAAO,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,GAAA,CAAC,CAAC;iBACrD;gBAED,KAAK,EAAE,UAAC,MAAW;oBACjB,KAAI,CAAC,MAAM,GAAG,MAAM,CAAC;oBAErB,MAAM,CAAC,EAAE,CAAC,cAAc,EAAE;wBACxB,IAAM,WAAW,GAAG,MAAM,CAAC,UAAU,EAAE,CAAC;wBACxC,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;qBAC1C,CAAC,CAAC;oBAEH,MAAM,CAAC,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,SAAS,EAAE;wBACtC,IAAI,EAAE,QAAQ;wBACd,IAAI,EAAE,OAAO;wBACb,OAAO,EAAE,qBAAqB;wBAC9B,QAAQ,EAAE;4BACR,KAAI,CAAC,MAAM,CAAC,KAAK,CAAC,KAAI,CAAC,SAAS,CAAC,CAAC;4BAClC,KAAI,CAAC,MAAM;iCACR,IAAI,CAAC,KAAI,CAAC,qBAAqB,EAAE,EAAC,KAAK,EAAE,OAAO,EAAC,CAAC;iCAClD,WAAW,EAAE;iCACb,IAAI,CACHc,gBAAM,CAAC,UAAA,KAAK,IAAI,OAAA,CAAC,CAAC,KAAK,GAAA,CAAC,EACxBC,cAAI,CAAC,CAAC,CAAC,CACR;iCACA,SAAS,CAAC;gCACT,IAAM,IAAI,GAAG,KAAI,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC;gCACvC,IAAI,GAAG,GAAG,IAAI,CAAC,mBAAmB;sCAC9B,yCAAyC;sCACzC,gCAAgC,CAAC;gCAErC,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC;gCAEvB,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE;oCAC5B,IAAI,CAAC,KAAK,IAAI,aAAa,CAAC;iCAC7B;gCAED,IAAM,MAAM,GAAG,gDAAyC,GAAG,0JACmD,CAAC;gCAE/G,MAAM,CAAC,aAAa,CAClB,IAAI,CAAC,SAAS;sCACV,iDAA4C,IAAI,CAAC,KAAK,WAAK,MAAM,WAAQ;sCACzE,8BAA2B,IAAI,CAAC,KAAK,WAAK,MAAM,WAAQ,CAC7D,CAAC;6BACH,CAAC,CAAC;yBACN;qBACF,CAAC,CAAC;iBACJ;aACF,CAAC,CAAC;SACJ;;KApJH,CAAsC,cAA2B;;gBANhE9B,cAAS,SAAC;oBACT,QAAQ,EAAE,YAAY;oBACtB,glEAAuC;oBAEvC,eAAe,EAAEI,4BAAuB,CAAC,MAAM;;iBAChD;;;gDAIIH,WAAM,SAAC,cAAc;gBArClB8B,iBAAW;gBACXR,gBAAS;gBAgBT,cAAc;gBAFd,oBAAoB;;;2BA+BzBJ,cAAS,SAAC,UAAU,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC;wCAGpCA,cAAS,SAAC,eAAe,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC;;;;ICxCrC,IAAM,4BAA4B;QACvCa,KAAC1B,qBAAa,CAAC,KAAK,IAAG,cAAc;QACrC0B,KAAC1B,qBAAa,CAAC,MAAM,IAAG,eAAe;QACvC0B,KAAC1B,qBAAa,CAAC,MAAM,IAAG,eAAe;QACvC0B,KAAC1B,qBAAa,CAAC,IAAI,IAAG,aAAa;QACnC0B,KAAC1B,qBAAa,CAAC,KAAK,IAAG,cAAc;QACrC0B,KAAC1B,qBAAa,CAAC,OAAO,IAAG,gBAAgB;QACzC0B,KAAC1B,qBAAa,CAAC,QAAQ,IAAG,iBAAiB;QAC3C0B,KAAC1B,qBAAa,CAAC,YAAY,IAAG,qBAAqB;QACnD0B,KAAC1B,qBAAa,CAAC,IAAI,IAAG,kBAAkB;QACxC0B,KAAC1B,qBAAa,CAAC,KAAK,IAAG,cAAc;QACrC0B,KAAC1B,qBAAa,CAAC,MAAM,IAAG,eAAe;QACvC0B,KAAC1B,qBAAa,CAAC,OAAO,IAAG,gBAAgB;QACzC0B,KAAC1B,qBAAa,CAAC,SAAS,IAAG,sBAAsB;QACjD0B,KAAC1B,qBAAa,CAAC,KAAK,IAAG,cAAc;QACrC0B,KAAC1B,qBAAa,CAAC,KAAK,IAAG,cAAc;QACrC0B,KAAC1B,qBAAa,CAAC,QAAQ,IAAG,iBAAiB;aAC5C;;ICpCD,WAAY,UAAU;QACpB,+BAAiB,CAAA;QACjB,6BAAe,CAAA;;QAGf,+BAAiB,CAAA;QACjB,+BAAiB,CAAA;QACjB,iCAAmB,CAAA;QACnB,iCAAmB,CAAA;QACnB,2BAAa,CAAA;IACf,CAAC,EAVW2B,kBAAU,KAAVA,kBAAU;;ICEtB;IACA;QAAA;SAMC;QALQ,2BAAU,GAAjB,UAAkB,GAAW;YAC3B,OAAO,UAAC,OAAwB;gBAC9B,OAAO,OAAO,CAAC,KAAK,GAAG,GAAG,KAAK,CAAC,GAAG,IAAI,GAAG,EAAC,UAAU,EAAE,GAAG,EAAC,CAAC;aAC7D,CAAC;SACH;+BACF;KAAA;;aCNe,iBAAiB,CAAC,UAAsB;QACtD,QAAQ,UAAU;YAChB,KAAKA,kBAAU,CAAC,MAAM;gBACpB,OAAO;oBACL,IAAI,EAAE3B,qBAAa,CAAC,KAAK;oBACzB,aAAa,EAAE;wBACb,IAAI,EAAE,MAAM;qBACb;iBACF,CAAC;YAEJ,KAAK2B,kBAAU,CAAC,MAAM,CAAC;YACvB,KAAKA,kBAAU,CAAC,OAAO;gBACrB,OAAO;oBACL,IAAI,EAAE3B,qBAAa,CAAC,KAAK;oBACzB,aAAa,EAAE;wBACb,IAAI,EAAE,QAAQ;qBACf;iBACF,CAAC;YAEJ,KAAK2B,kBAAU,CAAC,OAAO;gBACrB,OAAO;oBACL,IAAI,EAAE3B,qBAAa,CAAC,QAAQ;iBAC7B,CAAC;YAEJ,KAAK2B,kBAAU,CAAC,KAAK;gBACnB,OAAO;oBACL,IAAI,EAAE3B,qBAAa,CAAC,KAAK;iBAC1B,CAAC;SACL;IACH;;IC8CA;;QAEE,gBACS,MAAW,EACX,QAAkB,EAClB,KAAY,EACZ,IAAY,EACZ,WAA6B,EAC7B,YAA+B;YAD/B,4BAAA,EAAA,gBAA6B;YAC7B,6BAAA,EAAA,iBAA+B;YAL/B,WAAM,GAAN,MAAM,CAAK;YACX,aAAQ,GAAR,QAAQ,CAAU;YAClB,UAAK,GAAL,KAAK,CAAO;YACZ,SAAI,GAAJ,IAAI,CAAQ;YACZ,gBAAW,GAAX,WAAW,CAAkB;YAC7B,iBAAY,GAAZ,YAAY,CAAmB;YAIxC,aAAQ,GAAa,EAAE,CAAC;SAHpB;QAKG,qBAAc,GAArB,UAAsB,GAAW;YAC/B,IAAI,GAAG,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;gBAClB,GAAG,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE,GAAG,CAAC,MAAM,CAAC,CAAC;aAChC;YAED,OAAO,GAAG,CAAC;SACZ;QAEM,oBAAa,GAApB,UACE,UAAoC,EACpC,QAAiB;YAEjB,IAAM,iBAAiB,GAAU,EAAE,CAAC;YACpC,IAAM,UAAU,GAAQ,EAAE,CAAC;YAE3B,IAAI,QAAQ,EAAE;gBACZ,iBAAiB,CAAC,IAAI,CAACS,gBAAU,CAAC,QAAQ,CAAC,CAAC;gBAC5C,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC;aAC5B;YAED,IAAI,UAAU,CAAC,SAAS,EAAE;gBACxB,iBAAiB,CAAC,IAAI,CAACA,gBAAU,CAAC,SAAS,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC;gBACnE,UAAU,CAAC,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC;aAC7C;YAED,IAAI,UAAU,CAAC,SAAS,EAAE;gBACxB,iBAAiB,CAAC,IAAI,CAACA,gBAAU,CAAC,SAAS,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC;gBACnE,UAAU,CAAC,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC;aAC7C;YAED,IAAI,UAAU,CAAC,OAAO,EAAE;gBACtB,iBAAiB,CAAC,IAAI,CAACA,gBAAU,CAAC,OAAO,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC;gBAC/D,UAAU,CAAC,MAAM,GAAG,UAAU,CAAC,OAAO,CAAC;aACxC;YAED,OAAO;gBACL,OAAO,EAAE,IAAID,iBAAW,CAAC,UAAU,CAAC,OAAO,IAAI,EAAE,EAAE,iBAAiB,CAAC;gBACrE,UAAU,YAAA;aACX,CAAC;SACH;QAEM,oBAAa,GAApB,UACE,UAAoC,EACpC,QAAiB;YAEjB,IAAM,UAAU,GAAQ,EAAE,CAAC;YAC3B,IAAM,iBAAiB,GAAU,EAAE,CAAC;YAEpC,IAAI,QAAQ,EAAE;gBACZ,iBAAiB,CAAC,IAAI,CAACC,gBAAU,CAAC,QAAQ,CAAC,CAAC;gBAC5C,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC;aAC5B;YAED,IAAI,UAAU,CAAC,OAAO,EAAE;gBACtB,IAAM,OAAO,GACX,UAAU,CAAC,OAAO,IAAI,UAAU,CAAC,gBAAgB,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;gBAC7D,iBAAiB,CAAC,IAAI,CAACA,gBAAU,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC;gBAChD,UAAU,CAAC,OAAO,GAAG,OAAO,CAAC;aAC9B;YAED,IAAI,UAAU,CAAC,OAAO,EAAE;gBACtB,IAAM,OAAO,GACX,UAAU,CAAC,OAAO,IAAI,UAAU,CAAC,gBAAgB,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;gBAC7D,iBAAiB,CAAC,IAAI,CAACA,gBAAU,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC;gBAChD,UAAU,CAAC,OAAO,GAAG,OAAO,CAAC;aAC9B;YAED,IAAI,UAAU,CAAC,UAAU,EAAE;gBACzB,iBAAiB,CAAC,IAAI,CACpB,gBAAgB,CAAC,UAAU,CAAC,UAAU,CAAC,UAAU,CAAC,CACnD,CAAC;gBACF,UAAU,CAAC,UAAU,GAAG,UAAU,CAAC,UAAU,CAAC;aAC/C;YAED,OAAO;gBACL,OAAO,EAAE,IAAID,iBAAW,CAAC,UAAU,CAAC,OAAO,IAAI,IAAI,EAAE,iBAAiB,CAAC;gBACvE,UAAU,YAAA;aACX,CAAC;SACH;QAEM,qBAAc,GAArB,UACE,UAAqC,EACrC,QAAiB;YAEjB,IAAM,iBAAiB,GAAU,EAAE,CAAC;YACpC,IAAM,UAAU,GAAQ,EAAE,CAAC;YAE3B,IAAI,QAAQ,EAAE;gBACZ,iBAAiB,CAAC,IAAI,CAACC,gBAAU,CAAC,QAAQ,CAAC,CAAC;gBAC5C,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC;aAC5B;YAED,OAAO;gBACL,OAAO,EAAE,IAAID,iBAAW,CAAC,UAAU,CAAC,OAAO,IAAI,KAAK,EAAE,iBAAiB,CAAC;gBACxE,UAAU,YAAA;aACX,CAAC;SACH;QAED,0BAAS,GAAT,UACE,KAAW,EACX,QAAuB,EACvB,IAAU,EACV,KAAY;YAFZ,yBAAA,EAAA,aAAuB;YACvB,qBAAA,EAAA,UAAU;YACV,sBAAA,EAAA,YAAY;YAEZ,IAAM,UAAU,GAAG,IAAI,CAAC,eAAe,CACrC,IAAI,CAAC,MAAM,CAAC,UAAU,IAAI,EAAE,EAC5B,QAAQ,EACR,IAAI,EACJ,KAAK,CACN,CAAC;YAEF,IAAI,CAAC,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC;YAC5B,IAAI,CAAC,QAAQ,GAAG,UAAU,CAAC,QAAQ,CAAC;YAEpC,IAAI,KAAK,EAAE;gBACT,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;aAC7B;YAED,OAAO,IAAI,CAAC,IAAI,CAAC;SAClB;QAED,gCAAe,GAAf,UACE,UAAkB,EAClB,QAAuB,EACvB,IAAU,EACV,KAAY;YAJd,iBA+GC;YA7GC,yBAAA,EAAA,aAAuB;YACvB,qBAAA,EAAA,UAAU;YACV,sBAAA,EAAA,YAAY;YAEN,IAAA,KAAmB,SACpB,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,GAKzB,KAAK;kBACL;oBACE;wBACE,IAAI;wBACJ;4BACE,IAAI,EAAE,QAAQ;yBACf;qBACF;iBACF;kBACD,EAAE,GACN,MAAM,CACN,UAAC,KAAK,EAAE,EAA2B;oBAA3B,KAAA,aAA2B,EAA1B,GAAG,QAAA,EAAE,KAAK,QAAA;gBACjB,IAAM,UAAU,GAAG,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;gBAE1C,IAAI,MAMH,CAAC;gBAEF,QAAQ,KAAK,CAAC,IAAI;oBAChB,KAAKmB,kBAAU,CAAC,MAAM;wBACpB,MAAM,GAAG,MAAM,CAAC,aAAa,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;wBACjD,MAAM;oBAER,KAAKA,kBAAU,CAAC,MAAM,CAAC;oBACvB,KAAKA,kBAAU,CAAC,OAAO;wBACrB,MAAM,GAAG,MAAM,CAAC,aAAa,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;wBACjD,MAAM;oBAER,KAAKA,kBAAU,CAAC,OAAO;wBACrB,MAAM,GAAG,MAAM,CAAC,cAAc,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;wBAClD,MAAM;oBAER,KAAKA,kBAAU,CAAC,MAAM;wBACpB,IAAM,gBAAgB,GAAG,KAAI,CAAC,eAAe;;;;;wBAK3C,KAAK,CAAC,UAAU,KAAK,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,CAAC,UAAU,GAAG,KAAK,CAAC,KAAK,CAAC,UAAU,GAAG,EAAE,CAAC,EACzF,KAAK,CAAC,QAAQ,IAAI,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,KAAK,CAAC,QAAQ,GAAG,EAAE,EACjF,IAAI,GAAG,GAAG,GAAG,GAAG,EAChB,KAAK,CACN,CAAC;wBAEF,KAAK,IAAM,KAAK,IAAI,gBAAgB,CAAC,QAAQ,EAAE;4BAC7C,IAAI,gBAAgB,CAAC,QAAQ,CAAC,cAAc,CAAC,KAAK,CAAC,EAAE;;gCAEnD,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,gBAAgB,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;6BAC1D;yBACF;wBAED,MAAM,GAAG;4BACP,OAAO,EAAE,gBAAgB,CAAC,IAAI;4BAC9B,UAAU,EAAE,EAAE;yBACf,CAAC;wBACF,MAAM;oBAER,KAAKA,kBAAU,CAAC,KAAK;wBACnB,MAAM,GAAG,KAAI,CAAC,UAAU,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;wBACtC,MAAM;iBACT;gBAED,IAAM,UAAU,GAAG,IAAI,GAAG,GAAG,CAAC;gBAC9B,IAAM,UAAU,GAAG,KAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;;gBAG7D,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC;;gBAEjC,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,2EACxB,GAAG,KAAA,EACH,IAAI,EAAE,KAAK,CAAC,IAAI,IACb,UAAU,CAAC,YAAY;uBACrB,EAAC,YAAY,EAAE,QAAQ,CAAC,UAAU,CAAC,YAAY,CAAC,EAAC,GACnD,UAAU,CAAC,YAAY;uBACrB,EAAC,YAAY,EAAE,QAAQ,CAAC,UAAU,CAAC,YAAY,CAAC,EAAC,GACnD,UAAU,CAAC,cAAc;uBACvB,EAAC,cAAc,EAAE,QAAQ,CAAC,UAAU,CAAC,cAAc,CAAC,EAAC,GACvD,UAAU,CAAC,YAAY;uBACrB,EAAC,YAAY,EAAE,QAAQ,CAAC,UAAU,CAAC,YAAY,CAAC,EAAC,GAEnD,MAAM,CACV,CAAC;gBAEF,OAAO,KAAK,CAAC;aACd,EACD;gBACE,IAAI,EAAE,EAAE;gBACR,QAAQ,EAAE,EAAE;aACb,CACF,EAnGM,IAAI,UAAA,EAAE,QAAQ,cAmGpB,CAAC;YAEF,OAAO;gBACL,QAAQ,UAAA;gBACR,IAAI,EAAE,IAAIrB,eAAS,CAAC,IAAI,CAAC;aAC1B,CAAC;SACH;;;;;;;;QASD,sBAAK,GAAL,UACE,UAAkB,EAClB,OAAgB,EAChB,WAA6B,EAC7B,MAAa,EACb,SAAkB;YAFlB,4BAAA,EAAA,gBAA6B;YAC7B,uBAAA,EAAA,aAAa;YAIb,IAAI,CAAC,OAAO,EAAE;gBACZ,OAAO,CAAC,GAAG,CAAC,YAAY,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;gBACzC,MAAM,IAAI,KAAK,CAAC,+BAA6B,UAAU,MAAG,CAAC,CAAC;aAC7D;YAEM,IAAA,GAAG,GAA+B,OAAO,IAAtC,EAAE,IAAI,GAAyB,OAAO,KAAhC,EAAE,OAAO,GAAgB,OAAO,QAAvB,EAAE,UAAU,GAAI,OAAO,WAAX,CAAY;YACjD,IAAM,UAAU,mBACd,KAAK,EAAE,GAAG,IACP,IAAI,CAAC,kBAAkB,CAAC,UAAU,EAAE,WAAW,CAAC,CACpD,CAAC;YAEF,IACE,CACE,UAAU,CAAC,SAAS;iBAElB,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC,SAAS,CAAC;oBACjC,UAAU,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC;sBACvC,UAAU,CAAC,SAAS,KAAK,IAAI,CAAC,KAAK,CACxC;iBAGD,UAAU,CAAC,eAAe;qBAExB,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC,eAAe,CAAC;wBACvC,UAAU,CAAC,eAAe,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC;0BAC5C,UAAU,CAAC,eAAe,KAAK,IAAI,CAAC,IAAI,CAC7C,CACF,EACD;gBACA,OAAO,CAAC,OAAO,EAAE,CAAC;aACnB;;;;YAKD,IAAI,CAAC,MAAM,EAAE;gBACX,UAAU,CAAC,KAAK,GAAG,EAAE,CAAC;aACvB;YAED,IAAI,CAAC,UAAU,CAAC,SAAS,EAAE;gBACzB,UAAU,CAAC,SAAS,GAAG,iBAAiB,CAAC,IAAI,CAAC,CAAC;aAChD;;YAGD,IAAM,SAAS,GAAG,4BAA4B,CAAC,UAAU,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;YAE1H,IAAI,CAAC,SAAS,EAAE;;gBAEd,MAAM,IAAI,KAAK,CAAC,iDAA+C,UAAU,CAAC,SAAS,CAAC,IAAM,CAAC,CAAC;aAC7F;YAED,IAAMsB,QAAM,GAAG,IAAI7B,sBAAe,CAChC,SAAS,EACT,IAAI,EACJ,uBAAuB,CAAC,IAAI,CAAC,QAAQ,gCACnC,OAAO,SAAA;gBACP,UAAU,YAAA;gBACV,MAAM,QAAA,EACN,QAAQ,EAAE,IAAI,CAAC,QAAQ,EACvB,IAAI,EAAE,IAAI,CAAC,IAAI,IACZ,UAAU,IAET,UAAU,CAAC,SAAS,CAAC,aAAa,IAAI,EAAE,GAC5C,CACH,CAAC;YAEF,OAAO;gBACL,OAAO,EAAE,UAAU;gBACnB,OAAO,SAAA;gBACP,MAAM,UAAA;gBACN,UAAU,YAAA;gBACV,WAAW,EAAE,UAAU,CAAC,WAAW,IAAI,EAAE;gBACzC,KAAK,EAAE,UAAU,CAAC,KAAK;gBACvB,MAAM,EAAE,UAAU,CAAC,MAAM;aAC1B,CAAC;SACH;QAED,6BAAY,GAAZ,UACE,OAAe,EACf,SAAiB,EACjB,WAGC;YAJD,0BAAA,EAAA,iBAAiB;YAMjB,IAAM,QAAQ,GAAG,WAAW,GAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,OAAO,CAAS,CAAC,aAAa,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC;YAC5H,IAAM,MAAM,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;YACjC,IAAM,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC,OAAoB,CAAC;YAEvD,IACE,MAAM,CAAC,SAAS,KAAK4B,kBAAU,CAAC,KAAK;gBACrC,MAAM,CAAC,SAAS,KAAKA,kBAAU,CAAC,MAAM,EACtC;gBACA,IAAM,UAAU,GAAG,IAAI,CAAC,eAAe,CACrC,MAAM,CAAC,UAAU,EACjB,MAAM,CAAC,QAAQ,EACf,OAAO,GAAG,GAAG,EACb,KAAK,CACN,CAAC;gBAEF,IAAI,SAAS,EAAE;oBACb,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;iBACrC;;gBAED,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;gBAClD,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;gBAE1C,OAAO,UAAU,CAAC,QAAQ,CAAC;aAC5B;iBAAM;gBACL,IAAM,IAAI,GAAG,IAAInB,iBAAW,CAAC,EAAE,CAAC,CAAC;gBACjC,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAC/B,OAAO,IAAI,CAAC;aACb;SACF;QAED,8BAAa,GAAb,UACE,OAAe,EACf,SAAiB,EACjB,OAAe,EACf,WAGC;YAED,IAAM,QAAQ,GAAG,WAAW,GAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,OAAO,CAAS,CAAC,aAAa,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC;YAC5H,IAAM,MAAM,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;YACjC,IAAM,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC,OAAoB,CAAC;YAEvD,IACE,MAAM,CAAC,SAAS,KAAKmB,kBAAU,CAAC,KAAK;gBACrC,MAAM,CAAC,SAAS,KAAKA,kBAAU,CAAC,MAAM,EACtC;gBACAlC,wBAAe,CACb,MAAM,CAAC,aAAsB,EAC7B,SAAS,EACT,OAAO,CACR,CAAC;aACH;YAEDA,wBAAe,CACb,OAAO,CAAC,QAAQ,EAChB,SAAS,EACT,OAAO,CACR,CAAC;SACH;QAED,gCAAe,GAAf,UACE,OAAe,EACf,KAAa,EACb,WAGC;YAED,IAAM,QAAQ,GAAG,WAAW,GAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,OAAO,CAAS,CAAC,aAAa,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC;YAC5H,QAAQ,CAAC,OAAO,CAAC,CAAC,aAAa,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YAChD,QAAQ,CAAC,OAAO,CAAC,CAAC,OAAqB,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;SAC1D;QAED,0BAAS,GAAT,UAAU,QAAwB;YAAxB,yBAAA,EAAA,WAAW,IAAI,CAAC,QAAQ;YAChC,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,UAAA,KAAK;;;;;;;gBAOnC,IAAI,KAAK,CAAC,OAAO,YAAYe,iBAAW,IAAI,KAAK,CAAC,YAAY,EAAE;oBAC9D,IAAM,aAAa,GAAG,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;oBAE9D,IAAI,aAAa,KAAK,KAAK,CAAC,OAAO,CAAC,KAAK,EAAE;wBACzC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;qBACvC;iBACF;aACF,CAAC,CAAC;SACJ;QAED,6BAAY,GAAZ,UACE,YAAmB,EACnB,eAA4C,EAC5C,QAAwB;YAH1B,iBAyCC;YAvCC,gCAAA,EAAA,mBAAmBzB,aAAK,CAAC,MAAM,EAAEA,aAAK,CAAC,IAAI,CAAC;YAC5C,yBAAA,EAAA,WAAW,IAAI,CAAC,QAAQ;YAGxB,IAAM,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;YAE5C,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,UAAA,KAAK;;;;;;;gBAOnC,IAAI,KAAK,CAAC,OAAO,YAAYyB,iBAAW,EAAE;oBACxC,IAAI,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC;oBAEhC,IAAI,KAAK,CAAC,YAAY,EAAE;wBACtB,KAAK,GAAG,KAAK,CAAC,YAAY,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC;qBAChD;oBAED,IAAI,eAAe,CAAC,QAAQ,CAAC,YAAY,CAAC,EAAE;wBAC1C,IAAI,YAAY,KAAKzB,aAAK,CAAC,IAAI,IAAI,KAAK,CAAC,YAAY,EAAE;4BACrD,KAAK,GAAG,KAAK,CAAC,YAAY,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC;yBAChD;6BAAM,IAAI,KAAK,CAAC,cAAc,EAAE;4BAC/B,KAAK,GAAG,KAAK,CAAC,cAAc,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC;yBAClD;qBACF;oBAED,IAAI,KAAK,KAAK,KAAK,CAAC,OAAO,CAAC,KAAK,EAAE;wBACjC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;qBAC/B;iBACF;gBAED,IAAI,KAAK,CAAC,aAAa,EAAE;oBACvB,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,UAAA,aAAa,IACvC,OAAA,KAAI,CAAC,YAAY,CAAC,YAAY,EAAE,eAAe,EAAE,aAAa,CAAC,GAAA,CAChE,CAAC;iBACH;aACF,CAAC,CAAC;SACJ;QAED,mCAAkB,GAAlB,UACE,GAAW,EACX,WAA2C;YAA3C,4BAAA,EAAA,cAA2B,IAAI,CAAC,WAAW;YAE3C,OAAO,WAAW,CAAC,MAAM,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC;SAChD;;;;;;QAOO,2BAAU,GAAV,UAAW,IAAY,EAAE,UAAmC;YAClE,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE;gBACrB,uBACE,OAAO,EAAE,IAAIyB,iBAAW,CAAC,EAAE,CAAC,KACxB,UAAU,CAAC,KAAK;sBAChB;wBACE,SAAS,EAAE,UAAU,CAAC,KAAK,CAAC,IAAI;wBAChC,UAAU,EAAE,UAAU,CAAC,KAAK,CAAC,UAAU;wBACvC,QAAQ,EAAE,UAAU,CAAC,KAAK,CAAC,QAAQ;wBACnC,UAAU,EAAE,EAAE;qBACf;sBACD;wBACE,SAAS,EAAEmB,kBAAU,CAAC,MAAM;wBAC5B,UAAU,EAAE,EAAE;qBACf,GACL;aACH;iBAAM;gBACL,OAAO;oBACL,SAAS,EAAE,UAAU,CAAC,KAAK,CAAC,IAAI;oBAChC,UAAU,EAAE,UAAU,CAAC,KAAK,CAAC,UAAU;oBACvC,QAAQ,EAAE,UAAU,CAAC,KAAK,CAAC,QAAQ;oBACnC,UAAU,EAAE,EAAE;oBACd,OAAO,EAAE,IAAIpB,eAAS,CAAC,EAAE,CAAC;oBAC1B,aAAa,EAAE,EAAE;iBAClB,CAAC;aACH;SACF;qBACF;KAAA;;;QCvjBC,8BACU,QAAkB,EAGlB,IAAY,EAGZ,YAA0B,EAC1B,GAAsB,EACtB,OAA2B;YAR3B,aAAQ,GAAR,QAAQ,CAAU;YAGlB,SAAI,GAAJ,IAAI,CAAQ;YAGZ,iBAAY,GAAZ,YAAY,CAAc;YAC1B,QAAG,GAAH,GAAG,CAAmB;YACtB,YAAO,GAAP,OAAO,CAAoB;YAarC,iBAAY,GAAG,IAAIsB,iBAAY,EAAO,CAAC;YAGvC,oBAAe,GAAG,IAAIA,iBAAY,EAAW,CAAC;YAO9C,UAAK,GAAU9C,aAAK,CAAC,MAAM,CAAC;SAtBvB;QA2BL,0CAAW,GAAX,UAAY,OAAsB;YAChC,IAAI,OAAO,CAAC,IAAI,EAAE;gBAChB,IAAI,CAAC,MAAM,EAAE,CAAC;aACf;YAED,IAAI,OAAO,CAAC,KAAK,IAAI,IAAI,CAAC,IAAI,EAAE;gBAC9B,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;aAClD;SACF;QAED,0CAAW,GAAX;YACE,IAAI,IAAI,CAAC,kBAAkB,EAAE;gBAC3B,IAAI,CAAC,kBAAkB,CAAC,WAAW,EAAE,CAAC;aACvC;YAED,IAAI,IAAI,CAAC,kBAAkB,EAAE;gBAC3B,IAAI,CAAC,kBAAkB,CAAC,WAAW,EAAE,CAAC;aACvC;SACF;QAED,sCAAO,GAAP;YACE,IAAI,CAAC,MAAM,CAAC,YAAY,CACtB,IAAI,CAAC,KAAK,CACX,CAAC;YAEF,OAAO,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;SAChC;QAED,mCAAI,GAAJ,UACE,YAAoB,EACpB,UAAkB;YAGlB,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,GAAG,CAAC,UAAA,IAAI,IACjD,OAAA,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,UAAU,CAAC,GAAA,CACpC,CAAC;YAEF,OAAO,MAAM,CAAC,MAAM,GAAGgC,aAAQ,CAAC,MAAM,CAAC,GAAGd,OAAE,CAAC,EAAE,CAAC,CAAC;SAClD;QAED,6CAAc,GAAd,UACE,YAAoB,EACpB,UAAkB;YAElB,IAAI,CAAC,OAAO,EAAE,CAAC;YAEf,OAAO,IAAI,CAAC,IAAI,CACd,YAAY,EACZ,UAAU,CACX,CAAC;SACH;QAEO,qCAAM,GAAN;YAAA,iBAuDP;YAtDC,IAAM,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,IAAI,EAAE,CAAC;YACpC,IAAM,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,IAAI,EAAE,CAAC;YAEhD,IAAI,CAAC,MAAM,GAAG,IAAI,MAAM,CACtB,IAAI,CAAC,IAAI,CAAC,MAAM,EAChB,IAAI,CAAC,QAAQ,EACb,IAAI,CAAC,KAAK,EACV,IAAI,CAAC,IAAI,EACT,WAAW,EACX,IAAI,CAAC,YAAY,CAClB,CAAC;YAEF,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,CAC/B,KAAK,EACL,EAAE,EACF,GAAG,EACH,KAAK,CACN,CAAC;YAEF,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC;YAExB,IAAI,CAAC,QAAQ,GAAG,wBAAwB,CACtC,IAAI,CAAC,IAAI,CAAC,QAAQ;gBAClB,CAAC;wBACC,KAAK,EAAE,EAAE;wBACT,MAAM,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC;wBACzC,cAAc,EAAE,EAAE;wBAClB,IAAI,EAAEnB,mBAAW,CAAC,KAAK;qBACxB,CAAC,EACF,IAAI,CAAC,MAAM,EACX,WAAW,EACX,IAAI,CAAC,QAAQ,EACb,KAAK,CACN,CAAC;YAEF,IAAI,IAAI,CAAC,kBAAkB,EAAE;gBAC3B,IAAI,CAAC,kBAAkB,CAAC,WAAW,EAAE,CAAC;aACvC;YAED,IAAI,IAAI,CAAC,kBAAkB,EAAE;gBAC3B,IAAI,CAAC,kBAAkB,CAAC,WAAW,EAAE,CAAC;aACvC;YAED,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,IAAI,CAAC,YAAY;iBAC7C,SAAS,CAAC,UAAA,GAAG;gBACZ,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;aAC7B,CAAC,CAAC;YAEL,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa;iBAC9C,SAAS,CAAC,UAAA,GAAG;gBACZ,KAAI,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,KAAK,OAAO,CAAC,CAAC;aAC5C,CAAC,CAAC;YAEL,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,CAAC;SACzB;;;;gBAvJFY,cAAS,SAAC;oBACT,QAAQ,EAAE,iBAAiB;oBAC3B,2LAA4C;oBAC5C,eAAe,EAAEI,4BAAuB,CAAC,MAAM;oBAC/C,SAAS,EAAE,CAAC,kBAAkB,CAAC;iBAChC;;;gBAzBCF,aAAQ;6CA6BLoB,aAAQ,YACRrB,WAAM,SAAC,IAAI;gDAEXqB,aAAQ,YACRrB,WAAM,SAAC,aAAa;gBArCvBgB,sBAAiB;gBAgBX,kBAAkB;;;uBA2BvBmB,UAAK;wBAGLA,UAAK;qBAGLA,UAAK;+BAGLC,WAAM;kCAGNA,WAAM;wBAOND,UAAK;;;;QC1DN,2BACU,EAAc,EACd,QAAmB;YADnB,OAAE,GAAF,EAAE,CAAY;YACd,aAAQ,GAAR,QAAQ,CAAW;YAGpB,eAAU,GAAG,QAAQ,CAAC;YACrB,YAAO,GAAG,IAAID,iBAAY,EAAY,CAAC;YACvC,YAAO,GAAG,IAAIA,iBAAY,EAAW,CAAC;SAJ5C;QAOJ,kCAAM,GAAN,UAAO,MAAW;YAChB,MAAM,CAAC,cAAc,EAAE,CAAC;YACxB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;YAC7C,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;YAClE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAC1B;QAGD,sCAAU,GAAV,UAAW,MAAa;YACtB,MAAM,CAAC,cAAc,EAAE,CAAC;YACxB,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;YAC/D,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACzB;QAGD,uCAAW,GAAX,UAAY,MAAa;YACvB,MAAM,CAAC,cAAc,EAAE,CAAC;YACxB,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;YAClE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAC1B;;;;gBAjCFG,cAAS,SAAC;oBACT,QAAQ,EAAE,cAAc;iBACzB;;;gBAJkBC,eAAU;gBAA6CC,cAAS;;;6BAWhFJ,UAAK;0BACLC,WAAM;0BACNA,WAAM;yBAENI,iBAAY,SAAC,MAAM,EAAE,CAAC,QAAQ,CAAC;6BAQ/BA,iBAAY,SAAC,UAAU,EAAE,CAAC,QAAQ,CAAC;8BAOnCA,iBAAY,SAAC,WAAW,EAAE,CAAC,QAAQ,CAAC;;;;QCvBvC;;QACE,iCAAS,GAAT,UAAU,MAAuB,EAAE,MAAc;YAC/C,OAAO,MAAM,CAAC,MAAM,CAClB,UAAA,KAAK,IACH,OAAA,CAAC,KAAK,CAAC,MAAM;iBAEX,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC;oBACzB,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC;oBACnC,KAAK,CAAC,MAAM,KAAK,MAAM,CAAC,KAAK,CAChC,GAAA,CACJ,CAAC;SACH;;;;gBAdFC,SAAI,SAAC;oBACJ,IAAI,EAAE,WAAW;iBAClB;;;;QC0ID;;;;;gBA1FCC,aAAQ,SAAC;oBACR,YAAY,EAAE;;;;wBAKZ,cAAc;wBAEd,qBAAqB;wBACrB,iBAAiB;wBACjB,cAAc;wBACd,kBAAkB;wBAClB,cAAc;wBACd,sBAAsB;wBACtB,aAAa;wBACb,gBAAgB;wBAChB,cAAc;wBACd,cAAc;wBACd,cAAc;wBACd,eAAe;wBACf,eAAe;wBACf,iBAAiB;wBACjB,eAAe;wBACf,gBAAgB;;;;wBAKhB,gBAAgB;wBAEhB,kBAAkB;wBAClB,aAAa;wBACb,cAAc;wBACd,gBAAgB;wBAChB,aAAa;;;;wBAKb,iBAAiB;;;;wBAKjB,aAAa;wBAEb,oBAAoB;qBACrB;oBACD,OAAO,EAAE;wBACPC,mBAAY;wBACZC,yBAAmB;;;;wBAKnBC,4BAAkB;wBAClBC,oBAAc;wBACdC,sBAAe;wBACfC,kCAAqB;wBACrBC,sBAAe;wBACfC,sBAAe;wBACfC,gCAAoB;wBACpBC,0BAAiB;wBACjBC,oBAAc;wBACdC,kBAAa;wBACbC,8BAAmB;wBACnBC,0BAAmB;wBACnBC,uBAAc;wBACdC,sBAAe;wBACfC,wBAAgB;wBAChBC,wCAAwB;wBACxBC,4BAAkB;wBAClBC,wBAAgB;wBAChBC,mBAAY;wBACZC,kBAAa;wBACbC,kBAAa;wBACbC,oBAAc;;;;wBAKdC,wBAAc;;;;wBAKdC,yBAAe;qBAChB;oBACD,OAAO,EAAE,CAAC,oBAAoB,CAAC;iBAChC;;;IC/ID;;;;ICAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}