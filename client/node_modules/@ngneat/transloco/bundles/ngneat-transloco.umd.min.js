!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("flat"),require("rxjs/operators"),require("@angular/core"),require("rxjs")):"function"==typeof define&&define.amd?define("@ngneat/transloco",["exports","flat","rxjs/operators","@angular/core","rxjs"],e):e((t.ngneat=t.ngneat||{},t.ngneat.transloco={}),t.flat,t.rxjs.operators,t.ng.core,t.rxjs)}(this,function(t,e,f,n,p){"use strict";e=e&&e.hasOwnProperty("default")?e["default"]:e;var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var h=function(){return(h=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function L(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||0<e--)&&!(r=a.next()).done;)o.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=a["return"])&&n.call(a)}finally{if(i)throw i.error}}return o}var l=(i.prototype.getTranslation=function(t){return p.of(this.translations.get(t)||{})},i);function i(t){this.translations=t}var a=new n.InjectionToken("TRANSLOCO_LOADER");function c(t,e){return t&&t.hasOwnProperty(e)?t[e]:e.split(".").reduce(function(t,e){return t&&t[e]},t)}function u(t,e,r){t=h({},t);var n=e.split("."),i=n.length-1;return n.reduce(function(t,e,n){return t[e]=n===i?r:Array.isArray(t[e])?t[e].slice():h({},t[e]),t&&t[e]},t),t}function o(t){return t?Array.isArray(t)?t.length:d(t)?Object.keys(t).length:t?t.length:0:0}function m(t){return 0===o(t)}function s(t){return"function"==typeof t}function S(t){return"string"==typeof t}function g(t){return"number"==typeof t}function d(t){return t&&"object"==typeof t&&!Array.isArray(t)}function v(t){return t.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0==e?t.toLowerCase():t.toUpperCase()}).replace(/\s+|_|-|\//g,"")}function y(){return"undefined"!=typeof window}function T(t){return null===t||t===undefined}function O(t){return!1===T(t)}function A(t){return t&&"string"==typeof t.scope}function C(t){return t&&d(t.loader)}function w(t){return e.unflatten(t,{safe:!0})}function j(t){return e(t,{safe:!0})}var R=new n.InjectionToken("TRANSLOCO_TRANSPILER"),I=(_.prototype.transpile=function(t,n,r){var i=this;return void 0===n&&(n={}),S(t)?t.replace(/{{(.*?)}}/g,function(t,e){return e=e.trim(),O(n[e])?n[e]:O(r[e])?i.transpile(r[e],n,r):""}):(d(t)&&n&&(t=this.handleObject(t,n,r)),t)},_.prototype.handleObject=function(t,i,a){var o=this;void 0===i&&(i={});var s=t;return Object.keys(i).forEach(function(t){var e=c(s,t),n=c(i,t),r=o.transpile(e,n,a);s=u(s,t,r)}),s},_);function _(){}function k(t){for(var e=t?t.split(","):[],n=[],r=0;r<e.length;r++){for(var i=e[r].trim();"\\"===i[i.length-1];)r++,i=i.replace("\\",",")+e[r];n.push(i)}return n}var M,N=(function jt(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(F,M=I),F.prototype.transpile=function(s,t,e){var l=this;if(void 0===t&&(t={}),S(s)){var n=s.replace(/\[\[\s*(\w+)\((.*)\)\s*]]/g,function(t,e,n){try{var r=l.injector.get(e);return r.transpile.apply(r,function a(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(b(arguments[e]));return t}(k(n)))}catch(o){var i="There is an error in: '"+s+"'. \n                          Check that the you used the right syntax in your translation and that the implementation of "+e+" is correct.";throw o.message.includes("NullInjectorError")&&(i="You are using the '"+e+"' function in your translation but no provider was found!"),new Error(i)}});return M.prototype.transpile.call(this,n,t,e)}return d(s)&&t&&(s=this.handleObject(s,t,e)),s},F.decorators=[{type:n.Injectable}],F.ctorParameters=function(){return[{type:n.Injector}]},F);function F(t){var e=M.call(this)||this;return e.injector=t,e}var E=new n.InjectionToken("TRANSLOCO_CONFIG",{providedIn:"root",factory:function(){return{}}}),P={defaultLang:"en",reRenderOnLangChange:!1,prodMode:!1,failedRetries:2,availableLangs:[],missingHandler:{logMissingKey:!0,useFallbackTranslation:!1,allowEmpty:!1},flatten:{aot:!1}};function x(t){return void 0===t&&(t=P),h({},P,t)}var D=new n.InjectionToken("TRANSLOCO_MISSING_HANDLER"),H=(V.prototype.handle=function(t,e){if(e.missingHandler.logMissingKey&&!e.prodMode){var n="Missing translation for '"+t+"'";console.warn("%c "+n,"font-size: 12px; color: red")}return t},V);function V(){}var K=new n.InjectionToken("TRANSLOCO_INTERCEPTOR"),B=(G.prototype.preSaveTranslation=function(t,e){return t},G.prototype.preSaveTranslationKey=function(t,e,n){return e},G);function G(){}var z,$=new n.InjectionToken("TRANSLOCO_FALLBACK_STRATEGY"),J=(W.prototype.getNextLangs=function(t){var e=this.userConfig.fallbackLang;if(!e)throw new Error("When using the default fallback, a fallback language must be provided in the config!");return Array.isArray(e)?e:[e]},W.ctorParameters=function(){return[{type:undefined,decorators:[{type:n.Inject,args:[E]}]}]},W);function W(t){this.userConfig=t}function Y(t){if(!t)return"";var e=t.split("/");return e.pop(),e.join("/")}function q(t){return t?t.split("/").pop():""}function U(t,e,n){if(void 0===n&&(n="|"),S(t)){var r=t.split(n),i=r.pop();return i===e?[!0,r.toString()]:[!1,i]}return[!1,""]}function Z(t,e){return!1===b(U(e,"static"),1)[0]&&t.config.reRenderOnLangChange}function Q(t){return t?function(t){return t}:f.take(1)}function X(t,e){return C(t)?function i(n,r){return Object.keys(n).reduce(function(t,e){return t[r+"/"+e]=n[e],t},{})}(t.loader,e):null}function tt(t){return{scope:Y(t)||null,langName:q(t),lang:t}}function et(t,e,n,r){if(n){if(!1===s(n[t]))throw"You're using an inline loader but didn't provide a loader for "+t;return n[t]().then(function(t){return t["default"]?t["default"]:t})}return e.getTranslation(t,r)}var nt=(Object.defineProperty(rt.prototype,"config",{get:function(){return this.mergedConfig},enumerable:!0,configurable:!0}),rt.prototype.getDefaultLang=function(){return this.defaultLang},rt.prototype.setDefaultLang=function(t){this.defaultLang=t},rt.prototype.getActiveLang=function(){return this.lang.getValue()},rt.prototype.setActiveLang=function(t){return this.lang.next(t),this.parser.onLangChanged&&this.parser.onLangChanged(t),this},rt.prototype.setAvailableLangs=function(t){this.availableLangs=t},rt.prototype.getAvailableLangs=function(){return this.availableLangs},rt.prototype.load=function(e,t){var n=this;if(void 0===t&&(t={}),!1===this.cache.has(e)){var r=void 0,i=this._isLangScoped(e),a=i?Y(e):null;if(this.useFallbackTranslation(e)){var o=i?a+"/"+this.firstFallbackLang:this.firstFallbackLang,s=function u(t,e,n,r,i){return[t,e].map(function(e){var t=et(e,n,r,i);return p.from(t).pipe(f.map(function(t){return{translation:t,lang:e}}))})}(e,o,this.loader,t.inlineLoader,{scope:a});r=p.forkJoin(s)}else{var l=et(e,this.loader,t.inlineLoader,{scope:a});r=p.from(l)}var c=r.pipe(f.retry(this.config.failedRetries),f.tap(function(t){Array.isArray(t)?t.forEach(function(t){n.handleSuccess(t.lang,t.translation),t.lang!==e&&n.cache.set(t.lang,p.of({}))}):n.handleSuccess(e,t)}),f.catchError(function(){return n.handleFailure(e,t)}),f.shareReplay(1));this.cache.set(e,c)}return this.cache.get(e)},rt.prototype.translate=function(t,e,n){var r=this;if(void 0===e&&(e={}),void 0===n&&(n=this.getActiveLang()),!t)return t;var i=this.resolveLangAndScope(n),a=i.scope,o=i.resolveLang;if(Array.isArray(t))return t.map(function(t){return r.translate(a?a+"."+t:t,e,o)});t=a?a+"."+t:t;var s=this.getTranslation(o),l=s[t];return l?this.parser.transpile(l,e,s):this._handleMissingKey(t,l,e)},rt.prototype.selectTranslate=function(n,r,t,i){var a=this;void 0===i&&(i=!1);var e=null,o=function(t,e){return a.load(t,e).pipe(f.map(function(){return i?a.translateObject(n,r,t):a.translate(n,r,t)}))};if(T(t))return this.langChanges$.pipe(f.switchMap(function(t){return o(t)}));if(A(t)){var s=t;t=s.scope,e=X(s,s.scope)}if(t=t,this.isLang(t)||this.isScopeWithLang(t))return o(t);var l=t;return this.langChanges$.pipe(f.switchMap(function(t){return o(l+"/"+t,{inlineLoader:e})}))},rt.prototype.isScopeWithLang=function(t){return this.isLang(q(t))},rt.prototype.translateObject=function(t,e,n){var r,i,a=this;if(void 0===n&&(n=this.getActiveLang()),S(t)||Array.isArray(t)){if(Array.isArray(t))return t.map(function(t){return a.translateObject(l?l+"."+t:t,e,s)});var o=this.resolveLangAndScope(n),s=o.resolveLang,l=o.scope,c=this.getTranslation(s);t=l?l+"."+t:t;var u=w(this.getObjectByKey(c,t));return m(u)?this.translate(t,e,n):this.parser.transpile(u,e,c)}var p=[];try{for(var h=L(this.getEntries(t)),f=h.next();!f.done;f=h.next()){var g=b(f.value,2),d=g[0],v=g[1];p.push(this.translateObject(d,v,n))}}catch(y){r={error:y}}finally{try{f&&!f.done&&(i=h["return"])&&i.call(h)}finally{if(r)throw r.error}}return p},rt.prototype.selectTranslateObject=function(t,e,u){var p=this;if(S(t)||Array.isArray(t))return this.selectTranslate(t,e,u,!0);var n=b(this.getEntries(t)),r=b(n[0],2),i=r[0],a=r[1],h=n.slice(1);return this.selectTranslateObject(i,a,u).pipe(f.map(function(t){var e,n,r=[t];try{for(var i=L(h),a=i.next();!a.done;a=i.next()){var o=b(a.value,2),s=o[0],l=o[1];r.push(p.translateObject(s,l,u))}}catch(c){e={error:c}}finally{try{a&&!a.done&&(n=i["return"])&&n.call(i)}finally{if(e)throw e.error}}return r}))},rt.prototype.getTranslation=function(t){return t?this.translations.get(t)||{}:this.translations},rt.prototype.selectTranslation=function(t){var e=this,n=t||this.getActiveLang();return this.load(n).pipe(f.map(function(){return e.getTranslation(n)}))},rt.prototype.setTranslation=function(t,e,n){var r;void 0===e&&(e=this.getActiveLang()),void 0===n&&(n={});var i=h({},{merge:!0,emitChange:!0},n),a=Y(e),o=t;a&&(o=j(((r={})[this.getMappedScope(a)]=t,r)));var s=a?q(e):e,l=h({},i.merge&&this.getTranslation(s),o),c=this.mergedConfig.flatten.aot?l:j(l),u=this.interceptor.preSaveTranslation(c,s);this.translations.set(s,u),i.emitChange&&this.setActiveLang(this.getActiveLang())},rt.prototype.setTranslationKey=function(t,e,n){var r;void 0===n&&(n=this.getActiveLang());var i=this.interceptor.preSaveTranslationKey(t,e,n),a=h({},this.getTranslation(n),((r={})[t]=i,r));this.setTranslation(a,n)},rt.prototype.setFallbackLangForMissingTranslation=function(t){var e=t.fallbackLang,n=Array.isArray(e)?e[0]:e;this.useFallbackTranslation(n)&&e&&(this.firstFallbackLang=n)},rt.prototype._handleMissingKey=function(t,e,n){if(this.config.missingHandler.allowEmpty&&""===e)return"";if(!this.useFallbackTranslation()||this.isResolvedMissingOnce)return this.missingHandler.handle(t,this.getMissingHandlerData(),n);this.isResolvedMissingOnce=!0;var r=this.translate(t,n,this.firstFallbackLang);return this.isResolvedMissingOnce=!1,r},rt.prototype._isLangScoped=function(t){return-1===this.getAvailableLangsIds().indexOf(t)},rt.prototype.isLang=function(t){return-1!==this.getAvailableLangsIds().indexOf(t)},rt.prototype._loadDependencies=function(t,e){var n=q(t);return this._isLangScoped(t)&&!this.isLoadedTranslation(n)?p.combineLatest(this.load(n),this.load(t,{inlineLoader:e})):this.load(t,{inlineLoader:e})},rt.prototype._completeScopeWithLang=function(t){return this._isLangScoped(t)&&!this.isLang(q(t))?t+"/"+this.getActiveLang():t},rt.prototype._setScopeAlias=function(t,e){this.mergedConfig.scopeMapping||(this.mergedConfig.scopeMapping={}),this.mergedConfig.scopeMapping[t]=e},rt.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},rt.prototype.isLoadedTranslation=function(t){return o(this.getTranslation(t))},rt.prototype.getAvailableLangsIds=function(){return S(this.getAvailableLangs()[0])?this.getAvailableLangs():this.getAvailableLangs().map(function(t){return t.id})},rt.prototype.getMissingHandlerData=function(){return h({},this.config,{activeLang:this.getActiveLang(),availableLangs:this.availableLangs,defaultLang:this.defaultLang})},rt.prototype.useFallbackTranslation=function(t){return this.config.missingHandler.useFallbackTranslation&&t!==this.firstFallbackLang},rt.prototype.handleSuccess=function(t,e){var n=this;this.setTranslation(e,t,{emitChange:!1}),this.failedCounter=0,this.events.next({wasFailure:!!this.failedLangs.size,type:"translationLoadSuccess",payload:tt(t)}),this.failedLangs.forEach(function(t){return n.cache["delete"](t)}),this.failedLangs.clear()},rt.prototype.handleFailure=function(t,e){var n=t.split("/"),r=(e.fallbackLangs||this.fallbackStrategy.getNextLangs(t))[this.failedCounter];if(this.failedLangs.add(t),this.cache.has(r))return this.handleSuccess(r,this.getTranslation(r)),p.EMPTY;var i=r===n[n.length-1];if(!r||i){var a="Unable to load translation and all the fallback languages";throw 1<n.length&&(a+=", did you misspelled the scope name?"),new Error(a)}var o=r;return 1<n.length&&(n[n.length-1]=r,o=n.join("/")),this.failedCounter++,this.events.next({type:"translationLoadFailure",payload:tt(t)}),this.load(o)},rt.prototype.getMappedScope=function(t){var e=this.config.scopeMapping;return(void 0===e?{}:e)[t]||v(t)},rt.prototype.resolveLangAndScope=function(t){var e,n=t;if(this._isLangScoped(t)){var r=q(t),i=this.isLang(r);n=i?r:this.getActiveLang(),e=this.getMappedScope(i?Y(t):t)}return{scope:e,resolveLang:n}},rt.prototype.getObjectByKey=function(t,e){var n={},r=e+".";for(var i in t)i.startsWith(r)&&(n[i.replace(r,"")]=t[i]);return n},rt.prototype.getEntries=function(t){return t instanceof Map?t.entries():Object.entries(t)},rt.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],rt.ctorParameters=function(){return[{type:undefined,decorators:[{type:n.Optional},{type:n.Inject,args:[a]}]},{type:undefined,decorators:[{type:n.Inject,args:[R]}]},{type:undefined,decorators:[{type:n.Inject,args:[D]}]},{type:undefined,decorators:[{type:n.Inject,args:[K]}]},{type:undefined,decorators:[{type:n.Inject,args:[E]}]},{type:undefined,decorators:[{type:n.Inject,args:[$]}]}]},rt.ngInjectableDef=n.defineInjectable({factory:function(){return new rt(n.inject(a,8),n.inject(R),n.inject(D),n.inject(K),n.inject(E),n.inject($))},token:rt,providedIn:"root"}),rt);function rt(t,e,n,r,i,a){var o=this;this.loader=t,this.parser=e,this.missingHandler=n,this.interceptor=r,this.userConfig=i,this.fallbackStrategy=a,this.translations=new Map,this.cache=new Map,this.firstFallbackLang=null,this.availableLangs=[],this.isResolvedMissingOnce=!1,this.events=new p.Subject,this.events$=this.events.asObservable(),this.failedCounter=0,this.failedLangs=new Set,this.loader||(this.loader=new l(this.translations)),(z=this).mergedConfig=function s(t,e){return h({},t,e,{missingHandler:h({},t.missingHandler,e.missingHandler),flatten:h({},t.flatten,e.flatten)})}(P,i),this.setAvailableLangs(this.mergedConfig.availableLangs),this.setFallbackLangForMissingTranslation(this.mergedConfig),this.setDefaultLang(this.mergedConfig.defaultLang),this.lang=new p.BehaviorSubject(this.getDefaultLang()),this.langChanges$=this.lang.asObservable(),this.subscription=this.events$.subscribe(function(t){if("translationLoadSuccess"===t.type&&t.wasFailure){var e=q(t.payload.lang);o.setActiveLang(e)}})}var it=(at.decorators=[{type:n.Component,args:[{template:'\n    <div class="transloco-loader-template" [innerHTML]="html"></div>\n  '}]}],at.propDecorators={html:[{type:n.Input}]},at);function at(){}var ot=(st.prototype.attachView=function(){if(this.view instanceof n.TemplateRef)this.vcr.createEmbeddedView(this.view);else if(S(this.view)){var t=this.createComponent(it);t.instance.html=this.view,t.hostView.detectChanges()}else this.createComponent(this.view)},st.prototype.detachView=function(){this.vcr.clear()},st.prototype.createComponent=function(t){var e=this.injector.get(n.ComponentFactoryResolver).resolveComponentFactory(t);return this.vcr.createComponent(e)},st);function st(t,e){this.view=t,this.vcr=e,this.injector=this.vcr.injector}var lt=new n.InjectionToken("TRANSLOCO_LANG"),ct=new n.InjectionToken("TRANSLOCO_LOADING_TEMPLATE"),ut=new n.InjectionToken("TRANSLOCO_SCOPE"),pt=(ht.prototype.resolve=function(t){var e=void 0===t?{inline:undefined,provider:undefined,active:undefined}:t,n=e.inline,r=e.provider,i=e.active,a=i;if(this.initialized)return a=i;if(r){var o=b(U(r,"static"),2);o[0],a=o[1]}if(n){var s=b(U(n,"static"),2);s[0],a=s[1]}return this.initialized=!0,a},ht.prototype.resolveLangBasedOnScope=function(t){return Y(t)?q(t):t},ht.prototype.resolveLangPath=function(t,e){return e?e+"/"+t:t},ht);function ht(){this.initialized=!1}var ft=(gt.prototype.resolve=function(t){var e=void 0===t?{inline:undefined,provider:undefined}:t,n=e.inline,r=e.provider;if(n)return n;if(r){if(A(r)){var i=r.scope,a=r.alias,o=void 0===a?v(i):a;return this.translocoService._setScopeAlias(i,o),i}return r}return undefined},gt);function gt(t){this.translocoService=t}var dt=(vt.prototype.ngOnInit=function(){var n=this,t=Z(this.translocoService,this.providerLang||this.inlineLang);this.subscription=this.translocoService.langChanges$.pipe(f.switchMap(function(t){var e=n.langResolver.resolve({inline:n.inlineLang,provider:n.providerLang,active:t});return Array.isArray(n.providerScope)?p.forkJoin(n.providerScope.map(function(t){return n.resolveScope(e,t)})):n.resolveScope(e,n.providerScope)}),Q(t)).subscribe(function(){n.currentLang=n.langResolver.resolveLangBasedOnScope(n.path),null===n.tpl?n.simpleStrategy():n.structuralStrategy(n.currentLang,n.inlineRead),n.cdr.markForCheck(),n.initialized=!0});var e=this.getLoadingTpl();!this.initialized&&e&&(this.loaderTplHandler=new ot(e,this.vcr),this.loaderTplHandler.attachView())},vt.prototype.ngOnChanges=function(e){Object.keys(e).some(function(t){return!1===e[t].firstChange})&&this.simpleStrategy()},vt.prototype.simpleStrategy=function(){this.detachLoader(),this.host.nativeElement.innerText=this.translocoService.translate(this.key,this.params,this.currentLang)},vt.prototype.structuralStrategy=function(t,e){this.translationMemo={},this.view?this.view.context.$implicit=this.getTranslateFn(t,e):(this.detachLoader(),this.view=this.vcr.createEmbeddedView(this.tpl,{$implicit:this.getTranslateFn(t,e)}))},vt.prototype.getTranslateFn=function(i,a){var o=this;return function(t,e){var n=a?a+"."+t:t,r=e?""+n+JSON.stringify(e):n;return o.translationMemo.hasOwnProperty(r)||(o.translationMemo[r]={params:e,value:o.translocoService.translate(n,e,i)}),o.translationMemo[r].value}},vt.prototype.getLoadingTpl=function(){return this.inlineTpl||this.providedLoadingTpl},vt.prototype.ngOnDestroy=function(){this.subscription&&this.subscription.unsubscribe()},vt.prototype.detachLoader=function(){this.loaderTplHandler&&this.loaderTplHandler.detachView()},vt.prototype.resolveScope=function(t,e){var n=this.scopeResolver.resolve({inline:this.inlineScope,provider:e});this.path=this.langResolver.resolveLangPath(t,n);var r=X(e,n);return this.translocoService._loadDependencies(this.path,r)},vt.decorators=[{type:n.Directive,args:[{selector:"[transloco]"}]}],vt.ctorParameters=function(){return[{type:nt},{type:n.TemplateRef,decorators:[{type:n.Optional}]},{type:undefined,decorators:[{type:n.Optional},{type:n.Inject,args:[ut]}]},{type:undefined,decorators:[{type:n.Optional},{type:n.Inject,args:[lt]}]},{type:undefined,decorators:[{type:n.Optional},{type:n.Inject,args:[ct]}]},{type:n.ViewContainerRef},{type:n.ChangeDetectorRef},{type:n.ElementRef}]},vt.propDecorators={key:[{type:n.Input,args:["transloco"]}],params:[{type:n.Input,args:["translocoParams"]}],inlineScope:[{type:n.Input,args:["translocoScope"]}],inlineRead:[{type:n.Input,args:["translocoRead"]}],inlineLang:[{type:n.Input,args:["translocoLang"]}],inlineTpl:[{type:n.Input,args:["translocoLoadingTpl"]}]},vt);function vt(t,e,n,r,i,a,o,s){this.translocoService=t,this.tpl=e,this.providerScope=n,this.providerLang=r,this.providedLoadingTpl=i,this.vcr=a,this.cdr=o,this.host=s,this.translationMemo={},this.params={},this.loaderTplHandler=null,this.initialized=!1,this.langResolver=new pt,this.scopeResolver=new ft(this.translocoService)}var yt=(Lt.prototype.transform=function(t,e,n){var r=this;if(!t)return t;var i=e?""+t+JSON.stringify(e):t;return i===this.lastKey||(this.lastKey=i,this.subscription&&this.subscription.unsubscribe(),this.subscription=this.translocoService.langChanges$.pipe(f.switchMap(function(t){var e=r.langResolver.resolve({inline:n,provider:r.providerLang,active:t});return Array.isArray(r.providerScope)?p.forkJoin(r.providerScope.map(function(t){return r.resolveScope(e,t)})):r.resolveScope(e,r.providerScope)}),Q(this.listenToLangChange)).subscribe(function(){return r.updateValue(t,e)})),this.lastValue},Lt.prototype.ngOnDestroy=function(){this.subscription&&this.subscription.unsubscribe()},Lt.prototype.updateValue=function(t,e){var n=this.langResolver.resolveLangBasedOnScope(this.path);this.lastValue=this.translocoService.translate(t,e,n),this.cdr.markForCheck()},Lt.prototype.resolveScope=function(t,e){var n=this.scopeResolver.resolve({inline:undefined,provider:e});this.path=this.langResolver.resolveLangPath(t,n);var r=X(e,n);return this.translocoService._loadDependencies(this.path,r)},Lt.decorators=[{type:n.Pipe,args:[{name:"transloco",pure:!1}]}],Lt.ctorParameters=function(){return[{type:nt},{type:undefined,decorators:[{type:n.Optional},{type:n.Inject,args:[ut]}]},{type:undefined,decorators:[{type:n.Optional},{type:n.Inject,args:[lt]}]},{type:n.ChangeDetectorRef}]},Lt);function Lt(t,e,n,r){this.translocoService=t,this.providerScope=e,this.providerLang=n,this.cdr=r,this.subscription=null,this.lastValue="",this.langResolver=new pt,this.scopeResolver=new ft(this.translocoService),this.listenToLangChange=Z(this.translocoService,this.providerLang)}var bt=[{provide:R,useClass:I},{provide:D,useClass:H},{provide:K,useClass:B},{provide:$,useClass:J,deps:[E]}],mt=(St.decorators=[{type:n.NgModule,args:[{declarations:[dt,yt,it],providers:[bt],exports:[dt,yt],entryComponents:[it]}]}],St);function St(){}var Tt=(Ot.prototype.getTranslation=function(t){return p.of(this.langs[t])},Ot.decorators=[{type:n.Injectable}],Ot.ctorParameters=function(){return[{type:undefined,decorators:[{type:n.Inject,args:["translocoLangs"]}]}]},Ot);function Ot(t){this.langs=t}var At=(Ct.withLangs=function(t,e){return void 0===e&&(e={}),{ngModule:Ct,providers:[{provide:"translocoLangs",useValue:t},{provide:a,useClass:Tt},bt,{provide:E,useValue:x(h({prodMode:!0,missingHandler:{logMissingKey:!1}},e))}]}},Ct.decorators=[{type:n.NgModule,args:[{exports:[mt]}]}],Ct);function Ct(){}function wt(){if(!1===y())return undefined;var t=window.navigator,e=t.languages?t.languages[0]:null;return e=e||t.language||t.browserLanguage||t.userLanguage}t.translate=function Rt(t,e,n){return void 0===e&&(e={}),z.translate(t,e,n)},t.TranslocoService=nt,t.TranslocoDirective=dt,t.TranslocoPipe=yt,t.TranslocoModule=mt,t.defaultProviders=bt,t.TRANSLOCO_LOADER=a,t.TRANSLOCO_CONFIG=E,t.defaultConfig=P,t.provideTranslocoConfig=function It(t){return void 0===t&&(t=P),{provide:E,useValue:h({},P,t)}},t.translocoConfig=x,t.TRANSLOCO_TRANSPILER=R,t.DefaultTranspiler=I,t.FunctionalTranspiler=N,t.getFunctionArgs=k,t.TRANSLOCO_SCOPE=ut,t.TRANSLOCO_LOADING_TEMPLATE=ct,t.TRANSLOCO_LANG=lt,t.TestingLoader=Tt,t.TranslocoTestingModule=At,t.TemplateHandler=ot,t.TRANSLOCO_INTERCEPTOR=K,t.TRANSLOCO_FALLBACK_STRATEGY=$,t.DefaultFallbackStrategy=J,t.TRANSLOCO_MISSING_HANDLER=D,t.getBrowserCultureLang=wt,t.getBrowserLang=function _t(){var t=wt();return!1!==y()&&t?(-1!==t.indexOf("-")&&(t=t.split("-")[0]),-1!==t.indexOf("_")&&(t=t.split("_")[0]),t):undefined},t.getPipeValue=U,t.getLangFromScope=q,t.getScopeFromLang=Y,t.getValue=c,t.setValue=u,t.size=o,t.isEmpty=m,t.isFunction=s,t.isString=S,t.isNumber=g,t.isObject=d,t.coerceArray=function kt(t){return Array.isArray(t)?t:[t]},t.toCamelCase=v,t.isBrowser=y,t.isNil=T,t.isDefined=O,t.toNumber=function Mt(t){return g(t)?t:S(t)&&!isNaN(Number(t)-parseFloat(t))?Number(t):null},t.isScopeObject=A,t.hasInlineLoader=C,t.unflatten=w,t.flatten=j,t.ɵc=it,t.ɵb=H,t.ɵa=B,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngneat-transloco.umd.min.js.map